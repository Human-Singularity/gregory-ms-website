var webodf_version="0.5.8";function Runtime(){}Runtime.prototype.getVariable=function(_){},Runtime.prototype.toJson=function(_){},Runtime.prototype.fromJson=function(_){},Runtime.prototype.byteArrayFromString=function(_,$){},Runtime.prototype.byteArrayToString=function(_,$){},Runtime.prototype.read=function(_,$,ee,et){},Runtime.prototype.readFile=function(_,$,ee){},Runtime.prototype.readFileSync=function(_,$){},Runtime.prototype.loadXML=function(_,$){},Runtime.prototype.writeFile=function(_,$,ee){},Runtime.prototype.deleteFile=function(_,$){},Runtime.prototype.log=function(_,$){},Runtime.prototype.setTimeout=function(_,$){},Runtime.prototype.clearTimeout=function(_){},Runtime.prototype.libraryPaths=function(){},Runtime.prototype.currentDirectory=function(){},Runtime.prototype.setCurrentDirectory=function(_){},Runtime.prototype.type=function(){},Runtime.prototype.getDOMImplementation=function(){},Runtime.prototype.parseXML=function(_){},Runtime.prototype.exit=function(_){},Runtime.prototype.getWindow=function(){},Runtime.prototype.requestAnimationFrame=function(_){},Runtime.prototype.cancelAnimationFrame=function(_){},Runtime.prototype.assert=function(_,$){};var IS_COMPILED_CODE=!0;function BrowserRuntime(){function _(_){var $,ee,et=_.length,en=0;for($=0;$<et;$+=1)en+=1+(128<(ee=_.charCodeAt($)))+(2048<ee),55040<ee&&57344>ee&&(en+=1,$+=1);return en}function $(_,$,ee){var et,en,eo=_.length;for($=new Uint8Array(new ArrayBuffer($)),ee?($[0]=239,$[1]=187,$[2]=191,en=3):en=0,ee=0;ee<eo;ee+=1)128>(et=_.charCodeAt(ee))?($[en]=et,en+=1):2048>et?($[en]=192|et>>>6,$[en+1]=128|63&et,en+=2):55040>=et||57344<=et?($[en]=224|et>>>12&15,$[en+1]=128|et>>>6&63,$[en+2]=128|63&et,en+=3):(ee+=1,et=(et-55296<<10|_.charCodeAt(ee)-56320)+65536,$[en]=240|et>>>18&7,$[en+1]=128|et>>>12&63,$[en+2]=128|et>>>6&63,$[en+3]=128|63&et,en+=4);return $}function ee(_){var $,ee=_.length,et=new Uint8Array(new ArrayBuffer(ee));for($=0;$<ee;$+=1)et[$]=255&_.charCodeAt($);return et}function et(_,$){var ee;void 0!==$?ee=_:$=_,console.log($),ei.enableAlerts&&"alert"===ee&&alert($)}function en(et,en,eo){if(0!==eo.status||eo.responseText){if(200===eo.status||0===eo.status){if(eo.response&&"string"!=typeof eo.response)"binary"===en?(eo=eo.response,eo=new Uint8Array(eo)):eo=String(eo.response);else if("binary"===en){if(null!==eo.responseBody&&"undefined"!==String(typeof VBArray)){var er=(eo=new VBArray(eo.responseBody).toArray()).length;for(et=0,en=new Uint8Array(new ArrayBuffer(er));et<er;et+=1)en[et]=eo[et];eo=en}else{if((et=eo.getResponseHeader("Content-Length"))&&(et=parseInt(et,10)),et&&et!==eo.responseText.length)e:{er=eo.responseText,en=!1;var ei=_(er);if("number"==typeof et){if(et!==ei&&et!==ei+3){er=void 0;break e}en=ei+3===et,ei=et}er=$(er,ei,en)}void 0===er&&(er=ee(eo.responseText)),eo=er}}else eo=eo.responseText;eo={err:null,data:eo}}else eo={err:eo.responseText||eo.statusText,data:null}}else eo={err:"File "+et+" is empty.",data:null};return eo}function eo(_,$,ee){var et=new XMLHttpRequest;return et.open("GET",_,ee),et.overrideMimeType&&("binary"!==$?et.overrideMimeType("text/plain; charset="+$):et.overrideMimeType("text/plain; charset=x-user-defined")),et}function er(_,$,ee){var et=eo(_,$,!0);et.onreadystatechange=function(){var eo;4===et.readyState&&ee((eo=en(_,$,et)).err,eo.data)};try{et.send(null)}catch(_){ee(_.message,null)}}var ei=this;this.byteArrayFromString=function(et,en){var eo;return"utf8"===en?eo=$(et,_(et),!1):("binary"!==en&&ei.log("unknown encoding: "+en),eo=ee(et)),eo},this.byteArrayToString=Runtime.byteArrayToString,this.getVariable=Runtime.getVariable,this.fromJson=Runtime.fromJson,this.toJson=Runtime.toJson,this.readFile=er,this.read=function(_,$,ee,et){er(_,"binary",function(_,en){var eo=null;if(en){if("string"==typeof en)throw"This should not happen.";eo=en.subarray($,$+ee)}et(_,eo)})},this.readFileSync=function(_,$){var ee,et=eo(_,$,!1);try{if(et.send(null),(ee=en(_,$,et)).err)throw ee.err;if(null===ee.data)throw"No data read from "+_+"."}catch(_){throw _}return ee.data},this.writeFile=function(_,$,ee){var et,en=new XMLHttpRequest;en.open("PUT",_,!0),en.onreadystatechange=function(){4===en.readyState&&(0!==en.status||en.responseText?200<=en.status&&300>en.status||0===en.status?ee(null):ee("Status "+String(en.status)+": "+en.responseText||en.statusText):ee("File "+_+" is empty."))},et=$.buffer&&!en.sendAsBinary?$.buffer:ei.byteArrayToString($,"binary");try{en.sendAsBinary?en.sendAsBinary(et):en.send(et)}catch(_){ei.log("HUH? "+_+" "+$),ee(_.message)}},this.deleteFile=function(_,$){var ee=new XMLHttpRequest;ee.open("DELETE",_,!0),ee.onreadystatechange=function(){4===ee.readyState&&(200>ee.status&&300<=ee.status?$(ee.responseText):$(null))},ee.send(null)},this.loadXML=function(_,$){var ee=new XMLHttpRequest;ee.open("GET",_,!0),ee.overrideMimeType&&ee.overrideMimeType("text/xml"),ee.onreadystatechange=function(){4===ee.readyState&&(0!==ee.status||ee.responseText?200===ee.status||0===ee.status?$(null,ee.responseXML):$(ee.responseText,null):$("File "+_+" is empty.",null))};try{ee.send(null)}catch(_){$(_.message,null)}},this.log=et,this.enableAlerts=!0,this.assert=Runtime.assert,this.setTimeout=function(_,$){return setTimeout(function(){_()},$)},this.clearTimeout=function(_){clearTimeout(_)},this.libraryPaths=function(){return["lib"]},this.setCurrentDirectory=function(){},this.currentDirectory=function(){return""},this.type=function(){return"BrowserRuntime"},this.getDOMImplementation=function(){return window.document.implementation},this.parseXML=function(_){return(new DOMParser).parseFromString(_,"text/xml")},this.exit=function(_){et("Calling exit with code "+String(_)+", but exit() is not implemented.")},this.getWindow=function(){return window},this.requestAnimationFrame=function(_){var $=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,ee=0;return $?($.bind(window),ee=$(_)):setTimeout(_,15)},this.cancelAnimationFrame=function(_){var $=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame;$?($.bind(window),$(_)):clearTimeout(_)}}function NodeJSRuntime(){function _(_){var $,ee=_.length,et=new Uint8Array(new ArrayBuffer(ee));for($=0;$<ee;$+=1)et[$]=_[$];return et}function $($,ee,et){function en(ee,en){return ee?et(ee,null):en?"string"==typeof en?et(ee,en):void et(ee,_(en)):et("No data for "+$+".",null)}$=er.resolve(ei,$),"binary"!==ee?eo.readFile($,ee,en):eo.readFile($,null,en)}var ee,et,en=this,eo=require("fs"),er=require("path"),ei="";this.byteArrayFromString=function(_,$){var ee,et=new Buffer(_,$),en=et.length,eo=new Uint8Array(new ArrayBuffer(en));for(ee=0;ee<en;ee+=1)eo[ee]=et[ee];return eo},this.byteArrayToString=Runtime.byteArrayToString,this.getVariable=Runtime.getVariable,this.fromJson=Runtime.fromJson,this.toJson=Runtime.toJson,this.readFile=$,this.loadXML=function(_,ee){$(_,"utf-8",function($,et){return $?ee($,null):et?void ee(null,en.parseXML(et)):ee("No data for "+_+".",null)})},this.writeFile=function(_,$,ee){$=new Buffer($),_=er.resolve(ei,_),eo.writeFile(_,$,"binary",function(_){ee(_||null)})},this.deleteFile=function(_,$){_=er.resolve(ei,_),eo.unlink(_,$)},this.read=function($,ee,et,en){$=er.resolve(ei,$),eo.open($,"r+",666,function($,er){if($)en($,null);else{var ei=new Buffer(et);eo.read(er,ei,0,et,ee,function($){eo.close(er),en($,_(ei))})}})},this.readFileSync=function($,ee){var et;if(null===(et=eo.readFileSync($,"binary"===ee?null:ee)))throw"File "+$+" could not be read.";return"binary"===ee&&(et=_(et)),et},this.log=function(_,$){var ee;void 0!==$?ee=_:$=_,"alert"===ee&&process.stderr.write("\n!!!!! ALERT !!!!!\n"),process.stderr.write($+"\n"),"alert"===ee&&process.stderr.write("!!!!! ALERT !!!!!\n")},this.assert=Runtime.assert,this.setTimeout=function(_,$){return setTimeout(function(){_()},$)},this.clearTimeout=function(_){clearTimeout(_)},this.libraryPaths=function(){return[__dirname]},this.setCurrentDirectory=function(_){ei=_},this.currentDirectory=function(){return ei},this.type=function(){return"NodeJSRuntime"},this.getDOMImplementation=function(){return et},this.parseXML=function(_){return ee.parseFromString(_,"text/xml")},this.exit=process.exit,this.getWindow=function(){return null},this.requestAnimationFrame=function(_){return setTimeout(_,15)},this.cancelAnimationFrame=function(_){clearTimeout(_)},ee=new(require("xmldom")).DOMParser,et=en.parseXML("<a/>").implementation}function RhinoRuntime(){var _,$,ee=this,et={},en=et.javax.xml.parsers.DocumentBuilderFactory.newInstance(),eo="";en.setValidating(!1),en.setNamespaceAware(!0),en.setExpandEntityReferences(!1),en.setSchema(null),$=et.org.xml.sax.EntityResolver({resolveEntity:function(_,$){var ee=new et.java.io.FileReader($);return new et.org.xml.sax.InputSource(ee)}}),(_=en.newDocumentBuilder()).setEntityResolver($),this.byteArrayFromString=function(_,$){var ee,et=_.length,en=new Uint8Array(new ArrayBuffer(et));for(ee=0;ee<et;ee+=1)en[ee]=255&_.charCodeAt(ee);return en},this.byteArrayToString=Runtime.byteArrayToString,this.getVariable=Runtime.getVariable,this.fromJson=Runtime.fromJson,this.toJson=Runtime.toJson,this.loadXML=function($,ee){var en=new et.java.io.File($),eo=null;try{eo=_.parse(en)}catch(_){return print(_),ee(_,null)}ee(null,eo)},this.readFile=function(_,$,en){eo&&(_=eo+"/"+_);var er=new et.java.io.File(_),ei="binary"===$?"latin1":$;er.isFile()?((_=readFile(_,ei))&&"binary"===$&&(_=ee.byteArrayFromString(_,"binary")),en(null,_)):en(_+" is not a file.",null)},this.writeFile=function(_,$,ee){eo&&(_=eo+"/"+_),_=new et.java.io.FileOutputStream(_);var en,er=$.length;for(en=0;en<er;en+=1)_.write($[en]);_.close(),ee(null)},this.deleteFile=function(_,$){eo&&(_=eo+"/"+_);var ee=new et.java.io.File(_),en=_+Math.random(),en=new et.java.io.File(en);ee.rename(en)?(en.deleteOnExit(),$(null)):$("Could not delete "+_)},this.read=function(_,$,ee,en){eo&&(_=eo+"/"+_),er=_;var er,ei="binary";new et.java.io.File(er).isFile()?("binary"===ei&&(ei="latin1"),er=readFile(er,ei)):er=null,er?en(null,this.byteArrayFromString(er.substring($,$+ee),"binary")):en("Cannot read "+_,null)},this.readFileSync=function(_,$){if(!$)return"";var ee=readFile(_,$);if(null===ee)throw"File could not be read.";return ee},this.log=function(_,$){var ee;void 0!==$?ee=_:$=_,"alert"===ee&&print("\n!!!!! ALERT !!!!!"),print($),"alert"===ee&&print("!!!!! ALERT !!!!!")},this.assert=Runtime.assert,this.setTimeout=function(_){return _(),0},this.clearTimeout=function(){},this.libraryPaths=function(){return["lib"]},this.setCurrentDirectory=function(_){eo=_},this.currentDirectory=function(){return eo},this.type=function(){return"RhinoRuntime"},this.getDOMImplementation=function(){return _.getDOMImplementation()},this.parseXML=function($){return $=new et.java.io.StringReader($),$=new et.org.xml.sax.InputSource($),_.parse($)},this.exit=quit,this.getWindow=function(){return null},this.requestAnimationFrame=function(_){return _(),0},this.cancelAnimationFrame=function(){}}Runtime.byteArrayToString=function(_,$){var ee;function et(_){var $,ee="",et=_.length;for($=0;$<et;$+=1)ee+=String.fromCharCode(255&_[$]);return ee}function en(_){var $,ee,et,en,eo,er="",ei=_.length,es=[];for($=3<=ei&&239===_[0]&&187===_[1]&&191===_[2]?3:0;$<ei;$+=1)128>(ee=_[$])?es.push(ee):($+=1,et=_[$],194<=ee&&224>ee?es.push((31&ee)<<6|63&et):($+=1,en=_[$],224<=ee&&240>ee?es.push((15&ee)<<12|(63&et)<<6|63&en):($+=1,eo=_[$],240<=ee&&245>ee&&(ee=((7&ee)<<18|(63&et)<<12|(63&en)<<6|63&eo)-65536,es.push((ee>>10)+55296,(1023&ee)+56320))))),1e3<=es.length&&(er+=String.fromCharCode.apply(null,es),es.length=0);return er+String.fromCharCode.apply(null,es)}return"utf8"===$?ee=en(_):("binary"!==$&&this.log("Unsupported encoding: "+$),ee=et(_)),ee},Runtime.getVariable=function(g){try{return eval(g)}catch(k){}},Runtime.toJson=function(_){return JSON.stringify(_)},Runtime.fromJson=function(_){return JSON.parse(_)},Runtime.getFunctionName=function(_){return void 0===_.name?(_=/function\s+(\w+)/.exec(_))&&_[1]:_.name},Runtime.assert=function(_,$){if(!_)throw this.log("alert","ASSERTION FAILED:\n"+$),Error($)},Runtime.create=function(){return"undefined"!==String(typeof window)?new BrowserRuntime:"undefined"!==String(typeof require)?new NodeJSRuntime:new RhinoRuntime};var runtime=Runtime.create(),core={},gui={},xmldom={},odf={},ops={},webodf={};function makeBase64(){function _(_){var $,ee=_.length,et=new Uint8Array(new ArrayBuffer(ee));for($=0;$<ee;$+=1)et[$]=255&_.charCodeAt($);return et}function $(_){var $,ee,et="",en=_.length-2;for(ee=0;ee<en;ee+=3)et+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[($=_[ee]<<16|_[ee+1]<<8|_[ee+2])>>>18]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[$>>>12&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[$>>>6&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[63&$];return ee===en+1?et+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[($=_[ee]<<4)>>>6]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[63&$]+"==":ee===en&&(et+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[($=_[ee]<<10|_[ee+1]<<2)>>>12]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[$>>>6&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[63&$]+"="),et}function ee(_){var $,ee,et=(_=_.replace(/[^A-Za-z0-9+\/]+/g,"")).length,en=new Uint8Array(new ArrayBuffer(3*et)),eo=_.length%4,er=0;for($=0;$<et;$+=4)ee=(eb[_.charAt($)]||0)<<18|(eb[_.charAt($+1)]||0)<<12|(eb[_.charAt($+2)]||0)<<6|(eb[_.charAt($+3)]||0),en[er]=ee>>16,en[er+1]=ee>>8&255,en[er+2]=255&ee,er+=3;return et=3*et-[0,0,2,1][eo],en.subarray(0,et)}function et(_){var $,ee,et=_.length,en=0,eo=new Uint8Array(new ArrayBuffer(3*et));for($=0;$<et;$+=1)128>(ee=_[$])?eo[en++]=ee:(2048>ee?eo[en++]=192|ee>>>6:(eo[en++]=224|ee>>>12&15,eo[en++]=128|ee>>>6&63),eo[en++]=128|63&ee);return eo.subarray(0,en)}function en(_){var $,ee,et,en,eo=_.length,er=new Uint8Array(new ArrayBuffer(eo)),ei=0;for($=0;$<eo;$+=1)128>(ee=_[$])?er[ei++]=ee:($+=1,et=_[$],224>ee?er[ei++]=(31&ee)<<6|63&et:($+=1,en=_[$],er[ei++]=(15&ee)<<12|(63&et)<<6|63&en));return er.subarray(0,ei)}function eo(ee){return $(_(ee))}function er(_){return String.fromCharCode.apply(String,ee(_))}function ei($){return en(_($))}function es(_){_=en(_);for(var $="",ee=0;ee<_.length;)$+=String.fromCharCode.apply(String,_.subarray(ee,ee+45e3)),ee+=45e3;return $}function el(_,$,ee){var et,en,eo,er="";for(eo=$;eo<ee;eo+=1)128>($=255&_.charCodeAt(eo))?er+=String.fromCharCode($):(eo+=1,et=255&_.charCodeAt(eo),224>$?er+=String.fromCharCode((31&$)<<6|63&et):(eo+=1,en=255&_.charCodeAt(eo),er+=String.fromCharCode((15&$)<<12|(63&et)<<6|63&en)));return er}function eu(_,$){function ee(){var eo=en+1e5;eo>_.length&&(eo=_.length),$(et+=el(_,en,eo),eo=(en=eo)===_.length)&&!eo&&runtime.setTimeout(ee,0)}var et="",en=0;1e5>_.length?$(el(_,0,_.length),!0):("string"!=typeof _&&(_=_.slice()),ee())}function ec($){return et(_($))}function ed(_){return String.fromCharCode.apply(String,et(_))}function ef($){return String.fromCharCode.apply(String,et(_($)))}var ep,em,eh,eg,eb=function(_){var $,ee,et={};for($=0,ee=_.length;$<ee;$+=1)et[_.charAt($)]=$;return et}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),ey=runtime.getWindow();return ey&&ey.btoa?(eh=ey.btoa,ep=function(_){return eh(ef(_))}):(eh=eo,ep=function(_){return $(ec(_))}),ey&&ey.atob?(eg=ey.atob,em=function(_){return el(_=eg(_),0,_.length)}):(eg=er,em=function(_){return es(ee(_))}),core.Base64=function(){return this.convertByteArrayToBase64=this.convertUTF8ArrayToBase64=$,this.convertBase64ToByteArray=this.convertBase64ToUTF8Array=ee,this.convertUTF16ArrayToByteArray=this.convertUTF16ArrayToUTF8Array=et,this.convertByteArrayToUTF16Array=this.convertUTF8ArrayToUTF16Array=en,this.convertUTF8StringToBase64=eo,this.convertBase64ToUTF8String=er,this.convertUTF8StringToUTF16Array=ei,this.convertByteArrayToUTF16String=this.convertUTF8ArrayToUTF16String=es,this.convertUTF8StringToUTF16String=eu,this.convertUTF16StringToByteArray=this.convertUTF16StringToUTF8Array=ec,this.convertUTF16ArrayToUTF8String=ed,this.convertUTF16StringToUTF8String=ef,this.convertUTF16StringToBase64=ep,this.convertBase64ToUTF16String=em,this.fromBase64=er,this.toBase64=eo,this.atob=eg,this.btoa=eh,this.utob=ef,this.btou=eu,this.encode=ep,this.encodeURI=function(_){return ep(_).replace(/[+\/]/g,function(_){return"+"===_?"-":"_"}).replace(/\\=+$/,"")},this.decode=function(_){return em(_.replace(/[\-_]/g,function(_){return"-"===_?"+":"/"}))},this},core.Base64}function createXPathSingleton(){var _,$;function ee(_,$,ee){return -1!==_&&(_<$||-1===$)&&(_<ee||-1===ee)}function et(_){for(var et,en=[],eo=0,er=_.length;eo<er;){var ei=_,es=er,el=en,eu="",ec=[],ed=ei.indexOf("[",eo),ef=ei.indexOf("/",eo),ep=ei.indexOf("=",eo);if(ee(ef,ed,ep)?(eu=ei.substring(eo,ef),eo=ef+1):ee(ed,ef,ep)?(eu=ei.substring(eo,ed),eo=$(ei,ed,ec)):ee(ep,ef,ed)?(eu=ei.substring(eo,ep),eo=ep):(eu=ei.substring(eo,es),eo=es),el.push({location:eu,predicates:ec}),eo<er&&"="===_[eo]){if(2<(et=_.substring(eo+1,er)).length&&("'"===et[0]||'"'===et[0]))et=et.slice(1,et.length-1);else try{et=parseInt(et,10)}catch(_){}eo=er}}return{steps:en,value:et}}function en(){var _=null,$=!1;this.setNode=function($){_=$},this.reset=function(){$=!1},this.next=function(){var ee=$?null:_;return $=!0,ee}}function eo(_,$,ee){this.reset=function(){_.reset()},this.next=function(){for(var et=_.next();et&&(et.nodeType===Node.ELEMENT_NODE&&(et=et.getAttributeNodeNS($,ee)),!et);)et=_.next();return et}}function er(_,$){var ee=_.next(),et=null;this.reset=function(){_.reset(),ee=_.next(),et=null},this.next=function(){for(;ee;){if(et){if($&&et.firstChild)et=et.firstChild;else{for(;!et.nextSibling&&et!==ee;)et=et.parentNode;et===ee?ee=_.next():et=et.nextSibling}}else do(et=ee.firstChild)||(ee=_.next());while(ee&&!et);if(et&&et.nodeType===Node.ELEMENT_NODE)return et}return null}}function ei(_,$){this.reset=function(){_.reset()},this.next=function(){for(var ee=_.next();ee&&!$(ee);)ee=_.next();return ee}}function es(_,$,ee){var et=ee(($=$.split(":",2))[0]),en=$[1];return new ei(_,function(_){return _.localName===en&&_.namespaceURI===et})}function el($,ee,et){var eo=new en,er=_(eo,ee,et),es=ee.value;return void 0===es?new ei($,function(_){return eo.setNode(_),er.reset(),null!==er.next()}):new ei($,function(_){return eo.setNode(_),er.reset(),!!(_=er.next())&&_.nodeValue===es})}return $=function(_,$,ee){for(var en=$,eo=_.length,er=0;en<eo;)"]"===_[en]?0>=--er&&ee.push(et(_.substring($,en))):"["===_[en]&&(0>=er&&($=en+1),er+=1),en+=1;return en},_=function(_,$,ee){var et,en,ei,eu;for(et=0;et<$.steps.length;et+=1){if(""===(en=(ei=$.steps[et]).location))_=new er(_,!1);else if("@"===en[0]){if(!(eu=ee((en=en.substr(1).split(":",2))[0])))throw"No namespace associated with the prefix "+en[0];_=new eo(_,eu,en[1])}else"."!==en&&(_=new er(_,!1),-1!==en.indexOf(":")&&(_=es(_,en,ee)));for(en=0;en<ei.predicates.length;en+=1)_=el(_,eu=ei.predicates[en],ee)}return _},{getODFElementsWithXPath:function($,ee,eo){var er=$.ownerDocument,ei=[],es=null;if(er&&"function"==typeof er.evaluate)for(es=(eo=er.evaluate(ee,$,eo,XPathResult.UNORDERED_NODE_ITERATOR_TYPE,null)).iterateNext();null!==es;)es.nodeType===Node.ELEMENT_NODE&&ei.push(es),es=eo.iterateNext();else{for((ei=new en).setNode($),ei=_(ei,$=et(ee),eo),$=[],eo=ei.next();eo;)$.push(eo),eo=ei.next();ei=$}return ei}}}function RootFilter(_,$,ee){var et=core.PositionFilter.FilterResult.FILTER_ACCEPT,en=core.PositionFilter.FilterResult.FILTER_REJECT;this.acceptPosition=function(eo){var er;return eo=eo.container(),er="string"==typeof _?$[_].getNode():_,ee(eo)===ee(er)?et:en}}!function(){webodf.Version="undefined"!==String(typeof webodf_version)?webodf_version:"From Source"}(),function(){function g(_,$,ee){var et,en,eo=_+"/manifest.json";runtime.log("Loading manifest: "+eo);try{et=runtime.readFileSync(eo,"utf-8")}catch(_){if(ee)runtime.log("No loadable manifest found.");else throw console.log(String(_)),_;return}for(en in ee=JSON.parse(et))ee.hasOwnProperty(en)&&($[en]={dir:_,deps:ee[en]})}function k(_,$,ee){function et(_){if(!er[_]&&!ee(_)){if(eo[_])throw"Circular dependency detected for "+_+".";if(eo[_]=!0,!$[_])throw"Missing dependency information for class "+_+".";var ei,es=$[_],el=es.deps,eu=el.length;for(ei=0;ei<eu;ei+=1)et(el[ei]);eo[_]=!1,er[_]=!0,en.push(es.dir+"/"+_.replace(".","/")+".js")}}var en=[],eo={},er={};return _.forEach(et),en}function c(_,$){return $+"\n//# sourceURL="+_}function b(b){var f,e;for(f=0;f<b.length;f+=1)e=runtime.readFileSync(b[f],"utf-8"),e=c(b[f],e),eval(e)}function f(_){_=_.split(".");var $,ee=p,et=_.length;for($=0;$<et;$+=1){if(!ee.hasOwnProperty(_[$]))return!1;ee=ee[_[$]]}return!0}var n,p={core:core,gui:gui,xmldom:xmldom,odf:odf,ops:ops};runtime.loadClasses=function(_,$){if(IS_COMPILED_CODE||0===_.length)return $&&$();if(!(en=n)){en=[];var ee,et,en,eo,er=runtime.libraryPaths();for(runtime.currentDirectory()&&-1===er.indexOf(runtime.currentDirectory())&&g(runtime.currentDirectory(),en,!0),eo=0;eo<er.length;eo+=1)g(er[eo],en)}if(n=en,0===(_=k(_,n,f)).length)return $&&$();if("BrowserRuntime"===runtime.type()&&$){for(et=0,en=_,er=document.currentScript||document.documentElement.lastChild,eo=document.createDocumentFragment();et<en.length;et+=1)(ee=document.createElement("script")).type="text/javascript",ee.charset="utf-8",ee.async=!1,ee.setAttribute("src",en[et]),eo.appendChild(ee);$&&(ee.onload=$),er.parentNode.insertBefore(eo,er)}else b(_),$&&$()},runtime.loadClass=function(_,$){runtime.loadClasses([_],$)}}(),function(){var _=function(_){return _};runtime.getTranslator=function(){return _},runtime.setTranslator=function($){_=$},runtime.tr=function($){var ee=_($);return ee&&"string"===String(typeof ee)?ee:$}}(),function(g){function k(c){if(c.length){var b=c[0];runtime.readFile(b,"utf8",function(f,n){function g(){var b;(b=eval(k))&&runtime.exit(b)}var r="",r=b.lastIndexOf("/"),k=n,r=-1!==r?b.substring(0,r):".";runtime.setCurrentDirectory(r),f?(runtime.log(f),runtime.exit(1)):null===k?(runtime.log("No code found for "+b),runtime.exit(1)):g.apply(null,c)})}}g=g?Array.prototype.slice.call(g):[],k("NodeJSRuntime"===runtime.type()?process.argv.slice(2):"RhinoRuntime"===runtime.type()?g:g.slice(1))}("undefined"!==String(typeof arguments)&&arguments),function(){core.Async=function(){return{forEach:function(_,$,ee){function et(_){er!==eo&&(_?(er=eo,ee(_)):(er+=1)===eo&&ee(null))}var en,eo=_.length,er=0;for(en=0;en<eo;en+=1)$(_[en],et)},destroyAll:function(_,$){function ee(et,en){en?$(en):et<_.length?_[et](function(_){ee(et+1,_)}):$()}ee(0,void 0)}}}()}(),core.Base64=makeBase64(),core.CSSUnits=function(){var _=this,$={in:1,cm:2.54,mm:25.4,pt:72,pc:12,px:96};this.convert=function(_,ee,et){return _*$[et]/$[ee]},this.convertMeasure=function($,ee){var et,en;return $&&ee&&(et=parseFloat($),en=$.replace(et.toString(),""),et=_.convert(et,en,ee)),et},this.getUnits=function(_){return _.substr(_.length-2,_.length)}},function(){var _;function $(){var $,ee,et,en,eo,er,ei,es,el;return void 0===_&&(er=(ee=($=runtime.getWindow())&&$.document).documentElement,ei=ee.body,_={rangeBCRIgnoresElementBCR:!1,unscaledRangeClientRects:!1,elementBCRIgnoresBodyScroll:!1},ee&&((en=ee.createElement("div")).style.position="absolute",en.style.left="-99999px",en.style.transform="scale(2)",en.style["-webkit-transform"]="scale(2)",eo=ee.createElement("div"),en.appendChild(eo),ei.appendChild(en),($=ee.createRange()).selectNode(eo),_.rangeBCRIgnoresElementBCR=0===$.getClientRects().length,eo.appendChild(ee.createTextNode("Rect transform test")),ee=eo.getBoundingClientRect(),et=$.getBoundingClientRect(),_.unscaledRangeClientRects=2<Math.abs(ee.height-et.height),en.style.transform="",en.style["-webkit-transform"]="",ee=er.style.overflow,et=ei.style.overflow,es=ei.style.height,el=ei.scrollTop,er.style.overflow="visible",ei.style.overflow="visible",ei.style.height="200%",ei.scrollTop=ei.scrollHeight,_.elementBCRIgnoresBodyScroll=$.getBoundingClientRect().top!==eo.getBoundingClientRect().top,ei.scrollTop=el,ei.style.height=es,ei.style.overflow=et,er.style.overflow=ee,$.detach(),ei.removeChild(en),$=Object.keys(_).map(function($){return $+":"+String(_[$])}).join(", "),runtime.log("Detected browser quirks - "+$))),_}function ee(_,$,ee){for(_=_?_.firstElementChild:null;_;){if(_.localName===ee&&_.namespaceURI===$)return _;_=_.nextElementSibling}return null}core.DomUtilsImpl=function(){function _(_,$){for(var ee,et=0;_.parentNode!==$;)runtime.assert(null!==_.parentNode,"parent is null"),_=_.parentNode;for(ee=$.firstChild;ee!==_;)et+=1,ee=ee.nextSibling;return et}function et(_,$){return 0>=_.compareBoundaryPoints(Range.START_TO_START,$)&&0<=_.compareBoundaryPoints(Range.END_TO_END,$)}function en(_,$){return 0>=_.compareBoundaryPoints(Range.END_TO_START,$)&&0<=_.compareBoundaryPoints(Range.START_TO_END,$)}function eo(_,$){var ee=null;return _.nodeType===Node.TEXT_NODE&&(0===_.length?(_.parentNode.removeChild(_),$.nodeType===Node.TEXT_NODE&&(ee=$)):($.nodeType===Node.TEXT_NODE&&(_.appendData($.data),$.parentNode.removeChild($)),ee=_)),ee}function er(_){for(var $=_.parentNode;_.firstChild;)$.insertBefore(_.firstChild,_);return $.removeChild(_),$}function ei(_,$){var ee,et=_.parentNode,en=_.firstChild,eo=$(_);if(eo===NodeFilter.FILTER_SKIP)return et;for(;en;)ee=en.nextSibling,ei(en,$),en=ee;return et&&eo===NodeFilter.FILTER_REJECT&&er(_),et}function es(_,$){return _===$||!!(_.compareDocumentPosition($)&Node.DOCUMENT_POSITION_CONTAINED_BY)}function el(_,ee){return $().unscaledRangeClientRects?_:_/ee}function eu(_,$,ee){Object.keys($).forEach(function(et){var en=et.split(":"),eo=en[1],er=ee(en[0]),en=$[et],ei=typeof en;"object"===ei?Object.keys(en).length&&(et=er?_.getElementsByTagNameNS(er,eo)[0]||_.ownerDocument.createElementNS(er,et):_.getElementsByTagName(eo)[0]||_.ownerDocument.createElement(et),_.appendChild(et),eu(et,en,ee)):er&&(runtime.assert("number"===ei||"string"===ei,"attempting to map unsupported type '"+ei+"' (key: "+et+")"),_.setAttributeNS(er,et,String(en)))})}var ec=null;this.splitBoundaries=function($){var ee,et,en,eo,er=[];if($.startContainer.nodeType===Node.TEXT_NODE||$.endContainer.nodeType===Node.TEXT_NODE){if(et=$.endContainer,en=$.endContainer.nodeType!==Node.TEXT_NODE&&$.endOffset===$.endContainer.childNodes.length,(eo=$.endOffset)<(ee=$.endContainer).childNodes.length)for(ee=ee.childNodes.item(eo),eo=0;ee.firstChild;)ee=ee.firstChild;else for(;ee.lastChild;)eo=(ee=ee.lastChild).nodeType===Node.TEXT_NODE?ee.textContent.length:ee.childNodes.length;if(ee===et&&(et=null),$.setEnd(ee,eo),eo=$.endContainer,0!==$.endOffset&&eo.nodeType===Node.TEXT_NODE&&(ee=eo,$.endOffset!==ee.length&&(er.push(ee.splitText($.endOffset)),er.push(ee))),eo=$.startContainer,0!==$.startOffset&&eo.nodeType===Node.TEXT_NODE&&(ee=eo,$.startOffset!==ee.length&&(eo=ee.splitText($.startOffset),er.push(ee),er.push(eo),$.setStart(eo,0))),null!==et){for(eo=$.endContainer;eo.parentNode&&eo.parentNode!==et;)eo=eo.parentNode;en=en?et.childNodes.length:_(eo,et),$.setEnd(et,en)}}return er},this.containsRange=et,this.rangesIntersect=en,this.rangeIntersection=function(_,$){var ee;return en(_,$)&&(ee=_.cloneRange(),-1===_.compareBoundaryPoints(Range.START_TO_START,$)&&ee.setStart($.startContainer,$.startOffset),1===_.compareBoundaryPoints(Range.END_TO_END,$)&&ee.setEnd($.endContainer,$.endOffset)),ee},this.getNodesInRange=function(_,$,ee){var et,en,eo=[],er=_.commonAncestorContainer,er=er.nodeType===Node.TEXT_NODE?er.parentNode:er;if(ee=_.startContainer.ownerDocument.createTreeWalker(er,ee,$,!1),_.endContainer.childNodes[_.endOffset-1]?(et=_.endContainer.childNodes[_.endOffset-1],en=Node.DOCUMENT_POSITION_PRECEDING|Node.DOCUMENT_POSITION_CONTAINED_BY):(et=_.endContainer,en=Node.DOCUMENT_POSITION_PRECEDING),_.startContainer.childNodes[_.startOffset])_=_.startContainer.childNodes[_.startOffset],ee.currentNode=_;else{var ei=_.startContainer;_.startOffset===(ei.nodeType===Node.TEXT_NODE?ei.length:ei.childNodes.length)?(_=_.startContainer,ee.currentNode=_,ee.lastChild(),_=ee.nextNode()):(_=_.startContainer,ee.currentNode=_)}if(_){if((_=ee.currentNode)!==er)for(_=_.parentNode;_&&_!==er;)$(_)===NodeFilter.FILTER_REJECT&&(ee.currentNode=_),_=_.parentNode;switch(_=ee.currentNode,$(_)){case NodeFilter.FILTER_REJECT:for(_=ee.nextSibling();!_&&ee.parentNode();)_=ee.nextSibling();break;case NodeFilter.FILTER_SKIP:_=ee.nextNode()}for(;_&&(0===($=et.compareDocumentPosition(_))||0!=($&en));)eo.push(_),_=ee.nextNode()}return eo},this.normalizeTextNodes=function(_){_&&_.nextSibling&&(_=eo(_,_.nextSibling)),_&&_.previousSibling&&eo(_.previousSibling,_)},this.rangeContainsNode=function(_,$){var ee,en=$.ownerDocument.createRange(),eo=$.ownerDocument.createRange();return en.setStart(_.startContainer,_.startOffset),en.setEnd(_.endContainer,_.endOffset),eo.selectNodeContents($),ee=et(en,eo),en.detach(),eo.detach(),ee},this.mergeIntoParent=er,this.removeUnwantedNodes=ei,this.removeAllChildNodes=function(_){for(;_.firstChild;)_.removeChild(_.firstChild)},this.getElementsByTagNameNS=function(_,$,ee){var et=[];for(_=_.getElementsByTagNameNS($,ee),et.length=ee=_.length,$=0;$<ee;$+=1)et[$]=_.item($);return et},this.getElementsByTagName=function(_,$){var ee,et,en,eo=[];for(et=0,ee=_.getElementsByTagName($),eo.length=en=ee.length;et<en;et+=1)eo[et]=ee.item(et);return eo},this.containsNode=function(_,$){return _===$||_.contains($)},this.comparePoints=function($,ee,et,en){if($===et)return en-ee;var eo=$.compareDocumentPosition(et);return 2===eo?-1:4===eo?1:10===eo?(ee=_($,et))<en?1:-1:(en=_(et,$))<ee?-1:1},this.adaptRangeDifferenceToZoomLevel=el,this.translateRect=function(_,$,ee){return{top:el(_.top-$.top,ee),left:el(_.left-$.left,ee),bottom:el(_.bottom-$.top,ee),right:el(_.right-$.left,ee),width:el(_.width,ee),height:el(_.height,ee)}},this.getBoundingClientRect=function(_){var ee,et=_.ownerDocument,en=$(),eo=et.body;return(!1===en.unscaledRangeClientRects||en.rangeBCRIgnoresElementBCR)&&_.nodeType===Node.ELEMENT_NODE?(_=_.getBoundingClientRect(),en.elementBCRIgnoresBodyScroll?{left:_.left+eo.scrollLeft,right:_.right+eo.scrollLeft,top:_.top+eo.scrollTop,bottom:_.bottom+eo.scrollTop,width:_.width,height:_.height}:_):(ec?ee=ec:ec=ee=et.createRange(),(en=ee).selectNode(_),en.getBoundingClientRect())},this.mapKeyValObjOntoNode=function(_,$,ee){Object.keys($).forEach(function(et){var en=et.split(":"),eo=en[1],en=ee(en[0]),er=$[et];en?((eo=_.getElementsByTagNameNS(en,eo)[0])||(eo=_.ownerDocument.createElementNS(en,et),_.appendChild(eo)),eo.textContent=er):runtime.log("Key ignored: "+et)})},this.removeKeyElementsFromNode=function(_,$,ee){$.forEach(function($){var et=$.split(":"),en=et[1];(et=ee(et[0]))?(en=_.getElementsByTagNameNS(et,en)[0])?en.parentNode.removeChild(en):runtime.log("Element for "+$+" not found."):runtime.log("Property Name ignored: "+$)})},this.getKeyValRepresentationOfNode=function(_,$){for(var ee,et={},en=_.firstElementChild;en;)(ee=$(en.namespaceURI))&&(et[ee+":"+en.localName]=en.textContent),en=en.nextElementSibling;return et},this.mapObjOntoNode=eu,this.cloneEvent=function(_){var $=Object.create(null);return Object.keys(_.constructor.prototype).forEach(function(ee){$[ee]=_[ee]}),$.prototype=_.constructor.prototype,$},this.getDirectChild=ee,function(_){var $,ee;null!==(ee=runtime.getWindow())&&(ee=-1===($=ee.navigator.appVersion.toLowerCase()).indexOf("chrome")&&(-1!==$.indexOf("applewebkit")||-1!==$.indexOf("safari")),$=-1!==$.indexOf("msie")||-1!==$.indexOf("trident"),ee||$)&&(_.containsNode=es)}(this)},core.DomUtils=new core.DomUtilsImpl}(),core.Cursor=function(_,$){function ee(_){_.parentNode&&(es.push(_.previousSibling),es.push(_.nextSibling),_.parentNode.removeChild(_))}function et(_,$,ee){if($.nodeType===Node.TEXT_NODE){runtime.assert(!!$,"putCursorIntoTextNode: invalid container");var et=$.parentNode;runtime.assert(!!et,"putCursorIntoTextNode: container without parent"),runtime.assert(0<=ee&&ee<=$.length,"putCursorIntoTextNode: offset is out of bounds"),0===ee?et.insertBefore(_,$):(ee!==$.length&&$.splitText(ee),et.insertBefore(_,$.nextSibling))}else $.nodeType===Node.ELEMENT_NODE&&$.insertBefore(_,$.childNodes.item(ee));es.push(_.previousSibling),es.push(_.nextSibling)}var en,eo,er=_.createElementNS("urn:webodf:names:cursor","cursor"),ei=_.createElementNS("urn:webodf:names:cursor","anchor"),es=[],el=_.createRange(),eu=core.DomUtils;this.getNode=function(){return er},this.getAnchorNode=function(){return ei.parentNode?ei:er},this.getSelectedRange=function(){return eo?(el.setStartBefore(er),el.collapse(!0)):(el.setStartAfter(en?ei:er),el.setEndBefore(en?er:ei)),el},this.setSelectedRange=function(_,$){el&&el!==_&&el.detach(),el=_,en=!1!==$,(eo=_.collapsed)?(ee(ei),ee(er),et(er,_.startContainer,_.startOffset)):(ee(ei),ee(er),et(en?er:ei,_.endContainer,_.endOffset),et(en?ei:er,_.startContainer,_.startOffset)),es.forEach(eu.normalizeTextNodes),es.length=0},this.hasForwardSelection=function(){return en},this.remove=function(){ee(er),es.forEach(eu.normalizeTextNodes),es.length=0},er.setAttributeNS("urn:webodf:names:cursor","memberId",$),ei.setAttributeNS("urn:webodf:names:cursor","memberId",$)},core.Destroyable=function(){},core.Destroyable.prototype.destroy=function(_){},core.EventSource=function(){},core.EventSource.prototype.subscribe=function(_,$){},core.EventSource.prototype.unsubscribe=function(_,$){},core.EventNotifier=function(_){function $(_){runtime.assert(!ee.hasOwnProperty(_),'Duplicated event ids: "'+_+'" registered more than once.'),ee[_]=[]}var ee={};this.emit=function(_,$){var et,en;for(runtime.assert(ee.hasOwnProperty(_),'unknown event fired "'+_+'"'),en=ee[_],et=0;et<en.length;et+=1)en[et]($)},this.subscribe=function(_,$){runtime.assert(ee.hasOwnProperty(_),'tried to subscribe to unknown event "'+_+'"'),ee[_].push($)},this.unsubscribe=function(_,$){var et;runtime.assert(ee.hasOwnProperty(_),'tried to unsubscribe from unknown event "'+_+'"'),et=ee[_].indexOf($),runtime.assert(-1!==et,'tried to unsubscribe unknown callback from event "'+_+'"'),-1!==et&&ee[_].splice(et,1)},this.register=$,_&&_.forEach($)},core.ScheduledTask=function(_,$,ee){function et(){er&&(ee(eo),er=!1)}function en(){et(),_.apply(void 0,ei),ei=null}var eo,er=!1,ei=[],es=!1;this.trigger=function(){runtime.assert(!1===es,"Can't trigger destroyed ScheduledTask instance"),ei=Array.prototype.slice.call(arguments),er||(er=!0,eo=$(en))},this.triggerImmediate=function(){runtime.assert(!1===es,"Can't trigger destroyed ScheduledTask instance"),ei=Array.prototype.slice.call(arguments),en()},this.processRequests=function(){er&&en()},this.cancel=et,this.restart=function(){runtime.assert(!1===es,"Can't trigger destroyed ScheduledTask instance"),et(),er=!0,eo=$(en)},this.destroy=function(_){et(),es=!0,_()}},function(){var _;core.Task={},core.Task.SUPPRESS_MANUAL_PROCESSING=!1,core.Task.processTasks=function(){core.Task.SUPPRESS_MANUAL_PROCESSING||_.performRedraw()},core.Task.createRedrawTask=function($){return new core.ScheduledTask($,_.requestRedrawTask,_.cancelRedrawTask)},core.Task.createTimeoutTask=function(_,$){return new core.ScheduledTask(_,function(_){return runtime.setTimeout(_,$)},runtime.clearTimeout)},_=new function(){var _={};this.requestRedrawTask=function($){var ee=runtime.requestAnimationFrame(function(){$(),delete _[ee]});return _[ee]=$,ee},this.performRedraw=function(){Object.keys(_).forEach(function($){_[$](),runtime.cancelAnimationFrame(parseInt($,10))}),_={}},this.cancelRedrawTask=function($){runtime.cancelAnimationFrame($),delete _[$]}}}(),core.EventSubscriptions=function(){function _(_,$,et){_.subscribe($,et),ee.push({eventSource:_,eventid:$,callback:et})}function $(){var _=[];ee.forEach(function(_){_.eventSource.unsubscribe(_.eventid,_.callback)}),ee.length=0,Object.keys(en).forEach(function($){en[$].forEach(function($){_.push($.task.destroy)}),delete en[$]}),core.Async.destroyAll(_,function(){}),et=new core.EventNotifier}var ee=[],et=new core.EventNotifier,en={},eo=0;this.addSubscription=_,this.addFrameSubscription=function($,ee,er){var ei,es,el,eu;for(en.hasOwnProperty(ee)||(en[ee]=[]),el=en[ee],eu=0;eu<el.length;eu+=1)if(el[eu].eventSource===$){ei=el[eu];break}ei||(es="s"+eo,eo+=1,et.register(es),ei={frameEventId:es,eventSource:$,task:core.Task.createRedrawTask(function(){et.emit(es,void 0)})},el.push(ei),_($,ee,ei.task.trigger)),et.subscribe(ei.frameEventId,er)},this.unsubscribeAll=$,this.destroy=function(_){$(),_()}},core.LazyProperty=function(_){var $,ee=!1;this.value=function(){return ee||($=_(),ee=!0),$},this.reset=function(){ee=!1}},core.LoopWatchDog=function(_,$){var ee=Date.now(),et=0;this.check=function(){if(_&&Date.now()-ee>_)throw runtime.log("alert","watchdog timeout"),"timeout!";if(0<$&&(et+=1)>$)throw runtime.log("alert","watchdog loop overflow"),"loop overflow"}},core.NodeFilterChain=function(_){var $=NodeFilter.FILTER_REJECT,ee=NodeFilter.FILTER_ACCEPT;this.acceptNode=function(et){var en;for(en=0;en<_.length;en+=1)if(_[en].acceptNode(et)===$)return $;return ee}},core.PositionIterator=function(_,$,ee,et){function en(){this.acceptNode=function(_){return _&&(_.nodeType!==ef||0!==_.length)?em:eh}}function eo(_){this.acceptNode=function($){return $&&($.nodeType!==ef||0!==$.length)?_.acceptNode($):eh}}function er(){var _=el.currentNode,$=_.nodeType;eu=$===ef?_.length-1:$===ep?1:0}function ei(){if(null===el.previousSibling()){if(!el.parentNode()||el.currentNode===_)return el.firstChild(),!1;eu=0}else er();return!0}function es(){var $,ee=el.currentNode;if($=ec(ee),ee!==_)for(ee=ee.parentNode;ee&&ee!==_;)ec(ee)===eh&&(el.currentNode=ee,$=eh),ee=ee.parentNode;return $===eh?(eu=el.currentNode.nodeType===ef?ee.length:1,ee=ed.nextPosition()):ee=$===em||ed.nextPosition(),ee&&runtime.assert(ec(el.currentNode)===em,"moveToAcceptedNode did not result in walker being on an accepted node"),ee}var el,eu,ec,ed=this,ef=Node.TEXT_NODE,ep=Node.ELEMENT_NODE,em=NodeFilter.FILTER_ACCEPT,eh=NodeFilter.FILTER_REJECT;this.nextPosition=function(){var $=el.currentNode,ee=$.nodeType;if($===_)return!1;if(0===eu&&ee===ep)null===el.firstChild()&&(eu=1);else if(ee===ef&&eu+1<$.length)eu+=1;else if(null!==el.nextSibling())eu=0;else{if(!el.parentNode())return!1;eu=1}return!0},this.previousPosition=function(){var $=!0,ee=el.currentNode;return 0===eu?$=ei():ee.nodeType===ef?--eu:null!==el.lastChild()?er():ee===_?$=!1:eu=0,$},this.previousNode=ei,this.container=function(){var _=el.currentNode,$=_.nodeType;return 0===eu&&$!==ef&&(_=_.parentNode),_},this.rightNode=function(){var _=el.currentNode,$=_.nodeType;if($===ef&&eu===_.length)for(_=_.nextSibling;_&&ec(_)!==em;)_=_.nextSibling;else $===ep&&1===eu&&(_=null);return _},this.leftNode=function(){var _=el.currentNode;if(0===eu)for(_=_.previousSibling;_&&ec(_)!==em;)_=_.previousSibling;else if(_.nodeType===ep)for(_=_.lastChild;_&&ec(_)!==em;)_=_.previousSibling;return _},this.getCurrentNode=function(){return el.currentNode},this.unfilteredDomOffset=function(){if(el.currentNode.nodeType===ef)return eu;for(var _=0,$=el.currentNode,$=1===eu?$.lastChild:$.previousSibling;$;)_+=1,$=$.previousSibling;return _},this.getPreviousSibling=function(){var _=el.currentNode,$=el.previousSibling();return el.currentNode=_,$},this.getNextSibling=function(){var _=el.currentNode,$=el.nextSibling();return el.currentNode=_,$},this.setPositionBeforeElement=function(_){return runtime.assert(!!_,"setPositionBeforeElement called without element"),el.currentNode=_,eu=0,es()},this.setUnfilteredPosition=function(_,$){return runtime.assert(!!_,"PositionIterator.setUnfilteredPosition called without container"),el.currentNode=_,_.nodeType===ef?(eu=$,runtime.assert($<=_.length,"Error in setPosition: "+$+" > "+_.length),runtime.assert(0<=$,"Error in setPosition: "+$+" < 0"),$===_.length&&(el.nextSibling()?eu=0:el.parentNode()?eu=1:runtime.assert(!1,"Error in setUnfilteredPosition: position not valid."))):$<_.childNodes.length?(el.currentNode=_.childNodes.item($),eu=0):eu=1,es()},this.moveToEnd=function(){el.currentNode=_,eu=1},this.moveToEndOfNode=function(_){_.nodeType===ef?ed.setUnfilteredPosition(_,_.length):(el.currentNode=_,eu=1)},this.isBeforeNode=function(){return 0===eu},this.getNodeFilter=function(){return ec},(ec=(ee?new eo(ee):new en).acceptNode).acceptNode=ec,$=$||NodeFilter.SHOW_ALL,runtime.assert(_.nodeType!==Node.TEXT_NODE,"Internet Explorer doesn't allow tree walker roots to be text nodes"),el=_.ownerDocument.createTreeWalker(_,$,ec,et),eu=0,null===el.firstChild()&&(eu=1)},core.PositionFilter=function(){},core.PositionFilter.FilterResult={FILTER_ACCEPT:1,FILTER_REJECT:2,FILTER_SKIP:3},core.PositionFilter.prototype.acceptPosition=function(_){},core.PositionFilterChain=function(){var _=[],$=core.PositionFilter.FilterResult.FILTER_ACCEPT,ee=core.PositionFilter.FilterResult.FILTER_REJECT;this.acceptPosition=function(et){var en;for(en=0;en<_.length;en+=1)if(_[en].acceptPosition(et)===ee)return ee;return $},this.addFilter=function($){_.push($)}},core.StepDirection={PREVIOUS:1,NEXT:2},core.StepIterator=function(_,$){function ee(){el=null,ec=eu=void 0}function et(){return void 0===ec&&(ec=_.acceptPosition($)===ed),ec}function en(_,et){return ee(),$.setUnfilteredPosition(_,et)}function eo(){return el||(el=$.container()),el}function er(){return void 0===eu&&(eu=$.unfilteredDomOffset()),eu}function ei(){for(ee();$.nextPosition();)if(ee(),et())return!0;return!1}function es(){for(ee();$.previousPosition();)if(ee(),et())return!0;return!1}var el,eu,ec,ed=core.PositionFilter.FilterResult.FILTER_ACCEPT,ef=core.StepDirection.NEXT;this.isStep=et,this.setPosition=en,this.container=eo,this.offset=er,this.nextStep=ei,this.previousStep=es,this.advanceStep=function(_){return _===ef?ei():es()},this.roundToClosestStep=function(){var _,$,ee=et();return ee||(_=eo(),$=er(),(ee=es())||(en(_,$),ee=ei())),ee},this.roundToPreviousStep=function(){var _=et();return _||(_=es()),_},this.roundToNextStep=function(){var _=et();return _||(_=ei()),_},this.leftNode=function(){return $.leftNode()},this.snapshot=function(){return new core.StepIterator.StepSnapshot(eo(),er())},this.restore=function(_){en(_.container,_.offset)}},core.StepIterator.StepSnapshot=function(_,$){this.container=_,this.offset=$},core.Utils=function(){function _($,ee){if(ee&&Array.isArray(ee)){if(!Array.isArray($=$||[]))throw"Destination is not an array.";$=$.concat(ee.map(function($){return _(null,$)}))}else if(ee&&"object"==typeof ee){if("object"!=typeof($=$||{}))throw"Destination is not an object.";Object.keys(ee).forEach(function(et){$[et]=_($[et],ee[et])})}else $=ee;return $}this.hashString=function(_){var $,ee,et=0;for($=0,ee=_.length;$<ee;$+=1)et=(et<<5)-et+_.charCodeAt($)|0;return et},this.mergeObjects=function($,ee){return Object.keys(ee).forEach(function(et){$[et]=_($[et],ee[et])}),$}},core.Zip=function(_,$){function ee(_,$){var ee=er.file(_);ee?$(null,ee.asUint8Array()):$(_+" not found.",null)}function et(_,$){ee(_,function(_,ee){if(_||null===ee)return $(_,null);var et=runtime.byteArrayToString(ee,"utf8");$(null,et)})}function en(_,$){try{_(er.generate({type:"uint8array",compression:"DEFLATE"}))}catch(_){$(_.message)}}function eo(_,$){en(function(ee){runtime.writeFile(_,ee,$)},$)}var er,ei=this,es=new core.Base64;this.load=ee,this.save=function(_,$,ee,et){er.file(_,$,{date:et,compression:ee?null:"STORE"})},this.remove=function(_){var $=null!==er.file(_);return er.remove(_),$},this.write=function($){eo(_,$)},this.writeAs=eo,this.createByteArray=en,this.loadContentXmlAsFragments=function(_,$){et(_,function(_,ee){if(_)return $.rootElementReady(_);$.rootElementReady(null,ee,!0)})},this.loadAsString=et,this.loadAsDOM=function(_,$){et(_,function(_,ee){_||null===ee?$(_,null):$(null,(new DOMParser).parseFromString(ee,"text/xml"))})},this.loadAsDataURL=function(_,$,et){ee(_,function(_,ee){if(_||!ee)return et(_,null);var en,eo=0;for($||($=80===ee[1]&&78===ee[2]&&71===ee[3]?"image/png":255===ee[0]&&216===ee[1]&&255===ee[2]?"image/jpeg":71===ee[0]&&73===ee[1]&&70===ee[2]?"image/gif":""),en="data:"+$+";base64,";eo<ee.length;)en+=es.convertUTF8ArrayToBase64(ee.subarray(eo,Math.min(eo+45e3,ee.length))),eo+=45e3;et(null,en)})},this.getEntries=function(){return Object.keys(er.files).map(function(_){return{filename:_}})},er=new externs.JSZip,null!==$&&runtime.readFile(_,"binary",function(ee,et){if("string"==typeof et&&(ee="file was read as a string. Should be Uint8Array."),ee||!et||0===et.length)$("File '"+_+"' cannot be read. Err: "+(ee||"[none]"),ei);else try{er.load(et,{checkCRC32:!1}),$(null,ei)}catch(_){$(_.message,ei)}})},core.SimpleClientRect=null,gui.CommonConstraints={EDIT:{ANNOTATIONS:{ONLY_DELETE_OWN:"onlyDeleteOwn"},REVIEW_MODE:"reviewMode"}},gui.SessionConstraints=function(){function _(_){$.hasOwnProperty(_)||($[_]=!1,ee.register(_))}var $={},ee=new core.EventNotifier;this.registerConstraint=_,this.subscribe=function($,et){_($),ee.subscribe($,et)},this.unsubscribe=function(_,$){ee.unsubscribe(_,$)},this.setState=function(_,et){runtime.assert(!0===$.hasOwnProperty(_),"No such constraint"),$[_]!==et&&($[_]=et,ee.emit(_,et))},this.getState=function(_){return runtime.assert(!0===$.hasOwnProperty(_),"No such constraint"),$[_]}},gui.BlacklistNamespaceNodeFilter=function(_){var $={},ee=NodeFilter.FILTER_REJECT,et=NodeFilter.FILTER_ACCEPT;this.acceptNode=function(_){return!_||$.hasOwnProperty(_.namespaceURI)?ee:et},function(){_.forEach(function(_){$[_]=!0})}()},odf.Namespaces={namespaceMap:{config:"urn:oasis:names:tc:opendocument:xmlns:config:1.0",db:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",dc:"http://purl.org/dc/elements/1.1/",dr3d:"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",draw:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",chart:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",fo:"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0",form:"urn:oasis:names:tc:opendocument:xmlns:form:1.0",math:"http://www.w3.org/1998/Math/MathML",meta:"urn:oasis:names:tc:opendocument:xmlns:meta:1.0",number:"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0",office:"urn:oasis:names:tc:opendocument:xmlns:office:1.0",presentation:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",style:"urn:oasis:names:tc:opendocument:xmlns:style:1.0",svg:"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0",table:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",text:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",xforms:"http://www.w3.org/2002/xforms",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"},prefixMap:{},configns:"urn:oasis:names:tc:opendocument:xmlns:config:1.0",dbns:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",dcns:"http://purl.org/dc/elements/1.1/",dr3dns:"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",drawns:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",chartns:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",fons:"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0",formns:"urn:oasis:names:tc:opendocument:xmlns:form:1.0",mathns:"http://www.w3.org/1998/Math/MathML",metans:"urn:oasis:names:tc:opendocument:xmlns:meta:1.0",numberns:"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0",officens:"urn:oasis:names:tc:opendocument:xmlns:office:1.0",presentationns:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",stylens:"urn:oasis:names:tc:opendocument:xmlns:style:1.0",svgns:"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0",tablens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",textns:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",xformsns:"http://www.w3.org/2002/xforms",xlinkns:"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/XML/1998/namespace"},function(){var _,$=odf.Namespaces.namespaceMap,ee=odf.Namespaces.prefixMap;for(_ in $)$.hasOwnProperty(_)&&(ee[$[_]]=_)}(),odf.Namespaces.forEachPrefix=function(_){var $,ee=odf.Namespaces.namespaceMap;for($ in ee)ee.hasOwnProperty($)&&_($,ee[$])},odf.Namespaces.lookupNamespaceURI=function(_){var $=null;return odf.Namespaces.namespaceMap.hasOwnProperty(_)&&($=odf.Namespaces.namespaceMap[_]),$},odf.Namespaces.lookupPrefix=function(_){var $=odf.Namespaces.prefixMap;return $.hasOwnProperty(_)?$[_]:null},odf.Namespaces.lookupNamespaceURI.lookupNamespaceURI=odf.Namespaces.lookupNamespaceURI,function(){odf.OdfSchemaImpl=function(){var _=[["config:config-item","uncategorized"],["form:item","object"],["form:option","uncategorized"],["math:math","field"],["meta:user-defined","uncategorized"],["number:currency-symbol","uncategorized"],["number:embedded-text","uncategorized"],["number:text","uncategorized"],["presentation:date-time-decl","uncategorized"],["presentation:footer-decl","uncategorized"],["presentation:header-decl","uncategorized"],["svg:desc","text"],["svg:title","text"],["table:desc","uncategorized"],["table:title","uncategorized"],["text:a","text"],["text:author-initials","field"],["text:author-name","field"],["text:bibliography-mark","field"],["text:bookmark-ref","field"],["text:chapter","field"],["text:character-count","field"],["text:conditional-text","field"],["text:creation-date","field"],["text:creation-time","field"],["text:creator","field"],["text:database-display","field"],["text:database-name","field"],["text:database-row-number","field"],["text:date","field"],["text:dde-connection","field"],["text:description","field"],["text:editing-cycles","field"],["text:editing-duration","field"],["text:execute-macro","uncategorized"],["text:expression","uncategorized"],["text:file-name","field"],["text:h","text"],["text:hidden-paragraph","text"],["text:hidden-text","text"],["text:image-count","field"],["text:index-entry-span","uncategorized"],["text:index-title-template","uncategorized"],["text:initial-creator","field"],["text:keywords","field"],["text:linenumbering-separator","style"],["text:measure","uncategorized"],["text:meta","uncategorized"],["text:meta-field","uncategorized"],["text:modification-date","field"],["text:modification-time","field"],["text:note-citation","field"],["text:note-continuation-notice-backward","style"],["text:note-continuation-notice-forward","style"],["text:note-ref","field"],["text:object-count","field"],["text:p","text"],["text:page-continuation","uncategorized"],["text:page-count","field"],["text:page-number","field"],["text:page-variable-get","field"],["text:page-variable-set","field"],["text:paragraph-count","field"],["text:placeholder","field"],["text:print-date","field"],["text:print-time","field"],["text:printed-by","field"],["text:reference-ref","field"],["text:ruby-base","text"],["text:ruby-text","text"],["text:script","text"],["text:sender-city","field"],["text:sender-company","field"],["text:sender-country","field"],["text:sender-email","field"],["text:sender-fax","field"],["text:sender-firstname","field"],["text:sender-initials","field"],["text:sender-lastname","field"],["text:sender-phone-private","field"],["text:sender-phone-work","field"],["text:sender-position","field"],["text:sender-postal-code","field"],["text:sender-state-or-province","field"],["text:sender-street","field"],["text:sender-title","field"],["text:sequence","uncategorized"],["text:sequence-ref","uncategorized"],["text:sheet-name","uncategorized"],["text:span","text"],["text:subject","field"],["text:table-count","field"],["text:table-formula","deprecated"],["text:template-name","uncategorized"],["text:text-input","field"],["text:time","field"],["text:title","field"],["text:user-defined","field"],["text:user-field-get","field"],["text:user-field-input","field"],["text:variable-get","field"],["text:variable-input","field"],["text:variable-set","field"],["text:word-count","field"],["xforms:model","uncategorized"]],$={};this.isTextContainer=function(_,ee){return"text"===$[_+":"+ee]},this.isField=function(_,ee){return"field"===$[_+":"+ee]},this.getFields=function(){return _.filter(function(_){return"field"===_[1]}).map(function(_){return _[0]})},function(){_.forEach(function(_){var ee=_[1],et=_[0].split(":");_=et[0];var et=et[1],en=odf.Namespaces.lookupNamespaceURI(_);en?$[en+":"+et]=ee:runtime.log("DEBUG: OdfSchema - unknown prefix '"+_+"'")})}()},odf.OdfSchema=new odf.OdfSchemaImpl}(),odf.OdfUtilsImpl=function(){function _(_){return"image"===(_&&_.localName)&&_.namespaceURI===e_}function $(_){return null!==_&&_.nodeType===Node.ELEMENT_NODE&&"frame"===_.localName&&_.namespaceURI===e_&&"as-char"===_.getAttributeNS(eD,"anchor-type")}function ee(_){var $;return($="annotation"===(_&&_.localName)&&_.namespaceURI===odf.Namespaces.officens)||($="div"===(_&&_.localName)&&"annotationWrapper"===_.className),$}function et(_){return"a"===(_&&_.localName)&&_.namespaceURI===eD}function en(_){var $=_&&_.localName;return("p"===$||"h"===$)&&_.namespaceURI===eD}function eo(_,$){for(_&&void 0!==$&&!en(_)&&_.childNodes.item($)&&(_=_.childNodes.item($));_&&!en(_);)_=_.parentNode;return _}function er(_,$){for(;_&&_!==$;){if(_.namespaceURI===odf.Namespaces.officens&&"annotation"===_.localName)return _;_=_.parentNode}return null}function ei(_){return/^[ \t\r\n]+$/.test(_)}function es(_){if(null===_||_.nodeType!==Node.ELEMENT_NODE)return!1;var $=_.localName;return eM.isTextContainer(_.namespaceURI,$)||"span"===$&&"webodf-annotationHighlight"===_.className}function el(_){return null!==_&&_.nodeType===Node.ELEMENT_NODE&&eM.isField(_.namespaceURI,_.localName)}function eu(_){var $=_&&_.localName,ee=!1;return $&&(_=_.namespaceURI)===eD&&(ee="s"===$||"tab"===$||"line-break"===$),ee}function ec(_){return eu(_)||el(_)||$(_)||ee(_)}function ed(_){var $=_&&_.localName,ee=!1;return $&&(_=_.namespaceURI)===eD&&(ee="s"===$),ee}function ef(_){return -1!==eF.indexOf(_.namespaceURI)}function ep(_){if(eu(_)||el(_))return!1;if(es(_.parentNode)&&_.nodeType===Node.TEXT_NODE)return 0===_.textContent.length;for(_=_.firstChild;_;){if(ef(_)||!ep(_))return!1;_=_.nextSibling}return!0}function em(_){for(;null!==_.firstChild&&es(_);)_=_.firstChild;return _}function eh(_){for(;null!==_.lastChild&&es(_);)_=_.lastChild;return _}function eg(_){for(;!en(_)&&null===_.previousSibling;)_=_.parentNode;return en(_)?null:eh(_.previousSibling)}function eb(_){for(;!en(_)&&null===_.nextSibling;)_=_.parentNode;return en(_)?null:em(_.nextSibling)}function ey(_){for(var $=!1;_;)if(_.nodeType===Node.TEXT_NODE){if(0!==_.length)return!ei(_.data.substr(_.length-1,1));_=eg(_)}else ec(_)?($=!1===ed(_),_=null):_=eg(_);return $}function ev(_){var $=!1;for(_=_&&em(_);_;){if(0<(_.nodeType===Node.TEXT_NODE?_.length:0)&&!ei(_.data)||ec(_)){$=!0;break}_=eb(_)}return $}function eS(_,$){return!!ei(_.data.substr($))&&!ev(eb(_))}function eN(_,$){var ee,et=_.data;return!(!ei(et[$])||ec(_.parentNode))&&(0<$?ei(et[$-1])||(ee=!0):ey(eg(_))&&(ee=!0),!0===ee&&!eS(_,$))}function eC(_){return(_=/(-?[0-9]*[0-9][0-9]*(\.[0-9]*)?|0+\.[0-9]*[1-9][0-9]*|\.[0-9]*[1-9][0-9]*)((cm)|(mm)|(in)|(pt)|(pc)|(px)|(%))/.exec(_))?{value:parseFloat(_[1]),unit:_[3]}:null}function ex(_){return(_=eC(_))&&(0>_.value||"%"===_.unit)?null:_}function ew(_){return(_=eC(_))&&"%"!==_.unit?null:_}function eE(_){switch(_.namespaceURI){case odf.Namespaces.drawns:case odf.Namespaces.svgns:case odf.Namespaces.dr3dns:return!1;case odf.Namespaces.textns:switch(_.localName){case"note-body":case"ruby-text":return!1}break;case odf.Namespaces.officens:switch(_.localName){case"annotation":case"binary-data":case"event-listeners":return!1}break;default:switch(_.localName){case"cursor":case"editinfo":return!1}}return!0}function eT(_){return!!(eo(_)&&(!ei(_.textContent)||eN(_,0)))}function eO(_,$){for(;0<$.length&&!eI.rangeContainsNode(_,$[0]);)$.shift();for(;0<$.length&&!eI.rangeContainsNode(_,$[$.length-1]);)$.pop()}function eA(_,$,et){var en;return en=eI.getNodesInRange(_,function(_){var $=NodeFilter.FILTER_REJECT;return eu(_.parentNode)||el(_.parentNode)||ee(_)?$=NodeFilter.FILTER_REJECT:_.nodeType===Node.TEXT_NODE?(et||eT(_))&&($=NodeFilter.FILTER_ACCEPT):ec(_)?$=NodeFilter.FILTER_ACCEPT:(eE(_)||es(_))&&($=NodeFilter.FILTER_SKIP),$},NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT),$||eO(_,en),en}function eR(_,$,et){for(;_;){if(et(_)){$[0]!==_&&$.unshift(_);break}if(ee(_))break;_=_.parentNode}}function eP(_,$){var ee=_;if($<ee.childNodes.length-1)ee=ee.childNodes[$+1];else{for(;!ee.nextSibling;)ee=ee.parentNode;ee=ee.nextSibling}for(;ee.firstChild;)ee=ee.firstChild;return ee}var eD=odf.Namespaces.textns,e_=odf.Namespaces.drawns,ek=odf.Namespaces.xlinkns,eI=core.DomUtils,eF=[odf.Namespaces.dbns,odf.Namespaces.dcns,odf.Namespaces.dr3dns,odf.Namespaces.drawns,odf.Namespaces.chartns,odf.Namespaces.formns,odf.Namespaces.numberns,odf.Namespaces.officens,odf.Namespaces.presentationns,odf.Namespaces.stylens,odf.Namespaces.svgns,odf.Namespaces.tablens,odf.Namespaces.textns],eM=odf.OdfSchema;this.isImage=_,this.isCharacterFrame=$,this.isInlineRoot=ee,this.isTextSpan=function(_){return"span"===(_&&_.localName)&&_.namespaceURI===eD},this.isHyperlink=et,this.getHyperlinkTarget=function(_){return _.getAttributeNS(ek,"href")||""},this.isParagraph=en,this.getParagraphElement=eo,this.getParentAnnotation=er,this.isWithinAnnotation=function(_,$){return!!er(_,$)},this.getAnnotationCreator=function(_){return _.getElementsByTagNameNS(odf.Namespaces.dcns,"creator")[0].textContent},this.isListItem=function(_){return"list-item"===(_&&_.localName)&&_.namespaceURI===eD},this.isLineBreak=function(_){return"line-break"===(_&&_.localName)&&_.namespaceURI===eD},this.isODFWhitespace=ei,this.isGroupingElement=es,this.isFieldElement=el,this.isCharacterElement=eu,this.isAnchoredAsCharacterElement=ec,this.isSpaceElement=ed,this.isODFNode=ef,this.hasNoODFContent=ep,this.firstChild=em,this.lastChild=eh,this.previousNode=eg,this.nextNode=eb,this.scanLeftForNonSpace=ey,this.lookLeftForCharacter=function(_){var $,ee=$=0;return _.nodeType===Node.TEXT_NODE&&(ee=_.length),0<ee?$=ei(($=_.data).substr(ee-1,1))?1===ee?ey(eg(_))?2:0:ei($.substr(ee-2,1))?0:2:1:ec(_)&&($=1),$},this.lookRightForCharacter=function(_){var $=!1,ee=0;return _&&_.nodeType===Node.TEXT_NODE&&(ee=_.length),0<ee?$=!ei(_.data.substr(0,1)):ec(_)&&($=!0),$},this.scanLeftForAnyCharacter=function(_){var $=!1;for(_=_&&eh(_);_;){if(0<(_.nodeType===Node.TEXT_NODE?_.length:0)&&!ei(_.data)||ec(_)){$=!0;break}_=eg(_)}return $},this.scanRightForAnyCharacter=ev,this.isTrailingWhitespace=eS,this.isSignificantWhitespace=eN,this.isDowngradableSpaceElement=function(_){return!!ed(_)&&ey(eg(_))&&ev(eb(_))},this.parseLength=eC,this.parseNonNegativeLength=ex,this.parseFoFontSize=function(_){var $;return($=($=eC(_))&&(0>=$.value||"%"===$.unit)?null:$)||ew(_)},this.parseFoLineHeight=function(_){return ex(_)||ew(_)},this.isTextContentContainingNode=eE,this.getTextNodes=function(_,$){var ee;return ee=eI.getNodesInRange(_,function(_){var $=NodeFilter.FILTER_REJECT;return _.nodeType===Node.TEXT_NODE?eT(_)&&($=NodeFilter.FILTER_ACCEPT):eE(_)&&($=NodeFilter.FILTER_SKIP),$},NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT),$||eO(_,ee),ee},this.getTextElements=eA,this.getParagraphElements=function(_){var $;return $=eI.getNodesInRange(_,function(_){var $=NodeFilter.FILTER_REJECT;return en(_)?$=NodeFilter.FILTER_ACCEPT:(eE(_)||es(_))&&($=NodeFilter.FILTER_SKIP),$},NodeFilter.SHOW_ELEMENT),eR(_.startContainer,$,en),$},this.getImageElements=function($){var ee;return ee=eI.getNodesInRange($,function($){var ee=NodeFilter.FILTER_SKIP;return _($)&&(ee=NodeFilter.FILTER_ACCEPT),ee},NodeFilter.SHOW_ELEMENT),eR($.startContainer,ee,_),ee},this.getHyperlinkElements=function(_){var $=[],ee=_.cloneRange();return _.collapsed&&_.endContainer.nodeType===Node.ELEMENT_NODE&&(_=eP(_.endContainer,_.endOffset)).nodeType===Node.TEXT_NODE&&ee.setEnd(_,1),eA(ee,!0,!1).forEach(function(_){for(_=_.parentNode;!en(_);){if(et(_)&&-1===$.indexOf(_)){$.push(_);break}_=_.parentNode}}),ee.detach(),$},this.getNormalizedFontFamilyName=function(_){return/^(["'])(?:.|[\n\r])*?\1$/.test(_)||(_=_.replace(/^[ \t\r\n\f]*((?:.|[\n\r])*?)[ \t\r\n\f]*$/,"$1"),/[ \t\r\n\f]/.test(_)&&(_="'"+_.replace(/[ \t\r\n\f]+/g," ")+"'")),_}},odf.OdfUtils=new odf.OdfUtilsImpl,gui.OdfTextBodyNodeFilter=function(){var _=odf.OdfUtils,$=Node.TEXT_NODE,ee=NodeFilter.FILTER_REJECT,et=NodeFilter.FILTER_ACCEPT,en=odf.Namespaces.textns;this.acceptNode=function(eo){if(eo.nodeType===$){if(!_.isGroupingElement(eo.parentNode))return ee}else if(eo.namespaceURI===en&&"tracked-changes"===eo.localName)return ee;return et}},xmldom.LSSerializerFilter=function(){},xmldom.LSSerializerFilter.prototype.acceptNode=function(_){},odf.OdfNodeFilter=function(){this.acceptNode=function(_){return"http://www.w3.org/1999/xhtml"===_.namespaceURI?NodeFilter.FILTER_SKIP:_.namespaceURI&&_.namespaceURI.match(/^urn:webodf:/)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}},xmldom.XPathIterator=function(){},xmldom.XPathIterator.prototype.next=function(){},xmldom.XPathIterator.prototype.reset=function(){},xmldom.XPath=createXPathSingleton(),odf.StyleInfo=function(){function _($,ee){var et,en,eo,er,ei,es=0;for((et=ec[$.localName])&&(eo=et[$.namespaceURI])&&(es=eo.length),et=0;et<es;et+=1)er=(en=eo[et]).ns,ei=en.localname,(en=$.getAttributeNS(er,ei))&&$.setAttributeNS(er,eC[er]+ei,ee+en);for(eo=$.firstElementChild;eo;)_(eo,ee),eo=eo.nextElementSibling}function $(_,ee){var et,en,eo,er,ei,es=0;for((et=ec[_.localName])&&(eo=et[_.namespaceURI])&&(es=eo.length),et=0;et<es;et+=1)er=(en=eo[et]).ns,ei=en.localname,(en=_.getAttributeNS(er,ei))&&(en=en.replace(ee,""),_.setAttributeNS(er,eC[er]+ei,en));for(eo=_.firstElementChild;eo;)$(eo,ee),eo=eo.nextElementSibling}function ee(_,$){var ee,et,en,eo,er,ei=0;for((ee=ec[_.localName])&&(en=ee[_.namespaceURI])&&(ei=en.length),ee=0;ee<ei;ee+=1)et=(eo=en[ee]).ns,er=eo.localname,(et=_.getAttributeNS(et,er))&&($=$||{},eo=eo.keyname,$.hasOwnProperty(eo)?$[eo][et]=1:((er={})[et]=1,$[eo]=er));return $}function et(_,$){var en;for(ee(_,$),en=_.firstChild;en;)en.nodeType===Node.ELEMENT_NODE&&et(en,$),en=en.nextSibling}function en(_,$,ee){this.key=_,this.name=$,this.family=ee,this.requires={}}function eo(_,$,ee){var et=_+'"'+$,eo=ee[et];return eo||(eo=ee[et]=new en(et,_,$)),eo}function er(_,$,ee){var et,en,ei,es,el,eu=0;if(et=_.getAttributeNS(ev,"name"),es=_.getAttributeNS(ev,"family"),et&&es&&($=eo(et,es,ee)),$)for((et=ec[_.localName])&&(ei=et[_.namespaceURI])&&(eu=ei.length),et=0;et<eu;et+=1)en=(es=ei[et]).ns,el=es.localname,(en=_.getAttributeNS(en,el))&&(es=es.keyname,es=eo(en,es,ee),$.requires[es.key]=es);for(_=_.firstElementChild;_;)er(_,$,ee),_=_.nextElementSibling;return ee}function ei(_,$){var ee=$[_.family];ee||(ee=$[_.family]={}),ee[_.name]=1,Object.keys(_.requires).forEach(function(ee){ei(_.requires[ee],$)})}function es(_,$){var ee=er(_,null,{});Object.keys(ee).forEach(function(_){var et=$[(_=ee[_]).family];et&&et.hasOwnProperty(_.name)&&ei(_,$)})}function el(_,$){function ee($){($=en.getAttributeNS(ev,$))&&(_[$]=!0)}var et,en,eo=["font-name","font-name-asian","font-name-complex"];for(et=$&&$.firstElementChild;et;)en=et,eo.forEach(ee),el(_,en),et=et.nextElementSibling}function eu(_,$){function ee(_){var ee=en.getAttributeNS(ev,_);ee&&$.hasOwnProperty(ee)&&en.setAttributeNS(ev,"style:"+_,$[ee])}var et,en,eo=["font-name","font-name-asian","font-name-complex"];for(et=_&&_.firstElementChild;et;)en=et,eo.forEach(ee),eu(en,$),et=et.nextElementSibling}var ec,ed=odf.Namespaces.chartns,ef=odf.Namespaces.dbns,ep=odf.Namespaces.dr3dns,em=odf.Namespaces.drawns,eh=odf.Namespaces.formns,eg=odf.Namespaces.numberns,eb=odf.Namespaces.officens,ey=odf.Namespaces.presentationns,ev=odf.Namespaces.stylens,eS=odf.Namespaces.tablens,eN=odf.Namespaces.textns,eC={"urn:oasis:names:tc:opendocument:xmlns:chart:1.0":"chart:","urn:oasis:names:tc:opendocument:xmlns:database:1.0":"db:","urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0":"dr3d:","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0":"draw:","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0":"fo:","urn:oasis:names:tc:opendocument:xmlns:form:1.0":"form:","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0":"number:","urn:oasis:names:tc:opendocument:xmlns:office:1.0":"office:","urn:oasis:names:tc:opendocument:xmlns:presentation:1.0":"presentation:","urn:oasis:names:tc:opendocument:xmlns:style:1.0":"style:","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0":"svg:","urn:oasis:names:tc:opendocument:xmlns:table:1.0":"table:","urn:oasis:names:tc:opendocument:xmlns:text:1.0":"chart:","http://www.w3.org/XML/1998/namespace":"xml:"},ex={text:[{ens:ev,en:"tab-stop",ans:ev,a:"leader-text-style"},{ens:ev,en:"drop-cap",ans:ev,a:"style-name"},{ens:eN,en:"notes-configuration",ans:eN,a:"citation-body-style-name"},{ens:eN,en:"notes-configuration",ans:eN,a:"citation-style-name"},{ens:eN,en:"a",ans:eN,a:"style-name"},{ens:eN,en:"alphabetical-index",ans:eN,a:"style-name"},{ens:eN,en:"linenumbering-configuration",ans:eN,a:"style-name"},{ens:eN,en:"list-level-style-number",ans:eN,a:"style-name"},{ens:eN,en:"ruby-text",ans:eN,a:"style-name"},{ens:eN,en:"span",ans:eN,a:"style-name"},{ens:eN,en:"a",ans:eN,a:"visited-style-name"},{ens:ev,en:"text-properties",ans:ev,a:"text-line-through-text-style"},{ens:eN,en:"alphabetical-index-source",ans:eN,a:"main-entry-style-name"},{ens:eN,en:"index-entry-bibliography",ans:eN,a:"style-name"},{ens:eN,en:"index-entry-chapter",ans:eN,a:"style-name"},{ens:eN,en:"index-entry-link-end",ans:eN,a:"style-name"},{ens:eN,en:"index-entry-link-start",ans:eN,a:"style-name"},{ens:eN,en:"index-entry-page-number",ans:eN,a:"style-name"},{ens:eN,en:"index-entry-span",ans:eN,a:"style-name"},{ens:eN,en:"index-entry-tab-stop",ans:eN,a:"style-name"},{ens:eN,en:"index-entry-text",ans:eN,a:"style-name"},{ens:eN,en:"index-title-template",ans:eN,a:"style-name"},{ens:eN,en:"list-level-style-bullet",ans:eN,a:"style-name"},{ens:eN,en:"outline-level-style",ans:eN,a:"style-name"}],paragraph:[{ens:em,en:"caption",ans:em,a:"text-style-name"},{ens:em,en:"circle",ans:em,a:"text-style-name"},{ens:em,en:"connector",ans:em,a:"text-style-name"},{ens:em,en:"control",ans:em,a:"text-style-name"},{ens:em,en:"custom-shape",ans:em,a:"text-style-name"},{ens:em,en:"ellipse",ans:em,a:"text-style-name"},{ens:em,en:"frame",ans:em,a:"text-style-name"},{ens:em,en:"line",ans:em,a:"text-style-name"},{ens:em,en:"measure",ans:em,a:"text-style-name"},{ens:em,en:"path",ans:em,a:"text-style-name"},{ens:em,en:"polygon",ans:em,a:"text-style-name"},{ens:em,en:"polyline",ans:em,a:"text-style-name"},{ens:em,en:"rect",ans:em,a:"text-style-name"},{ens:em,en:"regular-polygon",ans:em,a:"text-style-name"},{ens:eb,en:"annotation",ans:em,a:"text-style-name"},{ens:eh,en:"column",ans:eh,a:"text-style-name"},{ens:ev,en:"style",ans:ev,a:"next-style-name"},{ens:eS,en:"body",ans:eS,a:"paragraph-style-name"},{ens:eS,en:"even-columns",ans:eS,a:"paragraph-style-name"},{ens:eS,en:"even-rows",ans:eS,a:"paragraph-style-name"},{ens:eS,en:"first-column",ans:eS,a:"paragraph-style-name"},{ens:eS,en:"first-row",ans:eS,a:"paragraph-style-name"},{ens:eS,en:"last-column",ans:eS,a:"paragraph-style-name"},{ens:eS,en:"last-row",ans:eS,a:"paragraph-style-name"},{ens:eS,en:"odd-columns",ans:eS,a:"paragraph-style-name"},{ens:eS,en:"odd-rows",ans:eS,a:"paragraph-style-name"},{ens:eN,en:"notes-configuration",ans:eN,a:"default-style-name"},{ens:eN,en:"alphabetical-index-entry-template",ans:eN,a:"style-name"},{ens:eN,en:"bibliography-entry-template",ans:eN,a:"style-name"},{ens:eN,en:"h",ans:eN,a:"style-name"},{ens:eN,en:"illustration-index-entry-template",ans:eN,a:"style-name"},{ens:eN,en:"index-source-style",ans:eN,a:"style-name"},{ens:eN,en:"object-index-entry-template",ans:eN,a:"style-name"},{ens:eN,en:"p",ans:eN,a:"style-name"},{ens:eN,en:"table-index-entry-template",ans:eN,a:"style-name"},{ens:eN,en:"table-of-content-entry-template",ans:eN,a:"style-name"},{ens:eN,en:"table-index-entry-template",ans:eN,a:"style-name"},{ens:eN,en:"user-index-entry-template",ans:eN,a:"style-name"},{ens:ev,en:"page-layout-properties",ans:ev,a:"register-truth-ref-style-name"}],chart:[{ens:ed,en:"axis",ans:ed,a:"style-name"},{ens:ed,en:"chart",ans:ed,a:"style-name"},{ens:ed,en:"data-label",ans:ed,a:"style-name"},{ens:ed,en:"data-point",ans:ed,a:"style-name"},{ens:ed,en:"equation",ans:ed,a:"style-name"},{ens:ed,en:"error-indicator",ans:ed,a:"style-name"},{ens:ed,en:"floor",ans:ed,a:"style-name"},{ens:ed,en:"footer",ans:ed,a:"style-name"},{ens:ed,en:"grid",ans:ed,a:"style-name"},{ens:ed,en:"legend",ans:ed,a:"style-name"},{ens:ed,en:"mean-value",ans:ed,a:"style-name"},{ens:ed,en:"plot-area",ans:ed,a:"style-name"},{ens:ed,en:"regression-curve",ans:ed,a:"style-name"},{ens:ed,en:"series",ans:ed,a:"style-name"},{ens:ed,en:"stock-gain-marker",ans:ed,a:"style-name"},{ens:ed,en:"stock-loss-marker",ans:ed,a:"style-name"},{ens:ed,en:"stock-range-line",ans:ed,a:"style-name"},{ens:ed,en:"subtitle",ans:ed,a:"style-name"},{ens:ed,en:"title",ans:ed,a:"style-name"},{ens:ed,en:"wall",ans:ed,a:"style-name"}],section:[{ens:eN,en:"alphabetical-index",ans:eN,a:"style-name"},{ens:eN,en:"bibliography",ans:eN,a:"style-name"},{ens:eN,en:"illustration-index",ans:eN,a:"style-name"},{ens:eN,en:"index-title",ans:eN,a:"style-name"},{ens:eN,en:"object-index",ans:eN,a:"style-name"},{ens:eN,en:"section",ans:eN,a:"style-name"},{ens:eN,en:"table-of-content",ans:eN,a:"style-name"},{ens:eN,en:"table-index",ans:eN,a:"style-name"},{ens:eN,en:"user-index",ans:eN,a:"style-name"}],ruby:[{ens:eN,en:"ruby",ans:eN,a:"style-name"}],table:[{ens:ef,en:"query",ans:ef,a:"style-name"},{ens:ef,en:"table-representation",ans:ef,a:"style-name"},{ens:eS,en:"background",ans:eS,a:"style-name"},{ens:eS,en:"table",ans:eS,a:"style-name"}],"table-column":[{ens:ef,en:"column",ans:ef,a:"style-name"},{ens:eS,en:"table-column",ans:eS,a:"style-name"}],"table-row":[{ens:ef,en:"query",ans:ef,a:"default-row-style-name"},{ens:ef,en:"table-representation",ans:ef,a:"default-row-style-name"},{ens:eS,en:"table-row",ans:eS,a:"style-name"}],"table-cell":[{ens:ef,en:"column",ans:ef,a:"default-cell-style-name"},{ens:eS,en:"table-column",ans:eS,a:"default-cell-style-name"},{ens:eS,en:"table-row",ans:eS,a:"default-cell-style-name"},{ens:eS,en:"body",ans:eS,a:"style-name"},{ens:eS,en:"covered-table-cell",ans:eS,a:"style-name"},{ens:eS,en:"even-columns",ans:eS,a:"style-name"},{ens:eS,en:"covered-table-cell",ans:eS,a:"style-name"},{ens:eS,en:"even-columns",ans:eS,a:"style-name"},{ens:eS,en:"even-rows",ans:eS,a:"style-name"},{ens:eS,en:"first-column",ans:eS,a:"style-name"},{ens:eS,en:"first-row",ans:eS,a:"style-name"},{ens:eS,en:"last-column",ans:eS,a:"style-name"},{ens:eS,en:"last-row",ans:eS,a:"style-name"},{ens:eS,en:"odd-columns",ans:eS,a:"style-name"},{ens:eS,en:"odd-rows",ans:eS,a:"style-name"},{ens:eS,en:"table-cell",ans:eS,a:"style-name"}],graphic:[{ens:ep,en:"cube",ans:em,a:"style-name"},{ens:ep,en:"extrude",ans:em,a:"style-name"},{ens:ep,en:"rotate",ans:em,a:"style-name"},{ens:ep,en:"scene",ans:em,a:"style-name"},{ens:ep,en:"sphere",ans:em,a:"style-name"},{ens:em,en:"caption",ans:em,a:"style-name"},{ens:em,en:"circle",ans:em,a:"style-name"},{ens:em,en:"connector",ans:em,a:"style-name"},{ens:em,en:"control",ans:em,a:"style-name"},{ens:em,en:"custom-shape",ans:em,a:"style-name"},{ens:em,en:"ellipse",ans:em,a:"style-name"},{ens:em,en:"frame",ans:em,a:"style-name"},{ens:em,en:"g",ans:em,a:"style-name"},{ens:em,en:"line",ans:em,a:"style-name"},{ens:em,en:"measure",ans:em,a:"style-name"},{ens:em,en:"page-thumbnail",ans:em,a:"style-name"},{ens:em,en:"path",ans:em,a:"style-name"},{ens:em,en:"polygon",ans:em,a:"style-name"},{ens:em,en:"polyline",ans:em,a:"style-name"},{ens:em,en:"rect",ans:em,a:"style-name"},{ens:em,en:"regular-polygon",ans:em,a:"style-name"},{ens:eb,en:"annotation",ans:em,a:"style-name"}],presentation:[{ens:ep,en:"cube",ans:ey,a:"style-name"},{ens:ep,en:"extrude",ans:ey,a:"style-name"},{ens:ep,en:"rotate",ans:ey,a:"style-name"},{ens:ep,en:"scene",ans:ey,a:"style-name"},{ens:ep,en:"sphere",ans:ey,a:"style-name"},{ens:em,en:"caption",ans:ey,a:"style-name"},{ens:em,en:"circle",ans:ey,a:"style-name"},{ens:em,en:"connector",ans:ey,a:"style-name"},{ens:em,en:"control",ans:ey,a:"style-name"},{ens:em,en:"custom-shape",ans:ey,a:"style-name"},{ens:em,en:"ellipse",ans:ey,a:"style-name"},{ens:em,en:"frame",ans:ey,a:"style-name"},{ens:em,en:"g",ans:ey,a:"style-name"},{ens:em,en:"line",ans:ey,a:"style-name"},{ens:em,en:"measure",ans:ey,a:"style-name"},{ens:em,en:"page-thumbnail",ans:ey,a:"style-name"},{ens:em,en:"path",ans:ey,a:"style-name"},{ens:em,en:"polygon",ans:ey,a:"style-name"},{ens:em,en:"polyline",ans:ey,a:"style-name"},{ens:em,en:"rect",ans:ey,a:"style-name"},{ens:em,en:"regular-polygon",ans:ey,a:"style-name"},{ens:eb,en:"annotation",ans:ey,a:"style-name"}],"drawing-page":[{ens:em,en:"page",ans:em,a:"style-name"},{ens:ey,en:"notes",ans:em,a:"style-name"},{ens:ev,en:"handout-master",ans:em,a:"style-name"},{ens:ev,en:"master-page",ans:em,a:"style-name"}],"list-style":[{ens:eN,en:"list",ans:eN,a:"style-name"},{ens:eN,en:"numbered-paragraph",ans:eN,a:"style-name"},{ens:eN,en:"list-item",ans:eN,a:"style-override"},{ens:ev,en:"style",ans:ev,a:"list-style-name"}],data:[{ens:ev,en:"style",ans:ev,a:"data-style-name"},{ens:ev,en:"style",ans:ev,a:"percentage-data-style-name"},{ens:ey,en:"date-time-decl",ans:ev,a:"data-style-name"},{ens:eN,en:"creation-date",ans:ev,a:"data-style-name"},{ens:eN,en:"creation-time",ans:ev,a:"data-style-name"},{ens:eN,en:"database-display",ans:ev,a:"data-style-name"},{ens:eN,en:"date",ans:ev,a:"data-style-name"},{ens:eN,en:"editing-duration",ans:ev,a:"data-style-name"},{ens:eN,en:"expression",ans:ev,a:"data-style-name"},{ens:eN,en:"meta-field",ans:ev,a:"data-style-name"},{ens:eN,en:"modification-date",ans:ev,a:"data-style-name"},{ens:eN,en:"modification-time",ans:ev,a:"data-style-name"},{ens:eN,en:"print-date",ans:ev,a:"data-style-name"},{ens:eN,en:"print-time",ans:ev,a:"data-style-name"},{ens:eN,en:"table-formula",ans:ev,a:"data-style-name"},{ens:eN,en:"time",ans:ev,a:"data-style-name"},{ens:eN,en:"user-defined",ans:ev,a:"data-style-name"},{ens:eN,en:"user-field-get",ans:ev,a:"data-style-name"},{ens:eN,en:"user-field-input",ans:ev,a:"data-style-name"},{ens:eN,en:"variable-get",ans:ev,a:"data-style-name"},{ens:eN,en:"variable-input",ans:ev,a:"data-style-name"},{ens:eN,en:"variable-set",ans:ev,a:"data-style-name"}],"page-layout":[{ens:ey,en:"notes",ans:ev,a:"page-layout-name"},{ens:ev,en:"handout-master",ans:ev,a:"page-layout-name"},{ens:ev,en:"master-page",ans:ev,a:"page-layout-name"}]},ew=xmldom.XPath;this.collectUsedFontFaces=el,this.changeFontFaceNames=eu,this.UsedStyleList=function(_,$){var ee={};this.uses=function(_){var $=_.localName,et=_.getAttributeNS(em,"name")||_.getAttributeNS(ev,"name");return!!(_=ee[_="style"===$?_.getAttributeNS(ev,"family"):_.namespaceURI===eg?"data":$])&&0<_[et]},et(_,ee),$&&es($,ee)},this.getStyleName=function(_,$){var ee,et,en=ec[$.localName];if(en&&(en=en[$.namespaceURI])){for(et=0;et<en.length;et+=1)if(en[et].keyname===_&&(en=en[et],$.hasAttributeNS(en.ns,en.localname))){ee=$.getAttributeNS(en.ns,en.localname);break}}return ee},this.hasDerivedStyles=function(_,$,ee){var et=ee.getAttributeNS(ev,"name");return ee=ee.getAttributeNS(ev,"family"),!!ew.getODFElementsWithXPath(_,'//style:*[@style:parent-style-name="'+et+'"][@style:family="'+ee+'"]',$).length},this.prefixStyleNames=function($,ee,et){var en;if($){for(en=$.firstChild;en;){if(en.nodeType===Node.ELEMENT_NODE){var eo=en,er=ee,ei=eo.getAttributeNS(em,"name"),es=void 0;ei?es=em:(ei=eo.getAttributeNS(ev,"name"))&&(es=ev),es&&eo.setAttributeNS(es,eC[es]+"name",er+ei)}en=en.nextSibling}_($,ee),et&&_(et,ee)}},this.removePrefixFromStyleNames=function(_,ee,et){var en=RegExp("^"+ee);if(_){for(ee=_.firstChild;ee;){if(ee.nodeType===Node.ELEMENT_NODE){var eo=ee,er=en,ei=eo.getAttributeNS(em,"name"),es=void 0;ei?es=em:(ei=eo.getAttributeNS(ev,"name"))&&(es=ev),es&&(ei=ei.replace(er,""),eo.setAttributeNS(es,eC[es]+"name",ei))}ee=ee.nextSibling}$(_,en),et&&$(et,en)}},this.determineStylesForNode=ee,ec=function(){var _,$,ee,et,en,eo,er,ei,es,el={};for(ee in ex)if(ex.hasOwnProperty(ee))for($=(et=ex[ee]).length,_=0;_<$;_+=1)ei=(en=et[_]).en,es=en.ens,el.hasOwnProperty(ei)?eo=el[ei]:el[ei]=eo={},eo.hasOwnProperty(es)?er=eo[es]:eo[es]=er=[],er.push({ns:en.ans,localname:en.a,keyname:ee});return el}()},"function"!=typeof Object.create&&(Object.create=function(_){var $=function(){};return $.prototype=_,new $}),xmldom.LSSerializer=function(){function _(_){var $=_||{},ee=function(_){var $,ee={};for($ in _)_.hasOwnProperty($)&&(ee[_[$]]=$);return ee}(_),et=[$],en=[ee],eo=0;this.push=function(){eo+=1,$=et[eo]=Object.create($),ee=en[eo]=Object.create(ee)},this.pop=function(){et.pop(),en.pop(),$=et[--eo],ee=en[eo]},this.getLocalNamespaceDefinitions=function(){return ee},this.getQName=function(_){var et,en=_.namespaceURI,eo=0;if(!en)return _.localName;if(et=ee[en])return et+":"+_.localName;do{if(et||!_.prefix?(et="ns"+eo,eo+=1):et=_.prefix,$[et]===en)break;if(!$[et]){$[et]=en,ee[en]=et;break}et=null}while(null===et);return et+":"+_.localName}}function $(_){return _.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;")}function ee(_,en){var eo,er="",ei=et.filter?et.filter.acceptNode(en):NodeFilter.FILTER_ACCEPT;if(ei===NodeFilter.FILTER_ACCEPT&&en.nodeType===Node.ELEMENT_NODE){_.push(),eo=_.getQName(en);var es,el,eu,ec,ed,ef=en.attributes,ep="";for(eu=0,es="<"+eo,el=ef.length;eu<el;eu+=1)"http://www.w3.org/2000/xmlns/"!==(ec=ef.item(eu)).namespaceURI&&(ed=et.filter?et.filter.acceptNode(ec):NodeFilter.FILTER_ACCEPT)===NodeFilter.FILTER_ACCEPT&&(ep+=" "+(ed=_.getQName(ec))+'="'+(ec="string"==typeof ec.value?$(ec.value):ec.value)+'"');for(eu in el=_.getLocalNamespaceDefinitions())el.hasOwnProperty(eu)&&((ef=el[eu])?"xmlns"!==ef&&(es+=" xmlns:"+el[eu]+'="'+eu+'"'):es+=' xmlns="'+eu+'"');er+=es+(ep+">")}if(ei===NodeFilter.FILTER_ACCEPT||ei===NodeFilter.FILTER_SKIP){for(ei=en.firstChild;ei;)er+=ee(_,ei),ei=ei.nextSibling;en.nodeValue&&(er+=$(en.nodeValue))}return eo&&(er+="</"+eo+">",_.pop()),er}var et=this;this.filter=null,this.writeToString=function($,et){return $?ee(new _(et),$):""}},function(){function _(_){var $,ee=ei.length;for($=0;$<ee;$+=1)if("urn:oasis:names:tc:opendocument:xmlns:office:1.0"===_.namespaceURI&&_.localName===ei[$])return $;return -1}function $(_,$){var ee=new en.UsedStyleList(_,$),et=new odf.OdfNodeFilter;this.acceptNode=function(_){var en=et.acceptNode(_);return en===NodeFilter.FILTER_ACCEPT&&_.parentNode===$&&_.nodeType===Node.ELEMENT_NODE&&(en=ee.uses(_)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT),en}}function ee(_,ee){var et=new $(_,ee);this.acceptNode=function(_){var $=et.acceptNode(_);return $===NodeFilter.FILTER_ACCEPT&&_.parentNode&&_.parentNode.namespaceURI===odf.Namespaces.textns&&("s"===_.parentNode.localName||"tab"===_.parentNode.localName)&&($=NodeFilter.FILTER_REJECT),$}}function et($,ee){if(ee){var et,en=_(ee),eo=$.firstChild;if(-1!==en){for(;eo&&(-1===(et=_(eo))||!(et>en));)eo=eo.nextSibling;$.insertBefore(ee,eo)}}}var en=new odf.StyleInfo,eo=core.DomUtils,er=odf.Namespaces.stylens,ei="meta settings scripts font-face-decls styles automatic-styles master-styles body".split(" "),es=Date.now()+"_webodf_",el=new core.Base64;odf.ODFElement=function(){},odf.ODFDocumentElement=function(){},odf.ODFDocumentElement.prototype=new odf.ODFElement,odf.ODFDocumentElement.prototype.constructor=odf.ODFDocumentElement,odf.ODFDocumentElement.prototype.fontFaceDecls=null,odf.ODFDocumentElement.prototype.manifest=null,odf.ODFDocumentElement.prototype.settings=null,odf.ODFDocumentElement.namespaceURI="urn:oasis:names:tc:opendocument:xmlns:office:1.0",odf.ODFDocumentElement.localName="document",odf.AnnotationElement=function(){},odf.OdfPart=function(_,$,ee,et){var en=this;this.size=0,this.type=null,this.name=_,this.container=ee,this.url=null,this.mimetype=$,this.onstatereadychange=this.document=null,this.EMPTY=0,this.LOADING=1,this.DONE=2,this.state=this.EMPTY,this.data="",this.load=function(){null!==et&&(this.mimetype=$,et.loadAsDataURL(_,$,function(_,$){_&&runtime.log(_),en.url=$,en.onchange&&en.onchange(en),en.onstatereadychange&&en.onstatereadychange(en)}))}},odf.OdfPart.prototype.load=function(){},odf.OdfPart.prototype.getUrl=function(){return this.data?"data:;base64,"+el.toBase64(this.data):null},odf.OdfContainer=function _(ei,eu){function ec(_){for(var $,ee=_.firstChild;ee;)$=ee.nextSibling,ee.nodeType===Node.ELEMENT_NODE?ec(ee):ee.nodeType===Node.PROCESSING_INSTRUCTION_NODE&&_.removeChild(ee),ee=$}function ed(_){var $,ee,et={},en=_.ownerDocument.createNodeIterator(_,NodeFilter.SHOW_ELEMENT,null,!1);for(_=en.nextNode();_;)"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===_.namespaceURI&&("annotation"===_.localName?($=_.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","name"))&&(et.hasOwnProperty($)?runtime.log("Warning: annotation name used more than once with <office:annotation/>: '"+$+"'"):et[$]=_):"annotation-end"===_.localName&&(($=_.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","name"))?et.hasOwnProperty($)?(ee=et[$]).annotationEndElement?runtime.log("Warning: annotation name used more than once with <office:annotation-end/>: '"+$+"'"):ee.annotationEndElement=_:runtime.log("Warning: annotation end without an annotation start, name: '"+$+"'"):runtime.log("Warning: annotation end without a name found"))),_=en.nextNode()}function ef(_,$){for(var ee=_&&_.firstChild;ee;)ee.nodeType===Node.ELEMENT_NODE&&ee.setAttributeNS("urn:webodf:names:scope","scope",$),ee=ee.nextSibling}function ep(_,$){for(var ee=eW.rootElement.meta,ee=ee&&ee.firstChild;ee&&(ee.namespaceURI!==_||ee.localName!==$);)ee=ee.nextSibling;for(ee=ee&&ee.firstChild;ee&&ee.nodeType!==Node.TEXT_NODE;)ee=ee.nextSibling;return ee?ee.data:null}function em(_){var $={};for(_=_.firstChild;_;)_.nodeType===Node.ELEMENT_NODE&&_.namespaceURI===er&&"font-face"===_.localName&&($[_.getAttributeNS(er,"name")]=_),_=_.nextSibling;return $}function eh(_,$){var ee,et,en,eo=null;if(_)for(ee=(eo=_.cloneNode(!0)).firstElementChild;ee;)et=ee.nextElementSibling,(en=ee.getAttributeNS("urn:webodf:names:scope","scope"))&&en!==$&&eo.removeChild(ee),ee=et;return eo}function eg(_,$){var ee,et,eo=null,ei={};if(_)for($.forEach(function(_){en.collectUsedFontFaces(ei,_)}),ee=(eo=_.cloneNode(!0)).firstElementChild;ee;)et=ee.nextElementSibling,ei[ee.getAttributeNS(er,"name")]||eo.removeChild(ee),ee=et;return eo}function eb(_){var $,ee=eW.rootElement.ownerDocument;if(_){ec(_.documentElement);try{$=ee.importNode(_.documentElement,!0)}catch(_){}}return $}function ey(_){eW.state=_,eW.onchange&&eW.onchange(eW),eW.onstatereadychange&&eW.onstatereadychange(eW)}function ev(_){eH=null,eW.rootElement=_,_.fontFaceDecls=eo.getDirectChild(_,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","font-face-decls"),_.styles=eo.getDirectChild(_,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","styles"),_.automaticStyles=eo.getDirectChild(_,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles"),_.masterStyles=eo.getDirectChild(_,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","master-styles"),_.body=eo.getDirectChild(_,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","body"),_.meta=eo.getDirectChild(_,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","meta"),_.settings=eo.getDirectChild(_,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","settings"),_.scripts=eo.getDirectChild(_,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","scripts"),ed(_)}function eS($){var ee,er=eb($),ei=eW.rootElement;er&&"document-styles"===er.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===er.namespaceURI?(ei.fontFaceDecls=eo.getDirectChild(er,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","font-face-decls"),et(ei,ei.fontFaceDecls),ee=eo.getDirectChild(er,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","styles"),ei.styles=ee||$.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","styles"),et(ei,ei.styles),ee=eo.getDirectChild(er,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles"),ei.automaticStyles=ee||$.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles"),ef(ei.automaticStyles,"document-styles"),et(ei,ei.automaticStyles),er=eo.getDirectChild(er,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","master-styles"),ei.masterStyles=er||$.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","master-styles"),et(ei,ei.masterStyles),en.prefixStyleNames(ei.automaticStyles,es,ei.masterStyles)):ey(_.INVALID)}function eN($){if(($=eb($))&&"document-content"===$.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===$.namespaceURI){if(ee=eW.rootElement,es=eo.getDirectChild($,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","font-face-decls"),ee.fontFaceDecls&&es){el=ee.fontFaceDecls;var ee,ei,es,el,eu,ec,ed,ep,eh={};for(ei=em(el),ep=em(es),es=es.firstElementChild;es;){if(eu=es.nextElementSibling,es.namespaceURI===er&&"font-face"===es.localName){if(ec=es.getAttributeNS(er,"name"),ei.hasOwnProperty(ec)){if(!es.isEqualNode(ei[ec])){ed=ec;for(var eg=ei,ev=ep,eS=0,eN=void 0,eN=ed=ed.replace(/\d+$/,"");eg.hasOwnProperty(eN)||ev.hasOwnProperty(eN);)eS+=1,eN=ed+eS;ed=eN,es.setAttributeNS(er,"style:name",ed),el.appendChild(es),ei[ed]=es,delete ep[ec],eh[ec]=ed}}else el.appendChild(es),ei[ec]=es,delete ep[ec]}es=eu}el=eh}else es&&(ee.fontFaceDecls=es,et(ee,es));if(ef(ei=eo.getDirectChild($,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles"),"document-content"),el&&en.changeFontFaceNames(ei,el),ee.automaticStyles&&ei)for(el=ei.firstChild;el;)ee.automaticStyles.appendChild(el),el=ei.firstChild;else ei&&(ee.automaticStyles=ei,et(ee,ei));if(null===($=eo.getDirectChild($,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","body")))throw"<office:body/> tag is mising.";ee.body=$,et(ee,ee.body)}else ey(_.INVALID)}function eC(_){var $;(_=eb(_))&&"document-meta"===_.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===_.namespaceURI&&(($=eW.rootElement).meta=eo.getDirectChild(_,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","meta"),et($,$.meta))}function ex(_){var $;(_=eb(_))&&"document-settings"===_.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===_.namespaceURI&&(($=eW.rootElement).settings=eo.getDirectChild(_,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","settings"),et($,$.settings))}function ew(_){var $;if((_=eb(_))&&"manifest"===_.localName&&"urn:oasis:names:tc:opendocument:xmlns:manifest:1.0"===_.namespaceURI)for(($=eW.rootElement).manifest=_,_=$.manifest.firstElementChild;_;)"file-entry"===_.localName&&"urn:oasis:names:tc:opendocument:xmlns:manifest:1.0"===_.namespaceURI&&(ej[_.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","full-path")]=_.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","media-type")),_=_.nextElementSibling}function eE(_,$,ee){var et;for(et=0,_=eo.getElementsByTagName(_,$);et<_.length;et+=1)$=_[et],ee.hasOwnProperty($.namespaceURI)||$.parentNode.removeChild($)}function eT(_){eE(_,"script",{"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:office:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:table:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:text:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0":!0}),eE(_,"style",{"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:style:1.0":!0})}function eO(_){var $,ee,et,en=_.firstElementChild,eo=[],er=_.attributes,ei=er.length;for($=0;$<ei;$+=1)ee=(et=er.item($)).localName.substr(0,2).toLowerCase(),null===et.namespaceURI&&"on"===ee&&eo.push(et);for($=0,ei=eo.length;$<ei;$+=1)_.removeAttributeNode(eo[$]);for(;en;)eO(en),en=en.nextElementSibling}function eA($){var ee=$.shift();ee?ez.loadAsDOM(ee.path,function(et,en){en&&(eT(en),eO(en.documentElement)),ee.handler(en),eW.state===_.INVALID?et?runtime.log("ERROR: Unable to load "+ee.path+" - "+et):runtime.log("ERROR: Unable to load "+ee.path):(et&&runtime.log("DEBUG: Unable to load "+ee.path+" - "+et),eA($))}):(ed(eW.rootElement),ey(_.DONE))}function eR(_){var $="";return odf.Namespaces.forEachPrefix(function(_,ee){$+=" xmlns:"+_+'="'+ee+'"'}),'<?xml version="1.0" encoding="UTF-8"?><office:'+_+" "+$+' office:version="1.2">'}function eP(){var _=new xmldom.LSSerializer,$=eR("document-meta");return _.filter=new odf.OdfNodeFilter,($+=_.writeToString(eW.rootElement.meta,odf.Namespaces.namespaceMap))+"</office:document-meta>"}function eD(_,$){var ee=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","manifest:file-entry");return ee.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","manifest:full-path",_),ee.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","manifest:media-type",$),ee}function e_(){var _,$=runtime.parseXML('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2"></manifest:manifest>'),ee=$.documentElement,et=new xmldom.LSSerializer;for(_ in ej)ej.hasOwnProperty(_)&&ee.appendChild(eD(_,ej[_]));return et.filter=new odf.OdfNodeFilter,'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n'+et.writeToString($,odf.Namespaces.namespaceMap)}function ek(){var _,ee,et,eo=odf.Namespaces.namespaceMap,er=new xmldom.LSSerializer,ei=eR("document-styles");return ee=eh(eW.rootElement.automaticStyles,"document-styles"),et=eW.rootElement.masterStyles.cloneNode(!0),_=eg(eW.rootElement.fontFaceDecls,[et,eW.rootElement.styles,ee]),en.removePrefixFromStyleNames(ee,es,et),er.filter=new $(et,ee),(ei+=er.writeToString(_,eo)+er.writeToString(eW.rootElement.styles,eo)+er.writeToString(ee,eo)+er.writeToString(et,eo))+"</office:document-styles>"}function eI(){var _,$,et=odf.Namespaces.namespaceMap,en=new xmldom.LSSerializer,eo=eR("document-content");return $=eh(eW.rootElement.automaticStyles,"document-content"),_=eg(eW.rootElement.fontFaceDecls,[$]),en.filter=new ee(eW.rootElement.body,$),(eo+=en.writeToString(_,et)+en.writeToString($,et)+en.writeToString(eW.rootElement.body,et))+"</office:document-content>"}function eF($,ee){runtime.loadXML($,function($,et){if($)ee($);else if(et){eT(et),eO(et.documentElement);var en=eb(et);en&&"document"===en.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===en.namespaceURI?(ev(en),ey(_.DONE)):ey(_.INVALID)}else ee("No DOM was loaded.")})}function eM(_,$){var ee,en=(ee=eW.rootElement).meta;en||(ee.meta=en=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","meta"),et(ee,en)),ee=en,_&&eo.mapKeyValObjOntoNode(ee,_,odf.Namespaces.lookupNamespaceURI),$&&eo.removeKeyElementsFromNode(ee,$,odf.Namespaces.lookupNamespaceURI)}function eB($,ee){function et(_,$){var ee;$||($=_),ee=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0",$),ei[_]=ee,ei.appendChild(ee)}var en=new core.Zip("",null),eo="application/vnd.oasis.opendocument."+$+(!0===ee?"-template":""),er=runtime.byteArrayFromString(eo,"utf8"),ei=eW.rootElement,es=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0",$);return en.save("mimetype",er,!1,new Date),et("meta"),et("settings"),et("scripts"),et("fontFaceDecls","font-face-decls"),et("styles"),et("automaticStyles","automatic-styles"),et("masterStyles","master-styles"),et("body"),ei.body.appendChild(es),ej["/"]=eo,ej["settings.xml"]="text/xml",ej["meta.xml"]="text/xml",ej["styles.xml"]="text/xml",ej["content.xml"]="text/xml",ey(_.DONE),en}function eU(){var _,$=new Date,ee="";eW.rootElement.settings&&eW.rootElement.settings.firstElementChild&&(_=new xmldom.LSSerializer,ee=eR("document-settings"),_.filter=new odf.OdfNodeFilter,ee+=_.writeToString(eW.rootElement.settings,odf.Namespaces.namespaceMap)+"</office:document-settings>"),(_=ee)?(_=runtime.byteArrayFromString(_,"utf8"),ez.save("settings.xml",_,!0,$)):ez.remove("settings.xml"),ee=runtime.getWindow(),_="WebODF/"+webodf.Version,ee&&(_=_+" "+ee.navigator.userAgent),eM({"meta:generator":_},null),_=runtime.byteArrayFromString(eP(),"utf8"),ez.save("meta.xml",_,!0,$),_=runtime.byteArrayFromString(ek(),"utf8"),ez.save("styles.xml",_,!0,$),_=runtime.byteArrayFromString(eI(),"utf8"),ez.save("content.xml",_,!0,$),_=runtime.byteArrayFromString(e_(),"utf8"),ez.save("META-INF/manifest.xml",_,!0,$)}function eL(_,$){eU(),ez.writeAs(_,function(_){$(_)})}var ez,eH,eW=this,ej={},eX="";this.onstatereadychange=eu,this.state=this.onchange=null,this.getMetadata=ep,this.setRootElement=ev,this.getContentElement=function(){var _;if(eH||(_=eW.rootElement.body,eH=eo.getDirectChild(_,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","text")||eo.getDirectChild(_,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","presentation")||eo.getDirectChild(_,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","spreadsheet")),!eH)throw"Could not find content element in <office:body/>.";return eH},this.getDocumentType=function(){var _=eW.getContentElement();return _&&_.localName},this.isTemplate=function(){return"-template"===ej["/"].substr(-9)},this.setIsTemplate=function(_){var $=ej["/"];_!==("-template"===$.substr(-9))&&($=_?$+"-template":$.substr(0,$.length-9),ej["/"]=$,_=runtime.byteArrayFromString($,"utf8"),ez.save("mimetype",_,!1,new Date))},this.getPart=function(_){return new odf.OdfPart(_,ej[_],eW,ez)},this.getPartData=function(_,$){ez.load(_,$)},this.setMetadata=eM,this.incrementEditingCycles=function(){var _=ep(odf.Namespaces.metans,"editing-cycles"),_=_?parseInt(_,10):0;return isNaN(_)&&(_=0),eM({"meta:editing-cycles":_+1},null),_+1},this.createByteArray=function(_,$){eU(),ez.createByteArray(_,$)},this.saveAs=eL,this.save=function(_){eL(eX,_)},this.getUrl=function(){return eX},this.setBlob=function(_,$,ee){ee=el.convertBase64ToByteArray(ee),ez.save(_,ee,!1,new Date),ej.hasOwnProperty(_)&&runtime.log(_+" has been overwritten."),ej[_]=$},this.removeBlob=function(_){var $=ez.remove(_);runtime.assert($,"file is not found: "+_),delete ej[_]},this.state=_.LOADING,this.rootElement=function(_){var $,ee=document.createElementNS(_.namespaceURI,_.localName);for($ in _=new _.Type)_.hasOwnProperty($)&&(ee[$]=_[$]);return ee}({Type:odf.ODFDocumentElement,namespaceURI:odf.ODFDocumentElement.namespaceURI,localName:odf.ODFDocumentElement.localName}),ei===odf.OdfContainer.DocumentType.TEXT?ez=eB("text"):ei===odf.OdfContainer.DocumentType.TEXT_TEMPLATE?ez=eB("text",!0):ei===odf.OdfContainer.DocumentType.PRESENTATION?ez=eB("presentation"):ei===odf.OdfContainer.DocumentType.PRESENTATION_TEMPLATE?ez=eB("presentation",!0):ei===odf.OdfContainer.DocumentType.SPREADSHEET?ez=eB("spreadsheet"):ei===odf.OdfContainer.DocumentType.SPREADSHEET_TEMPLATE?ez=eB("spreadsheet",!0):(eX=ei,ez=new core.Zip(eX,function($,ee){ez=ee,$?eF(eX,function(ee){$&&(ez.error=$+"\n"+ee,ey(_.INVALID))}):eA([{path:"styles.xml",handler:eS},{path:"content.xml",handler:eN},{path:"meta.xml",handler:eC},{path:"settings.xml",handler:ex},{path:"META-INF/manifest.xml",handler:ew}])}))},odf.OdfContainer.EMPTY=0,odf.OdfContainer.LOADING=1,odf.OdfContainer.DONE=2,odf.OdfContainer.INVALID=3,odf.OdfContainer.SAVING=4,odf.OdfContainer.MODIFIED=5,odf.OdfContainer.getContainer=function(_){return new odf.OdfContainer(_,null)}}(),odf.OdfContainer.DocumentType={TEXT:1,TEXT_TEMPLATE:2,PRESENTATION:3,PRESENTATION_TEMPLATE:4,SPREADSHEET:5,SPREADSHEET_TEMPLATE:6},gui.AnnotatableCanvas=function(){},gui.AnnotatableCanvas.prototype.refreshSize=function(){},gui.AnnotatableCanvas.prototype.getZoomLevel=function(){},gui.AnnotatableCanvas.prototype.getSizer=function(){},gui.AnnotationViewManager=function(_,$,ee,et){function en(_){var $=_.annotationEndElement,ee=eu.createRange(),et=_.getAttributeNS(odf.Namespaces.officens,"name");$&&(ee.setStart(_,_.childNodes.length),ee.setEnd($,0),(_=ec.getTextNodes(ee,!1)).forEach(function(_){var $;e:{for($=_.parentNode;$.namespaceURI!==odf.Namespaces.officens||"body"!==$.localName;){if("http://www.w3.org/1999/xhtml"===$.namespaceURI&&"webodf-annotationHighlight"===$.className&&$.getAttribute("annotation")===et){$=!0;break e}$=$.parentNode}$=!1}$||(($=eu.createElement("span")).className="webodf-annotationHighlight",$.setAttribute("annotation",et),_.parentNode.replaceChild($,_),$.appendChild(_))})),ee.detach()}function eo($){var et=_.getSizer();$?(ee.style.display="inline-block",et.style.paddingRight=ed.getComputedStyle(ee).width):(ee.style.display="none",et.style.paddingRight=0),_.refreshSize()}function er(){el.sort(function(_,$){return 0!=(_.compareDocumentPosition($)&Node.DOCUMENT_POSITION_FOLLOWING)?-1:1})}function ei(){var $;for($=0;$<el.length;$+=1){var et=el[$],en=et.parentNode,eo=en.nextElementSibling,er=eo.nextElementSibling,ei=en.parentNode,es=el[el.indexOf(et)-1],eu=void 0,et=_.getZoomLevel();en.style.left=(ee.getBoundingClientRect().left-ei.getBoundingClientRect().left)/et+"px",en.style.width=ee.getBoundingClientRect().width/et+"px",eo.style.width=parseFloat(en.style.left)-30+"px",es?(eu=es.parentNode.getBoundingClientRect(),20>=(ei.getBoundingClientRect().top-eu.bottom)/et?en.style.top=Math.abs(ei.getBoundingClientRect().top-eu.bottom)/et+20+"px":en.style.top="0px"):en.style.top="0px",er.style.left=eo.getBoundingClientRect().width/et+"px";var eo=er.style,ei=er.getBoundingClientRect().left/et,es=er.getBoundingClientRect().top/et,eu=en.getBoundingClientRect().left/et,ec=en.getBoundingClientRect().top/et,ed=eu-ei,ed=ed*ed,ef=ec-es,ef=ef*ef,ei=Math.sqrt(ed+ef);eo.width=ei+"px",es=Math.asin((en.getBoundingClientRect().top-er.getBoundingClientRect().top)/(et*parseFloat(er.style.width))),er.style.transform="rotate("+es+"rad)",er.style.MozTransform="rotate("+es+"rad)",er.style.WebkitTransform="rotate("+es+"rad)",er.style.msTransform="rotate("+es+"rad)"}}function es(_){var $=el.indexOf(_),ee=_.parentNode.parentNode;"div"===ee.localName&&(ee.parentNode.insertBefore(_,ee),ee.parentNode.removeChild(ee)),_=_.getAttributeNS(odf.Namespaces.officens,"name"),_=eu.querySelectorAll('span.webodf-annotationHighlight[annotation="'+_+'"]');for(var et,ee=0;ee<_.length;ee+=1){for(et=_.item(ee);et.firstChild;)et.parentNode.insertBefore(et.firstChild,et);et.parentNode.removeChild(et)}-1!==$&&el.splice($,1),0===el.length&&eo(!1)}var el=[],eu=$.ownerDocument,ec=odf.OdfUtils,ed=runtime.getWindow();runtime.assert(!!ed,"Expected to be run in an environment which has a global window, like a browser."),this.rerenderAnnotations=ei,this.rehighlightAnnotations=function(){el.forEach(function(_){en(_)})},this.getMinimumHeightForAnnotationPane=function(){return"none"!==ee.style.display&&0<el.length?(el[el.length-1].parentNode.getBoundingClientRect().bottom-ee.getBoundingClientRect().top)/_.getZoomLevel()+"px":null},this.addAnnotations=function(_){0!==_.length&&(eo(!0),_.forEach(function(_){el.push(_);var $,ee=eu.createElement("div"),eo=eu.createElement("div"),er=eu.createElement("div"),ei=eu.createElement("div");ee.className="annotationWrapper",ee.setAttribute("creator",ec.getAnnotationCreator(_)),_.parentNode.insertBefore(ee,_),eo.className="annotationNote",eo.appendChild(_),et&&(($=eu.createElement("div")).className="annotationRemoveButton",eo.appendChild($)),er.className="annotationConnector horizontal",ei.className="annotationConnector angular",ee.appendChild(eo),ee.appendChild(er),ee.appendChild(ei),_.annotationEndElement&&en(_)}),er(),ei())},this.forgetAnnotation=es,this.forgetAnnotations=function(){for(;el.length;)es(el[0])}},gui.Viewport=function(){},gui.Viewport.prototype.scrollIntoView=function(_,$){},gui.SingleScrollViewport=function(_){this.scrollIntoView=function($,ee){er=_.offsetHeight-_.clientHeight,eo=_.offsetWidth-_.clientWidth;var et,en,eo,er,ei=_.getBoundingClientRect();$&&ei&&(et=ei.left+5,en=ei.top+5,eo=ei.right-(eo+5),er=ei.bottom-(er+5),ee||$.top<en?_.scrollTop-=en-$.top:($.top>er||$.bottom>er)&&(_.scrollTop=$.bottom-$.top<=er-en?_.scrollTop+($.bottom-er):_.scrollTop+($.top-en)),$.left<et?_.scrollLeft-=et-$.left:$.right>eo&&(_.scrollLeft=$.right-$.left<=eo-et?_.scrollLeft+($.right-eo):_.scrollLeft-(et-$.left)))}},function(){function _($,ee,en,eo,er){var ei,es,el=0;for(es in $)if($.hasOwnProperty(es)){if(el===en){ei=es;break}el+=1}ei?ee.getPartData($[ei].href,function(es,el){if(es)runtime.log(es);else if(el){var eu="@font-face { font-family: "+($[ei].family||ei)+"; src: url(data:application/x-font-ttf;charset=binary;base64,"+et.convertUTF8ArrayToBase64(el)+') format("truetype"); }';try{eo.insertRule(eu,eo.cssRules.length)}catch(_){runtime.log("Problem inserting rule in CSS: "+runtime.toJson(_)+"\nRule: "+eu)}}else runtime.log("missing font data for "+$[ei].href);_($,ee,en+1,eo,er)}):er&&er()}var $=xmldom.XPath,ee=odf.OdfUtils,et=new core.Base64;odf.FontLoader=function(){this.loadFonts=function(et,en){for(var eo=et.rootElement.fontFaceDecls;en.cssRules.length;)en.deleteRule(en.cssRules.length-1);if(eo){var er,ei,es,el,eu={};if(eo)for(eo=$.getODFElementsWithXPath(eo,"style:font-face[svg:font-face-src]",odf.Namespaces.lookupNamespaceURI),er=0;er<eo.length;er+=1)es=(ei=eo[er]).getAttributeNS(odf.Namespaces.stylens,"name"),el=ee.getNormalizedFontFamilyName(ei.getAttributeNS(odf.Namespaces.svgns,"font-family")),0<(ei=$.getODFElementsWithXPath(ei,"svg:font-face-src/svg:font-face-uri",odf.Namespaces.lookupNamespaceURI)).length&&(ei=ei[0].getAttributeNS(odf.Namespaces.xlinkns,"href"),eu[es]={href:ei,family:el});_(eu,et,0,en)}}}}(),odf.Formatting=function(){function _(_){return(_=eN[_])?ev.mergeObjects({},_):{}}function $(){for(var _,$,ee=ec.rootElement.fontFaceDecls,et={},ee=ee&&ee.firstElementChild;ee;)(_=ee.getAttributeNS(ep,"name"))&&(($=ee.getAttributeNS(ef,"font-family"))||0<ee.getElementsByTagNameNS(ef,"font-face-uri").length)&&(et[_]=$),ee=ee.nextElementSibling;return et}function ee(_){for(var $=ec.rootElement.styles.firstElementChild;$;){if($.namespaceURI===ep&&"default-style"===$.localName&&$.getAttributeNS(ep,"family")===_)return $;$=$.nextElementSibling}return null}function et(_,$,ee){var et,en,eo;for(eo=0,ee=ee||[ec.rootElement.automaticStyles,ec.rootElement.styles];eo<ee.length;eo+=1)for(et=(et=ee[eo]).firstElementChild;et;){if(en=et.getAttributeNS(ep,"name"),et.namespaceURI===ep&&"style"===et.localName&&et.getAttributeNS(ep,"family")===$&&en===_||"list-style"===$&&et.namespaceURI===em&&"list-style"===et.localName&&en===_||"data"===$&&et.namespaceURI===eh&&en===_)return et;et=et.nextElementSibling}return null}function en(_){for(var $,ee,et,en,eo={},er=_.firstElementChild;er;){if(er.namespaceURI===ep)for(et=eo[er.nodeName]={},ee=er.attributes,$=0;$<ee.length;$+=1)et[(en=ee.item($)).name]=en.value;er=er.nextElementSibling}for($=0,ee=_.attributes;$<ee.length;$+=1)eo[(en=ee.item($)).name]=en.value;return eo}function eo($,eo){for(var er,ei=ec.rootElement.styles,es={},el=$.getAttributeNS(ep,"family"),eu=$;eu;)er=en(eu),es=ev.mergeObjects(er,es),eu=(er=eu.getAttributeNS(ep,"parent-style-name"))?et(er,el,[ei]):null;return(eu=ee(el))&&(er=en(eu),es=ev.mergeObjects(er,es)),!1!==eo&&(er=_(el),es=ev.mergeObjects(er,es)),es}function er(_,$){function ee(_){Object.keys(_).forEach(function($){Object.keys(_[$]).forEach(function(_){er+="|"+$+":"+_+"|"})})}for(var et,en=_.nodeType===Node.TEXT_NODE?_.parentNode:_,eo=[],er="",ei=!1;en&&!eb.isInlineRoot(en)&&en.parentNode!==ec.rootElement;)!ei&&eb.isGroupingElement(en)&&(ei=!0),(et=ed.determineStylesForNode(en))&&eo.push(et),en=en.parentNode;return ei&&(eo.forEach(ee),$&&($[er]=eo)),ei?eo:void 0}function ei(_){var $={orderedStyles:[],styleProperties:{}};return _.forEach(function(_){Object.keys(_).forEach(function(ee){var en,er=Object.keys(_[ee])[0],ei={name:er,family:ee,displayName:void 0,isCommonStyle:!1};(en=et(er,ee))?(ee=eo(en),$.styleProperties=ev.mergeObjects(ee,$.styleProperties),ei.displayName=en.getAttributeNS(ep,"display-name")||void 0,ei.isCommonStyle=en.parentNode===ec.rootElement.styles):runtime.log("No style element found for '"+er+"' of family '"+ee+"'"),$.orderedStyles.push(ei)})}),$}function es(_,$){var ee={},et=[];return $||($={}),_.forEach(function(_){er(_,ee)}),Object.keys(ee).forEach(function(_){$[_]||($[_]=ei(ee[_])),et.push($[_])}),et}function el(_){for(var $=ec.rootElement.masterStyles.firstElementChild;$&&($.namespaceURI!==ep||"master-page"!==$.localName||$.getAttributeNS(ep,"name")!==_);)$=$.nextElementSibling;return $}function eu(_,$){var ee;return _&&(ee=eS.convertMeasure(_,"px")),void 0===ee&&$&&(ee=eS.convertMeasure($,"px")),ee}var ec,ed=new odf.StyleInfo,ef=odf.Namespaces.svgns,ep=odf.Namespaces.stylens,em=odf.Namespaces.textns,eh=odf.Namespaces.numberns,eg=odf.Namespaces.fons,eb=odf.OdfUtils,ey=core.DomUtils,ev=new core.Utils,eS=new core.CSSUnits,eN={paragraph:{"style:paragraph-properties":{"fo:text-align":"left"}}};this.getSystemDefaultStyleAttributes=_,this.setOdfContainer=function(_){ec=_},this.getFontMap=$,this.getAvailableParagraphStyles=function(){for(var _,$,ee=ec.rootElement.styles,et=[],ee=ee&&ee.firstElementChild;ee;)"style"===ee.localName&&ee.namespaceURI===ep&&"paragraph"===(_=ee.getAttributeNS(ep,"family"))&&(_=ee.getAttributeNS(ep,"name"),$=ee.getAttributeNS(ep,"display-name")||_,_&&$&&et.push({name:_,displayName:$})),ee=ee.nextElementSibling;return et},this.isStyleUsed=function(_){var $,ee=ec.rootElement;return $=ed.hasDerivedStyles(ee,odf.Namespaces.lookupNamespaceURI,_),_=new ed.UsedStyleList(ee.styles).uses(_)||new ed.UsedStyleList(ee.automaticStyles).uses(_)||new ed.UsedStyleList(ee.body).uses(_),$||_},this.getDefaultStyleElement=ee,this.getStyleElement=et,this.getStyleAttributes=en,this.getInheritedStyleAttributes=eo,this.getFirstCommonParentStyleNameOrSelf=function(_){var $,ee=ec.rootElement.styles;return($=et(_,"paragraph",[ec.rootElement.automaticStyles]))&&!(_=$.getAttributeNS(ep,"parent-style-name"))?null:($=et(_,"paragraph",[ee]))?_:null},this.hasParagraphStyle=function(_){return!!et(_,"paragraph")},this.getAppliedStyles=es,this.getAppliedStylesForElement=function(_,$){return es([_],$)[0]},this.updateStyle=function(_,ee){var et,en;ey.mapObjOntoNode(_,ee,odf.Namespaces.lookupNamespaceURI),(et=(et=ee["style:text-properties"])&&et["style:font-name"])&&!$().hasOwnProperty(et)&&((en=_.ownerDocument.createElementNS(ep,"style:font-face")).setAttributeNS(ep,"style:name",et),en.setAttributeNS(ef,"svg:font-family",et),ec.rootElement.fontFaceDecls.appendChild(en))},this.createDerivedStyleObject=function(_,$,ee){var eo=et(_,$);return runtime.assert(!!eo,"No style element found for '"+_+"' of family '"+$+"'"),(_=eo.parentNode===ec.rootElement.styles?{"style:parent-style-name":_}:en(eo))["style:family"]=$,ev.mergeObjects(_,ee),_},this.getDefaultTabStopDistance=function(){for(var _,$=ee("paragraph"),$=$&&$.firstElementChild;$;)$.namespaceURI===ep&&"paragraph-properties"===$.localName&&(_=$.getAttributeNS(ep,"tab-stop-distance")),$=$.nextElementSibling;return _||(_="1.25cm"),eb.parseNonNegativeLength(_)},this.getMasterPageElement=el,this.getContentSize=function(_,$){var ee,en,eo,er,ei,es,ed,ef,em,eh;e:{if(en=et(_,$),runtime.assert("paragraph"===$||"table"===$,"styleFamily must be either paragraph or table"),en&&((en=en.getAttributeNS(ep,"master-page-name"))&&((ee=el(en))||runtime.log("WARN: No master page definition found for "+en)),ee||(ee=el("Standard")),ee||(ee=ec.rootElement.masterStyles.getElementsByTagNameNS(ep,"master-page")[0])||runtime.log("WARN: Document has no master pages defined"),ee)){for(en=ee.getAttributeNS(ep,"page-layout-name"),eo=ec.rootElement.automaticStyles.getElementsByTagNameNS(ep,"page-layout"),er=0;er<eo.length;er+=1)if((ee=eo.item(er)).getAttributeNS(ep,"name")===en)break e}ee=null}return ee||(ee=ey.getDirectChild(ec.rootElement.styles,ep,"default-page-layout")),(ee=ey.getDirectChild(ee,ep,"page-layout-properties"))?("landscape"===ee.getAttributeNS(ep,"print-orientation")?(en="29.7cm",eo="21.001cm"):(en="21.001cm",eo="29.7cm"),en=eu(ee.getAttributeNS(eg,"page-width"),en),eo=eu(ee.getAttributeNS(eg,"page-height"),eo),void 0===(er=eu(ee.getAttributeNS(eg,"margin")))?(er=eu(ee.getAttributeNS(eg,"margin-left"),"2cm"),ei=eu(ee.getAttributeNS(eg,"margin-right"),"2cm"),es=eu(ee.getAttributeNS(eg,"margin-top"),"2cm"),ed=eu(ee.getAttributeNS(eg,"margin-bottom"),"2cm")):er=ei=es=ed=er,void 0===(ef=eu(ee.getAttributeNS(eg,"padding")))?(ef=eu(ee.getAttributeNS(eg,"padding-left"),"0cm"),em=eu(ee.getAttributeNS(eg,"padding-right"),"0cm"),eh=eu(ee.getAttributeNS(eg,"padding-top"),"0cm"),ee=eu(ee.getAttributeNS(eg,"padding-bottom"),"0cm")):ef=em=eh=ee=ef):(en=eu("21.001cm"),eo=eu("29.7cm"),er=ei=es=ed=er=eu("2cm"),ef=em=eh=ee=ef=eu("0cm")),{width:en-er-ei-ef-em,height:eo-es-ed-eh-ee}}},function(){var _=odf.Namespaces.stylens,$=odf.Namespaces.textns,ee={graphic:"draw","drawing-page":"draw",paragraph:"text",presentation:"presentation",ruby:"text",section:"text",table:"table","table-cell":"table","table-column":"table","table-row":"table",text:"text",list:"text",page:"office"};odf.StyleTreeNode=function(_){this.derivedStyles={},this.element=_},odf.StyleTree=function(et,en){function eo(ee){var et,en,eo,er={};if(!ee)return er;for(ee=ee.firstElementChild;ee;)(en=ee.namespaceURI!==_||"style"!==ee.localName&&"default-style"!==ee.localName?ee.namespaceURI===$&&"list-style"===ee.localName?"list":ee.namespaceURI!==_||"page-layout"!==ee.localName&&"default-page-layout"!==ee.localName?void 0:"page":ee.getAttributeNS(_,"family"))&&((et=ee.getAttributeNS(_,"name"))||(et=""),er.hasOwnProperty(en)?eo=er[en]:er[en]=eo={},eo[et]=ee),ee=ee.nextElementSibling;return er}function er(_,$){if(_.hasOwnProperty($))return _[$];var ee,et=null,en=Object.keys(_);for(ee=0;ee<en.length&&!(et=er(_[en[ee]].derivedStyles,$));ee+=1);return et}function ei($,ee,et){var en,eo,es;return ee.hasOwnProperty($)?(eo=(en=new odf.StyleTreeNode(ee[$])).element.getAttributeNS(_,"parent-style-name"),es=null,eo&&(es=er(et,eo)||ei(eo,ee,et)),es?es.derivedStyles[$]=en:et[$]=en,delete ee[$],en):null}function es(_,$){_&&Object.keys(_).forEach(function(ee){ei(ee,_,$)})}var el={};this.getStyleTree=function(){return el},function(){var _,$,er;$=eo(et),er=eo(en),Object.keys(ee).forEach(function(ee){_=el[ee]={},es($[ee],_),es(er[ee],_)})}()}}(),function(){function _(_,$){try{_.insertRule($,_.cssRules.length)}catch(_){runtime.log("cannot load rule: "+$+" - "+_)}}function $(_,$){this.listCounterCount=0,this.contentRules=_,this.counterIdStack=[],this.continuedCounterIdStack=$}function ee(ee){function et($,en,er,es){var el=en.namespaceURI===eo&&"list"===en.localName,eu=en.namespaceURI===eo&&"list-item"===en.localName;if(el||eu){if(el){var ec,ed,ef,el=er+=1;for(es.listCounterCount+=1,eu=$+"-level"+el+"-"+es.listCounterCount,en.setAttributeNS("urn:webodf:names:helper","counter-id",eu),(ec=es.continuedCounterIdStack.shift())||(ec=eu,ei+=eu+" 1 ",_(ee,ed='text|list[webodfhelper|counter-id="'+eu+'"] > text|list-item:first-child > :not(text|list):first-child:before{counter-increment: '+ec+" 0;}"));es.counterIdStack.length>=el;)es.counterIdStack.pop();for(es.counterIdStack.push(ec),ef=es.contentRules[el.toString()]||"",ed=1;ed<=el;ed+=1)ef=ef.replace(ed+"webodf-listLevel",es.counterIdStack[ed-1]);_(ee,ed='text|list[webodfhelper|counter-id="'+eu+'"] > text|list-item > :not(text|list):first-child:before{'+ef+"counter-increment: "+ec+";}")}for(en=en.firstElementChild;en;)et($,en,er,es),en=en.nextElementSibling}else es.continuedCounterIdStack=[]}var en=0,ei="",es={};this.createCounterRules=function(_,ee,eo){var ei=ee.getAttributeNS(er,"id"),el=[];eo&&(el=es[eo=eo.getAttributeNS("urn:webodf:names:helper","counter-id")].slice(0)),_=new $(_,el),ei?ei="Y"+ei:(en+=1,ei="X"+en),et(ei,ee,0,_),es[ei+"-level1-1"]=_.counterIdStack},this.initialiseCreatedCounters=function(){var $;_(ee,$="office|document{counter-reset: "+ei+";}")}}var et=odf.Namespaces.fons,en=odf.Namespaces.stylens,eo=odf.Namespaces.textns,er=odf.Namespaces.xmlns,ei={1:"decimal",a:"lower-latin",A:"upper-latin",i:"lower-roman",I:"upper-roman"};odf.ListStyleToCss=function(){function $(_){var $=ed.parseLength(_);return $?ec.convert($.value,$.unit,"px"):(runtime.log("Could not parse value '"+_+"'."),0)}function es(_){return _.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function el(_,$){var ee;return _&&(ee=_.getAttributeNS(eo,"style-name")),ee===$}function eu(_,$,et){$=$.getElementsByTagNameNS(eo,"list"),_=new ee(_);var eu,ec,ed,ef,ep,em,eh,eg={};for(eh=0;eh<$.length;eh+=1)if(em=(eu=$.item(eh)).getAttributeNS(eo,"style-name")){ed=eu.getAttributeNS(eo,"continue-numbering"),ef=eu.getAttributeNS(eo,"continue-list"),(ep=eu.getAttributeNS(er,"id"))&&(eg[ep]=eu),ep=et[em].element.firstElementChild;for(var eb=void 0,ey={};ep;){var eb=(eb=ep.getAttributeNS(eo,"level"))&&parseInt(eb,10),ev=ep,eS="",eN=void 0,eC=void 0,ex=eN=void 0;if("list-level-style-number"===ev.localName){var ew=ev,eS=ew.getAttributeNS(en,"num-format"),eN=ew.getAttributeNS(en,"num-suffix")||"",eC=ew.getAttributeNS(en,"num-prefix")||"",eE="",eT=ew.getAttributeNS(eo,"level"),ew=ew.getAttributeNS(eo,"display-levels");if(eC&&(eE+='"'+es(eC)+'"\n'),ei.hasOwnProperty(eS))for(eT=eT?parseInt(eT,10):1,ew=ew?parseInt(ew,10):1;0<ew;)eE+=" counter("+(eT-ew+1)+"webodf-listLevel,"+ei[eS]+")",1<ew&&(eE+='"."'),--ew;else eE=eS?eE+' "'+eS+'"':eE+' ""';eS="content:"+eE+' "'+es(eN)+'"'}else"list-level-style-image"===ev.localName?eS="content: none":"list-level-style-bullet"===ev.localName&&(eS='content: "'+es(eS=ev.getAttributeNS(eo,"bullet-char"))+'"');(eN=ev.getElementsByTagNameNS(en,"list-level-properties")[0])&&"label-alignment"===(eC=eN.getAttributeNS(eo,"list-level-position-and-space-mode"))&&((eN=eN.getElementsByTagNameNS(en,"list-level-label-alignment")[0])&&(ex=eN.getAttributeNS(eo,"label-followed-by")),"space"===ex&&(eS+=' "\\a0"')),ey[eb]="\n"+eS+";\n",ep=ep.nextElementSibling}ep=ey,ed&&!ef&&el(ec,em)?_.createCounterRules(ep,eu,ec):ef&&el(eg[ef],em)?_.createCounterRules(ep,eu,eg[ef]):_.createCounterRules(ep,eu),ec=eu}_.initialiseCreatedCounters()}var ec=new core.CSSUnits,ed=odf.OdfUtils;this.applyListStyles=function(ee,er,ei){var es,el;(es=er.list)&&Object.keys(es).forEach(function(er){el=es[er];for(var ei=el.element.firstElementChild;ei;){if(ei.namespaceURI===eo){for(var eu=ee,ec=ei,ed='text|list[text|style-name="'+er+'"]',ef=ec.getAttributeNS(eo,"level"),ep=void 0,em=void 0,eh=em=void 0,eg=void 0,eb=void 0,ey=ep=void 0,ev=void 0,eS=void 0,eN=void 0,eg=void 0,eh=(em=ec.getElementsByTagNameNS(en,"list-level-properties")[0])&&em.getAttributeNS(eo,"list-level-position-and-space-mode"),eg=em&&em.getElementsByTagNameNS(en,"list-level-label-alignment")[0],ep=ef=ef&&parseInt(ef,10);1<ep;)ed+=" > text|list-item > text|list",--ep;switch(ep=em&&em.getAttributeNS(et,"text-align")||"left"){case"end":ep="right";break;case"start":ep="left"}"label-alignment"===eh?(eb=eg&&eg.getAttributeNS(et,"margin-left")||"0px",eS=eg&&eg.getAttributeNS(et,"text-indent")||"0px",eN=eg&&eg.getAttributeNS(eo,"label-followed-by"),eg=$(eb)):(eb=em&&em.getAttributeNS(eo,"space-before")||"0px",ey=em&&em.getAttributeNS(eo,"min-label-width")||"0px",ev=em&&em.getAttributeNS(eo,"min-label-distance")||"0px",eg=$(eb)+$(ey)),_(eu,em=ed+" > text|list-item{margin-left: "+eg+"px;}"),_(eu,em=ed+" > text|list-item > text|list{margin-left: "+-eg+"px;}"),em=ed+" > text|list-item > :not(text|list):first-child:before{text-align: "+ep+";display: inline-block;","label-alignment"===eh?(em+="margin-left: "+eS+";","listtab"===eN&&(em+="padding-right: 0.2cm;")):em+="min-width: "+ey+";"+("margin-left: "+(0===parseFloat(ey)?"":"-"))+ey+";padding-right: "+ev+";",_(eu,em+="}")}ei=ei.nextElementSibling}}),eu(ee,ei,es)}}}(),odf.LazyStyleProperties=function(_,$){var ee={};this.value=function(et){var en;return ee.hasOwnProperty(et)?en=ee[et]:(void 0===(en=$[et]())&&_&&(en=_.value(et)),ee[et]=en),en},this.reset=function($){_=$,ee={}}},odf.StyleParseUtils=function(){function _(_){var $,ee;return"px"===(ee=(_=(_=/(-?[0-9]*[0-9][0-9]*(\.[0-9]*)?|0+\.[0-9]*[1-9][0-9]*|\.[0-9]*[1-9][0-9]*)((cm)|(mm)|(in)|(pt)|(pc)|(px))/.exec(_))?{value:parseFloat(_[1]),unit:_[3]}:null)&&_.unit)?$=_.value:"cm"===ee?$=_.value/2.54*96:"mm"===ee?$=_.value/25.4*96:"in"===ee?$=96*_.value:"pt"===ee?$=_.value/.75:"pc"===ee&&($=16*_.value),$}var $=odf.Namespaces.stylens;this.parseLength=_,this.parsePositiveLengthOrPercent=function($,ee,et){var en,eo;return $&&isNaN(en=parseFloat($.substr(0,$.indexOf("%"))))&&(en=void 0),void 0!==en?(et&&(eo=et.value(ee)),en=void 0===eo?void 0:eo/100*en):en=_($),en},this.getPropertiesElement=function(_,ee,et){for(ee=et?et.nextElementSibling:ee.firstElementChild;null!==ee&&(ee.localName!==_||ee.namespaceURI!==$);)ee=ee.nextElementSibling;return ee},this.parseAttributeList=function(_){return _&&(_=_.replace(/^\s*(.*?)\s*$/g,"$1")),_&&0<_.length?_.split(/\s+/):[]}},odf.Style2CSS=function(){function _($,ee,et){var en=[];et=et.derivedStyles;var eo,er,ei=ev[$];for(eo in void 0===ei?ee=null:(er=ee?"["+ei+'|style-name="'+ee+'"]':"","presentation"===ei&&(ei="draw",er=ee?'[presentation|style-name="'+ee+'"]':""),ee=ei+"|"+eS[$].join(er+","+ei+"|")+er),null!==ee&&en.push(ee),et)et.hasOwnProperty(eo)&&(ee=_($,eo,et[eo]),en=en.concat(ee));return en}function $(_){var $="",ee=null;return"default-style"===_.localName?null:(ee=_.getAttributeNS(ef,"parent-style-name"),$=_.getAttributeNS(ef,"family"),eF.getODFElementsWithXPath(es,ee?"//style:*[@style:name='"+ee+"'][@style:family='"+$+"']":"//style:default-style[@style:family='"+$+"']",odf.Namespaces.lookupNamespaceURI)[0])}function ee(_,ee){var et,en,eo,er="";for(et=0;et<ee.length;et+=1)if(en=ee[et],eo=_.getAttributeNS(en[0],en[1])){if(eo=eo.trim(),eD.hasOwnProperty(en[1])){var ei=eo,es=ei.indexOf(" "),el=void 0;eo=void 0,-1!==es?(el=ei.substring(0,es),eo=ei.substring(es)):(el=ei,eo=""),(el=eI.parseLength(el))&&"pt"===el.unit&&.75>el.value&&(ei="0.75pt"+eo),eo=ei}else if(e_.hasOwnProperty(en[1])){var ei=_,es=en[0],el=en[1],eu=eI.parseLength(eo),ec=void 0,ed=void 0,ep=void 0,em=void 0;if(eu&&"%"===eu.unit){for(ep="0",ec=eu.value/100,ed=$(ei.parentNode);ed;){if((em=eb.getDirectChild(ed,ef,"paragraph-properties"))&&(em=eI.parseLength(em.getAttributeNS(es,el)))){if("%"!==em.unit){ep=em.value*ec+em.unit;break}ec*=em.value/100}ed=$(ed)}eo=ep}}en[2]&&(er+=en[2]+":"+eo+";")}return er}function et(_,$,ee,et){return $+$+ee+ee+et+et}function en(_,$){var ee=[_],et=$.derivedStyles;return Object.keys(et).forEach(function(_){_=en(_,et[_]),ee=ee.concat(_)}),ee}function eo(_,$,ee,et){function eo($,ee){var et,en=[];$.forEach(function(_){er.forEach(function($){en.push('draw|page[webodfhelper|page-style-name="'+$+'"] draw|frame[presentation|class="'+_+'"]')})}),0<en.length&&(et=en.join(",")+"{visibility:"+ee+";}",_.insertRule(et,_.cssRules.length))}var er=en($,et),ei=[],es=[];["page-number","date-time","header","footer"].forEach(function(_){var $;"true"===($=ee.getAttributeNS(eg,"display-"+_))?ei.push(_):"false"===$&&es.push(_)}),eo(ei,"visible"),eo(es,"hidden")}function er(en,es,ep,ev){var eS,eD;if("page"===es){var e_,eF,eB,eU=ev.element,eL="";if(eB=eF="",ep=eb.getDirectChild(eU,ef,"page-layout-properties")){if(e_=eU.getAttributeNS(ef,"name"),eL+=ee(ep,eR),(eF=eb.getDirectChild(ep,ef,"background-image"))&&(eB=eF.getAttributeNS(eh,"href"))&&(eL=eL+"background-image: url('odfkit:"+eB+"');"+ee(eF,eC)),"presentation"===ei)for(eU=(eU=eb.getDirectChild(eU.parentNode.parentNode,ed,"master-styles"))&&eU.firstElementChild;eU;)eU.namespaceURI===ef&&"master-page"===eU.localName&&eU.getAttributeNS(ef,"page-layout-name")===e_&&(eF='draw|page[draw|master-page-name="'+(eB=eU.getAttributeNS(ef,"name"))+'"] {'+eL+"}",eB='office|body, draw|page[draw|master-page-name="'+eB+'"] {'+ee(ep,eP)+" }",en.insertRule(eF,en.cssRules.length),en.insertRule(eB,en.cssRules.length)),eU=eU.nextElementSibling;else"text"===ei&&(eF="office|text {"+eL+"}",eB="office|body {width: "+ep.getAttributeNS(ec,"page-width")+";}",en.insertRule(eF,en.cssRules.length),en.insertRule(eB,en.cssRules.length))}}else{if(eL=_(es,ep,ev).join(","),e_="",eU=eb.getDirectChild(ev.element,ef,"text-properties")){var ez=eU,eH=eD="";switch(eF="",eB=1,eU=""+ee(ez,eN),"solid"===(eS=ez.getAttributeNS(ef,"text-underline-style"))&&(eD+=" underline"),"solid"===(eS=ez.getAttributeNS(ef,"text-line-through-style"))&&(eD+=" line-through"),eD.length&&(eU=eU+"text-decoration:"+eD+";\ntext-decoration-line:"+eD+";\n-moz-text-decoration-line:"+eD+";\n"),eS=ez.getAttributeNS(ef,"text-line-through-type")){case"double":eH+=" double";break;case"single":eH+=" single"}if(eH&&(eU+="text-decoration-style:"+eH+";\n-moz-text-decoration-style:"+eH+";\n"),(eD=ez.getAttributeNS(ef,"font-name")||ez.getAttributeNS(ec,"font-family"))&&(eS=ek[eD],eU+="font-family: "+(eS||eD)+";"),(eS=ez.getAttributeNS(ef,"text-position"))&&(eS=(eD=ey.parseAttributeList(eS))[0],eD=eD[1],eU+="vertical-align: "+eS+"\n; ",eD&&(eB=parseFloat(eD)/100)),ez.hasAttributeNS(ec,"font-size")||1!==eB){for(ez=ez.parentNode;ez;){if(eS=(eS=eb.getDirectChild(ez,ef,"text-properties"))?eI.parseFoFontSize(eS.getAttributeNS(ec,"font-size")):null){if("%"!==eS.unit){eF="font-size: "+eS.value*eB+eS.unit+";";break}eB*=eS.value/100}ez=$(ez)}eF||(eF="font-size: "+parseFloat(el)*eB+eM.getUnits(el)+";")}eU+=eF,e_+=eU}(eU=eb.getDirectChild(ev.element,ef,"paragraph-properties"))&&(eU=""+ee(eF=eU,ex),(eB=eb.getDirectChild(eF,ef,"background-image"))&&(ez=eB.getAttributeNS(eh,"href"))&&(eU=eU+"background-image: url('odfkit:"+ez+"');"+ee(eB,eC)),(eF=eF.getAttributeNS(ec,"line-height"))&&"normal"!==eF&&(eU="%"!==(eF=eI.parseFoLineHeight(eF)).unit?eU+"line-height: "+eF.value+eF.unit+";":eU+"line-height: "+eF.value/100+";"),e_+=eU),(eU=eb.getDirectChild(ev.element,ef,"graphic-properties"))&&(eU=""+ee(ez=eU,ew),eF=ez.getAttributeNS(eu,"opacity"),eB=ez.getAttributeNS(eu,"fill"),ez=ez.getAttributeNS(eu,"fill-color"),"solid"===eB||"hatch"===eB?ez&&"none"!==ez?(eF=isNaN(parseFloat(eF))?1:parseFloat(eF)/100,eB=ez.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,et),(ez=(eB=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(eB))?{r:parseInt(eB[1],16),g:parseInt(eB[2],16),b:parseInt(eB[3],16)}:null)&&(eU+="background-color: rgba("+ez.r+","+ez.g+","+ez.b+","+eF+");")):eU+="background: none;":"none"===eB&&(eU+="background: none;"),e_+=eU),(eU=eb.getDirectChild(ev.element,ef,"drawing-page-properties"))&&(eB=""+ee(eF=eU,ew),"true"===eF.getAttributeNS(eg,"background-visible")&&(eB+="background: none;"),e_+=eB,eo(en,ep,eU,ev)),(eU=eb.getDirectChild(ev.element,ef,"table-cell-properties"))&&(ep=e_,e_=""+ee(eU,eE),e_=ep+e_),(eU=eb.getDirectChild(ev.element,ef,"table-row-properties"))&&(ep=e_,e_=""+ee(eU,eO),e_=ep+e_),(eU=eb.getDirectChild(ev.element,ef,"table-column-properties"))&&(ep=e_,e_=""+ee(eU,eT),e_=ep+e_),(eU=eb.getDirectChild(ev.element,ef,"table-properties"))&&(ep=e_,e_=""+ee(eU,eA),"collapsing"===(eU=eU.getAttributeNS(em,"border-model"))?e_+="border-collapse:collapse;":"separating"===eU&&(e_+="border-collapse:separate;"),e_=ep+e_),0!==e_.length&&en.insertRule(eL+"{"+e_+"}",en.cssRules.length)}for(var eW in ev.derivedStyles)ev.derivedStyles.hasOwnProperty(eW)&&er(en,es,eW,ev.derivedStyles[eW])}var ei,es,el,eu=odf.Namespaces.drawns,ec=odf.Namespaces.fons,ed=odf.Namespaces.officens,ef=odf.Namespaces.stylens,ep=odf.Namespaces.svgns,em=odf.Namespaces.tablens,eh=odf.Namespaces.xlinkns,eg=odf.Namespaces.presentationns,eb=core.DomUtils,ey=new odf.StyleParseUtils,ev={graphic:"draw","drawing-page":"draw",paragraph:"text",presentation:"presentation",ruby:"text",section:"text",table:"table","table-cell":"table","table-column":"table","table-row":"table",text:"text",list:"text",page:"office"},eS={graphic:"circle connected control custom-shape ellipse frame g line measure page page-thumbnail path polygon polyline rect regular-polygon".split(" "),paragraph:"alphabetical-index-entry-template h illustration-index-entry-template index-source-style object-index-entry-template p table-index-entry-template table-of-content-entry-template user-index-entry-template".split(" "),presentation:"caption circle connector control custom-shape ellipse frame g line measure page-thumbnail path polygon polyline rect regular-polygon".split(" "),"drawing-page":"caption circle connector control page custom-shape ellipse frame g line measure page-thumbnail path polygon polyline rect regular-polygon".split(" "),ruby:["ruby","ruby-text"],section:"alphabetical-index bibliography illustration-index index-title object-index section table-of-content table-index user-index".split(" "),table:["background","table"],"table-cell":"body covered-table-cell even-columns even-rows first-column first-row last-column last-row odd-columns odd-rows table-cell".split(" "),"table-column":["table-column"],"table-row":["table-row"],text:"a index-entry-chapter index-entry-link-end index-entry-link-start index-entry-page-number index-entry-span index-entry-tab-stop index-entry-text index-title-template linenumbering-configuration list-level-style-number list-level-style-bullet outline-level-style span".split(" "),list:["list-item"]},eN=[[ec,"color","color"],[ec,"background-color","background-color"],[ec,"font-weight","font-weight"],[ec,"font-style","font-style"]],eC=[[ef,"repeat","background-repeat"]],ex=[[ec,"background-color","background-color"],[ec,"text-align","text-align"],[ec,"text-indent","text-indent"],[ec,"padding","padding"],[ec,"padding-left","padding-left"],[ec,"padding-right","padding-right"],[ec,"padding-top","padding-top"],[ec,"padding-bottom","padding-bottom"],[ec,"border-left","border-left"],[ec,"border-right","border-right"],[ec,"border-top","border-top"],[ec,"border-bottom","border-bottom"],[ec,"margin","margin"],[ec,"margin-left","margin-left"],[ec,"margin-right","margin-right"],[ec,"margin-top","margin-top"],[ec,"margin-bottom","margin-bottom"],[ec,"border","border"]],ew=[[ec,"background-color","background-color"],[ec,"min-height","min-height"],[eu,"stroke","border"],[ep,"stroke-color","border-color"],[ep,"stroke-width","border-width"],[ec,"border","border"],[ec,"border-left","border-left"],[ec,"border-right","border-right"],[ec,"border-top","border-top"],[ec,"border-bottom","border-bottom"]],eE=[[ec,"background-color","background-color"],[ec,"border-left","border-left"],[ec,"border-right","border-right"],[ec,"border-top","border-top"],[ec,"border-bottom","border-bottom"],[ec,"border","border"]],eT=[[ef,"column-width","width"]],eO=[[ef,"row-height","height"],[ec,"keep-together",null]],eA=[[ef,"width","width"],[ec,"margin-left","margin-left"],[ec,"margin-right","margin-right"],[ec,"margin-top","margin-top"],[ec,"margin-bottom","margin-bottom"]],eR=[[ec,"background-color","background-color"],[ec,"padding","padding"],[ec,"padding-left","padding-left"],[ec,"padding-right","padding-right"],[ec,"padding-top","padding-top"],[ec,"padding-bottom","padding-bottom"],[ec,"border","border"],[ec,"border-left","border-left"],[ec,"border-right","border-right"],[ec,"border-top","border-top"],[ec,"border-bottom","border-bottom"],[ec,"margin","margin"],[ec,"margin-left","margin-left"],[ec,"margin-right","margin-right"],[ec,"margin-top","margin-top"],[ec,"margin-bottom","margin-bottom"]],eP=[[ec,"page-width","width"],[ec,"page-height","height"]],eD={border:!0,"border-left":!0,"border-right":!0,"border-top":!0,"border-bottom":!0,"stroke-width":!0},e_={margin:!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"margin-bottom":!0},ek={},eI=odf.OdfUtils,eF=xmldom.XPath,eM=new core.CSSUnits;this.style2css=function(_,$,ee,et,en){var eo,eu,ec;function ed(_,$){eo="@namespace "+_+" url("+$+");";try{ee.insertRule(eo,ee.cssRules.length)}catch(_){}}for(es=$;ee.cssRules.length;)ee.deleteRule(ee.cssRules.length-1);for(ec in odf.Namespaces.forEachPrefix(ed),ed("webodfhelper","urn:webodf:names:helper"),ek=et,ei=_,el=runtime.getWindow().getComputedStyle(document.body,null).getPropertyValue("font-size")||"12pt",ev)if(ev.hasOwnProperty(ec))for(eu in _=en[ec])_.hasOwnProperty(eu)&&er(ee,ec,eu,_[eu])}},function(){function _($,ee){var et=this;this.getDistance=function(_){var $=et.x-_.x;return Math.sqrt($*$+(_=et.y-_.y)*_)},this.getCenter=function($){return new _((et.x+$.x)/2,(et.y+$.y)/2)},et.x=$,et.y=ee}gui.ZoomHelper=function(){function $(_,$,ee,et){_=et?"translate3d("+_+"px, "+$+"px, 0) scale3d("+ee+", "+ee+", 1)":"translate("+_+"px, "+$+"px) scale("+ee+")",ed.style.WebkitTransform=_,ed.style.MozTransform=_,ed.style.msTransform=_,ed.style.OTransform=_,ed.style.transform=_}function ee(_){_?$(-ef.x,-ef.y,eh,!0):($(0,0,eh,!0),$(0,0,eh,!1))}function et(_){if(eb&&eC){var $=eb.style.overflow,ee=eb.classList.contains("webodf-customScrollbars");_&&ee||!_&&!ee||(_?(eb.classList.add("webodf-customScrollbars"),eb.style.overflow="hidden",runtime.requestAnimationFrame(function(){eb.style.overflow=$})):eb.classList.remove("webodf-customScrollbars"))}}function en(){$(-ef.x,-ef.y,eh,!0),eb.scrollLeft=0,eb.scrollTop=0,ex=ey.style.overflow,ey.style.overflow="visible",et(!1)}function eo(){$(0,0,eh,!0),eb.scrollLeft=ef.x,eb.scrollTop=ef.y,ey.style.overflow=ex||"",et(!0)}function er($){return new _($.pageX-ed.offsetLeft,$.pageY-ed.offsetTop)}function ei($){if(ep){ef.x-=$.x-ep.x,ef.y-=$.y-ep.y;var ee=ef;ef=new _(Math.min(Math.max(ee.x,ed.offsetLeft),(ed.offsetLeft+ed.offsetWidth)*eh-eb.clientWidth),Math.min(Math.max(ee.y,ed.offsetTop),(ed.offsetTop+ed.offsetHeight)*eh-eb.clientHeight))}ep=$}function es(_){var $=_.touches.length,ee=0<$?er(_.touches[0]):null;_=1<$?er(_.touches[1]):null,ee&&_?(em=ee.getDistance(_),eg=eh,ep=ee.getCenter(_),en(),eN=eS.PINCH):ee&&(ep=ee,eN=eS.SCROLL)}function el(_){var $=_.touches.length,et=0<$?er(_.touches[0]):null,$=1<$?er(_.touches[1]):null;if(et&&$){if(_.preventDefault(),eN===eS.SCROLL)eN=eS.PINCH,en(),em=et.getDistance($);else{_=et.getCenter($),et=et.getDistance($)/em,ei(_);var $=eh,es=Math.min(4,ed.offsetParent.clientWidth/ed.offsetWidth);et=(eh=Math.min(Math.max(eh=eg*et,es),4))/$,ef.x+=(et-1)*(_.x+ef.x),ef.y+=(et-1)*(_.y+ef.y),ee(!0)}}else et&&(eN===eS.PINCH?(eN=eS.SCROLL,eo()):ei(et))}function eu(){eN===eS.PINCH&&(ev.emit(gui.ZoomHelper.signalZoomChanged,eh),eo(),ee(!1)),eN=eS.NONE}function ec(){eb&&(eb.removeEventListener("touchstart",es,!1),eb.removeEventListener("touchmove",el,!1),eb.removeEventListener("touchend",eu,!1))}var ed,ef,ep,em,eh,eg,eb,ey,ev=new core.EventNotifier([gui.ZoomHelper.signalZoomChanged]),eS={NONE:0,SCROLL:1,PINCH:2},eN=eS.NONE,eC=runtime.getWindow().hasOwnProperty("ontouchstart"),ex="";this.subscribe=function(_,$){ev.subscribe(_,$)},this.unsubscribe=function(_,$){ev.unsubscribe(_,$)},this.getZoomLevel=function(){return eh},this.setZoomLevel=function(_){ed&&(eh=_,ee(!1),ev.emit(gui.ZoomHelper.signalZoomChanged,eh))},this.destroy=function(_){ec(),et(!1),_()},this.setZoomableElement=function(_){ec(),eb=(ed=_).offsetParent,ey=ed.parentNode,ee(!1),eb&&(eb.addEventListener("touchstart",es,!1),eb.addEventListener("touchmove",el,!1),eb.addEventListener("touchend",eu,!1)),et(!0)},eg=eh=1,ef=new _(0,0)},gui.ZoomHelper.signalZoomChanged="zoomChanged"}(),ops.Canvas=function(){},ops.Canvas.prototype.getZoomLevel=function(){},ops.Canvas.prototype.getElement=function(){},ops.Canvas.prototype.getSizer=function(){},ops.Canvas.prototype.getZoomHelper=function(){},function(){function _(){function _(et){ee=!0,runtime.setTimeout(function(){try{et()}catch(_){runtime.log(String(_)+"\n"+_.stack)}ee=!1,0<$.length&&_($.pop())},10)}var $=[],ee=!1;this.clearQueue=function(){$.length=0},this.addToQueue=function(et){if(0===$.length&&!ee)return _(et);$.push(et)}}function $(_){function $(){for(;0<ee.cssRules.length;)ee.deleteRule(0);ee.insertRule("#shadowContent draw|page {display:none;}",0),ee.insertRule("office|presentation draw|page {display:none;}",1),ee.insertRule("#shadowContent draw|page:nth-of-type("+et+") {display:block;}",2),ee.insertRule("office|presentation draw|page:nth-of-type("+et+") {display:block;}",3)}var ee=_.sheet,et=1;this.showFirstPage=function(){et=1,$()},this.showNextPage=function(){et+=1,$()},this.showPreviousPage=function(){1<et&&(--et,$())},this.showPage=function(_){0<_&&(et=_,$())},this.css=_,this.destroy=function($){_.parentNode.removeChild(_),$()}}function ee(_){_=_.sheet;for(var $=_.cssRules;$.length;)_.deleteRule($.length-1)}function et(_,$,ee){var et=new odf.Style2CSS,en=new odf.ListStyleToCss;ee=ee.sheet;var eo=new odf.StyleTree(_.rootElement.styles,_.rootElement.automaticStyles).getStyleTree();et.style2css(_.getDocumentType(),_.rootElement,ee,$.getFontMap(),eo),en.applyListStyles(ee,eo,_.rootElement.body)}function en(_,$){(new odf.FontLoader).loadFonts(_,$.sheet)}function eo(_,$,ee){var et,en=null;if(_=_.rootElement.body.getElementsByTagNameNS(ew,ee+"-decl"),(ee=$.getAttributeNS(ew,"use-"+ee+"-name"))&&0<_.length){for($=0;$<_.length;$+=1)if((et=_[$]).getAttributeNS(ew,"name")===ee){en=et.textContent;break}}return en}function er(_,$,ee,et){var en=_.ownerDocument;for($=eT.getElementsByTagNameNS(_,$,ee),_=0;_<$.length;_+=1)eT.removeAllChildNodes($[_]),et&&(ee=$[_]).appendChild(en.createTextNode(et))}function ei(_,$,ee){$.setAttributeNS("urn:webodf:names:helper","styleid",_);var et,en=$.getAttributeNS(eC,"anchor-type"),eo=$.getAttributeNS(eS,"x"),er=$.getAttributeNS(eS,"y"),ei=$.getAttributeNS(eS,"width"),es=$.getAttributeNS(eS,"height"),el=$.getAttributeNS(eb,"min-height"),eu=$.getAttributeNS(eb,"min-width");"as-char"===en?et="display: inline-block;":en||eo||er?et="position: absolute;":(ei||es||el||eu)&&(et="display: block;"),eo&&(et+="left: "+eo+";"),er&&(et+="top: "+er+";"),ei&&(et+="width: "+ei+";"),es&&(et+="height: "+es+";"),el&&(et+="min-height: "+el+";"),eu&&(et+="min-width: "+eu+";"),et&&(et="draw|"+$.localName+'[webodfhelper|styleid="'+_+'"] {'+et+"}",ee.insertRule(et,ee.cssRules.length))}function es(_){for(_=_.firstChild;_;){if(_.namespaceURI===ey&&"binary-data"===_.localName)return"data:image/png;base64,"+_.textContent.replace(/[\r\n\s]/g,"");_=_.nextSibling}return""}function el(_,$,ee,et){function en($){$&&($='draw|image[webodfhelper|styleid="'+_+'"] {background-image: url('+$+");}",et.insertRule($,et.cssRules.length))}function eo(_){en(_.url)}ee.setAttributeNS("urn:webodf:names:helper","styleid",_);var er,ei=ee.getAttributeNS(ex,"href");if(ei)try{(er=$.getPart(ei)).onchange=eo,er.load()}catch(_){runtime.log("slight problem: "+String(_))}else en(ei=es(ee))}function eu(_){var $=_.ownerDocument;eT.getElementsByTagNameNS(_,eC,"line-break").forEach(function(_){_.hasChildNodes()||_.appendChild($.createElement("br"))})}function ec(_){var $=_.ownerDocument;eT.getElementsByTagNameNS(_,eC,"s").forEach(function(_){var ee,et;if(eT.removeAllChildNodes(_),_.appendChild($.createTextNode(" ")),1<(et=parseInt(_.getAttributeNS(eC,"c"),10)))for(_.removeAttributeNS(eC,"c"),ee=1;ee<et;ee+=1)_.parentNode.insertBefore(_.cloneNode(!0),_)})}function ed(_){eT.getElementsByTagNameNS(_,eC,"tab").forEach(function(_){_.textContent="	"})}function ef(_,$){function ee(_,ee){var et=el.documentElement.namespaceURI;"video/"===ee.substr(0,6)?((en=el.createElementNS(et,"video")).setAttribute("controls","controls"),eo=el.createElementNS(et,"source"),_&&eo.setAttribute("src",_),eo.setAttribute("type",ee),en.appendChild(eo),$.parentNode.appendChild(en)):$.innerHtml="Unrecognised Plugin"}function et(_){ee(_.url,_.mimetype)}var en,eo,er,ei,el=$.ownerDocument;if(er=$.getAttributeNS(ex,"href"))try{(ei=_.getPart(er)).onchange=et,ei.load()}catch(_){runtime.log("slight problem: "+String(_))}else runtime.log("using MP4 data fallback"),ee(er=es($),"video/mp4")}function ep(_){var $,ee,et=_.getElementsByTagName("head")[0];for($=_.styleSheets.length,ee=et.firstElementChild;ee&&("style"!==ee.localName||!ee.hasAttribute("webodfcss"));)ee=ee.nextElementSibling;return ee?($=parseInt(ee.getAttribute("webodfcss"),10),ee.setAttribute("webodfcss",$+1),ee):("string"===String(typeof webodf_css)?$=webodf_css:(ee="webodf.css",runtime.currentDirectory&&(0<(ee=runtime.currentDirectory()).length&&"/"!==ee.substr(-1)&&(ee+="/"),ee+="../webodf.css"),$=runtime.readFileSync(ee,"utf-8")),(ee=_.createElementNS(et.namespaceURI,"style")).setAttribute("media","screen, print, handheld, projection"),ee.setAttribute("type","text/css"),ee.setAttribute("webodfcss","1"),ee.appendChild(_.createTextNode($)),et.appendChild(ee),ee)}function em(_){var $=parseInt(_.getAttribute("webodfcss"),10);1===$?_.parentNode.removeChild(_):_.setAttribute("count",$-1)}function eh(_){var $=_.getElementsByTagName("head")[0],ee=_.createElementNS($.namespaceURI,"style"),et="";return ee.setAttribute("type","text/css"),ee.setAttribute("media","screen, print, handheld, projection"),odf.Namespaces.forEachPrefix(function(_,$){et+="@namespace "+_+" url("+$+");\n"}),et+="@namespace webodfhelper url(urn:webodf:names:helper);\n",ee.appendChild(_.createTextNode(et)),$.appendChild(ee),ee}var eg=odf.Namespaces.drawns,eb=odf.Namespaces.fons,ey=odf.Namespaces.officens,ev=odf.Namespaces.stylens,eS=odf.Namespaces.svgns,eN=odf.Namespaces.tablens,eC=odf.Namespaces.textns,ex=odf.Namespaces.xlinkns,ew=odf.Namespaces.presentationns,eE=xmldom.XPath,eT=core.DomUtils;odf.OdfCanvas=function(es,eb){function eS(_,$,ee){var et,en;function eo(_,$,ee,et){eQ.addToQueue(function(){el(_,$,ee,et)})}for(et=$.getElementsByTagNameNS(eg,"image"),$=0;$<et.length;$+=1)en=et.item($),eo("image"+String($),_,en,ee)}function ex(_,$){var ee,et;function en(_,$){eQ.addToQueue(function(){ef(_,$)})}for(ee=0,et=$.getElementsByTagNameNS(eg,"plugin");ee<et.length;ee+=1)en(_,et.item(ee))}function eO(){_=eX.firstChild;var _,$=e$.getZoomLevel();_&&(eX.style.WebkitTransformOrigin="0% 0%",eX.style.MozTransformOrigin="0% 0%",eX.style.msTransformOrigin="0% 0%",eX.style.OTransformOrigin="0% 0%",eX.style.transformOrigin="0% 0%",eq&&((_=eq.getMinimumHeightForAnnotationPane())?eX.style.minHeight=_:eX.style.removeProperty("min-height")),es.style.width=Math.round($*eX.offsetWidth)+"px",es.style.height=Math.round($*eX.offsetHeight)+"px",es.style.display="inline-block")}function eA(_,$){var ee=eB.sheet;eT.removeAllChildNodes(es),(eX=eW.createElementNS(es.namespaceURI,"div")).style.display="inline-block",eX.style.background="white",eX.style.setProperty("float","left","important"),eX.appendChild($),es.appendChild(eX),(eV=eW.createElementNS(es.namespaceURI,"div")).id="annotationsPane",(eU=eW.createElementNS(es.namespaceURI,"div")).id="shadowContent",eU.style.position="absolute",eU.style.top=0,eU.style.left=0,_.getContentElement().appendChild(eU);var et,en,el=$.body,ef=[];for(et=el.firstElementChild;et&&et!==el;)if(et.namespaceURI===eg&&(ef[ef.length]=et),et.firstElementChild)et=et.firstElementChild;else{for(;et&&et!==el&&!et.nextElementSibling;)et=et.parentNode;et&&et.nextElementSibling&&(et=et.nextElementSibling)}for(en=0;en<ef.length;en+=1)et=ef[en],ei("frame"+String(en),et,ee);for(et=0,ef=eE.getODFElementsWithXPath(el,".//*[*[@text:anchor-type='paragraph']]",odf.Namespaces.lookupNamespaceURI);et<ef.length;et+=1)(el=ef[et]).setAttributeNS&&el.setAttributeNS("urn:webodf:names:helper","containsparagraphanchor",!0);el=ej,et=eU;var ep,em,eh,eb,eO,eA=0;if(en=_.rootElement.ownerDocument,(ef=$.body.firstElementChild)&&ef.namespaceURI===ey&&("presentation"===ef.localName||"drawing"===ef.localName))for(ef=ef.firstElementChild;ef;){if(ep=(ep=ef.getAttributeNS(eg,"master-page-name"))?el.getMasterPageElement(ep):null){for(eA=0,em=ef.getAttributeNS("urn:webodf:names:helper","styleid"),eh=en.createElementNS(eg,"draw:page"),eO=ep.firstElementChild;eO;)"true"!==eO.getAttributeNS(ew,"placeholder")&&(eb=eO.cloneNode(!0),eh.appendChild(eb)),eO=eO.nextElementSibling,eA+=1;eO=eb=eA=void 0;for(var eR=eT.getElementsByTagNameNS(eh,eg,"frame"),eA=0;eA<eR.length;eA+=1)(eO=(eb=eR[eA]).getAttributeNS(ew,"class"))&&!/^(date-time|footer|header|page-number)$/.test(eO)&&eb.parentNode.removeChild(eb);for(eA=0,eb=eT.getElementsByTagNameNS(eh,eg,"*");eA<eb.length;eA+=1)ei(em+"_"+eA,eb[eA],ee);et.appendChild(eh),er(eh,eC,"page-number",eA=String(et.getElementsByTagNameNS(eg,"page").length)),er(eh,ew,"header",eo(_,ef,"header")),er(eh,ew,"footer",eo(_,ef,"footer")),ei(em,eh,ee),eh.setAttributeNS("urn:webodf:names:helper","page-style-name",ef.getAttributeNS(eg,"style-name")),eh.setAttributeNS(eg,"draw:master-page-name",ep.getAttributeNS(ev,"name"))}ef=ef.nextElementSibling}for(et=0,el=es.namespaceURI,ef=eT.getElementsByTagNameNS($.body,eN,"table-cell");et<ef.length;et+=1)(en=ef[et]).hasAttributeNS(eN,"number-columns-spanned")&&en.setAttributeNS(el,"colspan",en.getAttributeNS(eN,"number-columns-spanned")),en.hasAttributeNS(eN,"number-rows-spanned")&&en.setAttributeNS(el,"rowspan",en.getAttributeNS(eN,"number-rows-spanned"));eu($.body),ec($.body),ed($.body),eS(_,$.body,ee),ex(_,$.body),eX.insertBefore(eU,eX.firstChild),e$.setZoomableElement(eX)}function eR(_){eZ?(eV.parentNode||eX.appendChild(eV),eq&&eq.forgetAnnotations(),eq=new gui.AnnotationViewManager(eH,_.body,eV,eK),_=eT.getElementsByTagNameNS(_.body,ey,"annotation"),eq.addAnnotations(_),eO()):eV.parentNode&&(eX.removeChild(eV),eq.forgetAnnotations(),eO())}function eP(_){function $(){ee(eF),ee(eM),ee(eB),eT.removeAllChildNodes(es),es.style.display="inline-block";var $=e_.rootElement;es.ownerDocument.importNode($,!0),ej.setOdfContainer(e_),en(e_,eF),et(e_,ej,eM),eA(e_,$),eR($),_||eQ.addToQueue(function(){var _=[e_];if(eJ.hasOwnProperty("statereadychange")){var $,ee=eJ.statereadychange;for($=0;$<ee.length;$+=1)ee[$].apply(null,_)}})}e_.state===odf.OdfContainer.DONE?$():(runtime.log("WARNING: refreshOdf called but ODF was not DONE."),eL=runtime.setTimeout(function _(){e_.state===odf.OdfContainer.DONE?$():(runtime.log("will be back later..."),eL=runtime.setTimeout(_,500))},100))}function eD(_){eQ.clearQueue(),eT.removeAllChildNodes(es),es.appendChild(es.ownerDocument.createTextNode(runtime.tr("Loading")+_+"...")),es.removeAttribute("style"),e_=new odf.OdfContainer(_,function(_){e_=_,eP(!1)})}runtime.assert(null!=es,"odf.OdfCanvas constructor needs DOM element"),runtime.assert(null!==es.ownerDocument&&void 0!==es.ownerDocument,"odf.OdfCanvas constructor needs DOM");var e_,ek,eI,eF,eM,eB,eU,eL,ez,eH=this,eW=es.ownerDocument,ej=new odf.Formatting,eX=null,eV=null,eZ=!1,eK=!1,eq=null,eJ={},eG=!1,eY=!1,eQ=new _,e$=new gui.ZoomHelper,e0=eb||new gui.SingleScrollViewport(es.parentNode);this.refreshCSS=function(){eG=!0,ez.trigger()},this.refreshSize=function(){ez.trigger()},this.odfContainer=function(){return e_},this.setOdfContainer=function(_,$){e_=_,eP(!0===$)},this.load=this.load=eD,this.save=function(_){e_.save(_)},this.addListener=function(_,$){if("click"===_){var ee=_;es.addEventListener?es.addEventListener(ee,$,!1):es.attachEvent?es.attachEvent("on"+ee,$):es["on"+ee]=$}else ee=eJ.hasOwnProperty(_)?eJ[_]:eJ[_]=[],$&&-1===ee.indexOf($)&&ee.push($)},this.getFormatting=function(){return ej},this.getAnnotationViewManager=function(){return eq},this.refreshAnnotations=function(){eR(e_.rootElement)},this.rerenderAnnotations=function(){eq&&(eY=!0,ez.trigger())},this.getSizer=function(){return eX},this.enableAnnotations=function(_,$){_!==eZ&&(eZ=_,eK=$,e_&&eR(e_.rootElement))},this.addAnnotation=function(_){eq&&(eq.addAnnotations([_]),eO())},this.forgetAnnotation=function(_){eq&&(eq.forgetAnnotation(_),eO())},this.getZoomHelper=function(){return e$},this.setZoomLevel=function(_){e$.setZoomLevel(_)},this.getZoomLevel=function(){return e$.getZoomLevel()},this.fitToContainingElement=function(_,$){var ee=e$.getZoomLevel(),et=es.offsetHeight/ee,ee=_/(es.offsetWidth/ee);$/et<ee&&(ee=$/et),e$.setZoomLevel(ee)},this.fitToWidth=function(_){var $=es.offsetWidth/e$.getZoomLevel();e$.setZoomLevel(_/$)},this.fitSmart=function(_,$){var ee,et;et=e$.getZoomLevel(),ee=es.offsetWidth/et,et=es.offsetHeight/et,ee=_/ee,void 0!==$&&$/et<ee&&(ee=$/et),e$.setZoomLevel(Math.min(1,ee))},this.fitToHeight=function(_){var $=es.offsetHeight/e$.getZoomLevel();e$.setZoomLevel(_/$)},this.showFirstPage=function(){ek.showFirstPage()},this.showNextPage=function(){ek.showNextPage()},this.showPreviousPage=function(){ek.showPreviousPage()},this.showPage=function(_){ek.showPage(_),eO()},this.getElement=function(){return es},this.getViewport=function(){return e0},this.addCssForFrameWithImage=function(_){var $=_.getAttributeNS(eg,"name"),ee=_.firstElementChild;ei($,_,eB.sheet),ee&&el($+"img",e_,ee,eB.sheet)},this.destroy=function(_){var $=eW.getElementsByTagName("head")[0],ee=[ek.destroy,ez.destroy];runtime.clearTimeout(eL),eV&&eV.parentNode&&eV.parentNode.removeChild(eV),e$.destroy(function(){eX&&(es.removeChild(eX),eX=null)}),em(eI),$.removeChild(eF),$.removeChild(eM),$.removeChild(eB),core.Async.destroyAll(ee,_)},eI=ep(eW),ek=new $(eh(eW)),eF=eh(eW),eM=eh(eW),eB=eh(eW),ez=core.Task.createRedrawTask(function(){eG&&(et(e_,ej,eM),eG=!1),eY&&(eq&&eq.rerenderAnnotations(),eY=!1),eO()}),e$.subscribe(gui.ZoomHelper.signalZoomChanged,eO)}}(),odf.StepUtils=function(){this.getContentBounds=function(_){var $,ee,et=_.container();return runtime.assert(_.isStep(),"Step iterator must be on a step"),et.nodeType===Node.TEXT_NODE&&0<_.offset()?$=_.offset():(et=_.leftNode())&&et.nodeType===Node.TEXT_NODE&&($=et.length),et&&(et.nodeType===Node.TEXT_NODE?(runtime.assert(0<$,"Empty text node found"),ee={container:et,startOffset:$-1,endOffset:$}):ee={container:et,startOffset:0,endOffset:et.childNodes.length}),ee}},ops.MemberProperties=function(){},ops.Member=function(_,$){var ee=new ops.MemberProperties;this.getMemberId=function(){return _},this.getProperties=function(){return ee},this.setProperties=function(_){Object.keys(_).forEach(function($){ee[$]=_[$]})},this.removeProperties=function(_){Object.keys(_).forEach(function(_){"fullName"!==_&&"color"!==_&&"imageUrl"!==_&&ee.hasOwnProperty(_)&&delete ee[_]})},runtime.assert(!!_,"No memberId was supplied!"),$.fullName||($.fullName=runtime.tr("Unknown Author")),$.color||($.color="black"),$.imageUrl||($.imageUrl="avatar-joe.png"),ee=$},ops.Document=function(){},ops.Document.prototype.getMemberIds=function(){},ops.Document.prototype.removeCursor=function(_){},ops.Document.prototype.getDocumentElement=function(){},ops.Document.prototype.getRootNode=function(){},ops.Document.prototype.getDOMDocument=function(){},ops.Document.prototype.cloneDocumentElement=function(){},ops.Document.prototype.setDocumentElement=function(_){},ops.Document.prototype.subscribe=function(_,$){},ops.Document.prototype.unsubscribe=function(_,$){},ops.Document.prototype.getCanvas=function(){},ops.Document.prototype.createRootFilter=function(_){},ops.Document.prototype.createPositionIterator=function(_){},ops.Document.prototype.hasCursor=function(_){},ops.Document.signalCursorAdded="cursor/added",ops.Document.signalCursorRemoved="cursor/removed",ops.Document.signalCursorMoved="cursor/moved",ops.Document.signalMemberAdded="member/added",ops.Document.signalMemberUpdated="member/updated",ops.Document.signalMemberRemoved="member/removed",ops.OdtCursor=function(_,$){var ee,et,en=this,eo={},er=new core.EventNotifier([ops.OdtCursor.signalCursorUpdated]);this.removeFromDocument=function(){et.remove()},this.subscribe=function(_,$){er.subscribe(_,$)},this.unsubscribe=function(_,$){er.unsubscribe(_,$)},this.getMemberId=function(){return _},this.getNode=function(){return et.getNode()},this.getAnchorNode=function(){return et.getAnchorNode()},this.getSelectedRange=function(){return et.getSelectedRange()},this.setSelectedRange=function(_,$){et.setSelectedRange(_,$),er.emit(ops.OdtCursor.signalCursorUpdated,en)},this.hasForwardSelection=function(){return et.hasForwardSelection()},this.getDocument=function(){return $},this.getSelectionType=function(){return ee},this.setSelectionType=function(_){eo.hasOwnProperty(_)?ee=_:runtime.log("Invalid selection type: "+_)},this.resetSelectionType=function(){en.setSelectionType(ops.OdtCursor.RangeSelection)},et=new core.Cursor($.getDOMDocument(),_),eo[ops.OdtCursor.RangeSelection]=!0,eo[ops.OdtCursor.RegionSelection]=!0,en.resetSelectionType()},ops.OdtCursor.RangeSelection="Range",ops.OdtCursor.RegionSelection="Region",ops.OdtCursor.signalCursorUpdated="cursorUpdated",function(){var _=0;ops.StepsCache=function($,ee,et){function en(_,$){var ee=this;this.nodeId=_,this.steps=-1,this.node=$,this.previousBookmark=this.nextBookmark=null,this.setIteratorPosition=function(_){_.setPositionBeforeElement($),et(ee.steps,_)}}function eo(_,$,ee){var en=this;this.nodeId=_,this.steps=$,this.node=ee,this.previousBookmark=this.nextBookmark=null,this.setIteratorPosition=function(_){_.setUnfilteredPosition(ee,0),et(en.steps,_)}}function er(_,$){var ee="["+_.nodeId;return $&&(ee+=" => "+$.nodeId),ee+"]"}function ei(){if(!0===ops.StepsCache.ENABLE_CACHE_VERIFICATION){for(var _,ee,et,en=ef,eo=new core.LoopWatchDog(0,1e5),ei={};en;)eo.check(),(_=en.previousBookmark)?runtime.assert(_.nextBookmark===en,"Broken bookmark link to previous @"+er(_,en)):(runtime.assert(en===ef,"Broken bookmark link @"+er(en)),runtime.assert(void 0===ep||ef==ef||ef.steps<=ep,"Base point is damaged @"+er(en))),(ee=en.nextBookmark)&&runtime.assert(ee.previousBookmark===en,"Broken bookmark link to next @"+er(en,ee)),(void 0===ep||en===ef||en.steps<=ep)&&(runtime.assert(eg.containsNode($,en.node),"Disconnected node is being reported as undamaged @"+er(en)),_&&(et=en.node.compareDocumentPosition(_.node),runtime.assert(0===et||0!=(et&ey),"Bookmark order with previous does not reflect DOM order @"+er(_,en))),ee&&eg.containsNode($,ee.node)&&(et=en.node.compareDocumentPosition(ee.node),runtime.assert(0===et||0!=(et&eb),"Bookmark order with next does not reflect DOM order @"+er(en,ee)))),en=en.nextBookmark;Object.keys(em).forEach(function(_){var $=em[_];(void 0===ep||_<=ep)&&runtime.assert($.steps<=_,"Bookmark step of "+$.steps+" exceeds cached step lookup for "+_+" @"+er($)),runtime.assert(!1===ei.hasOwnProperty($.nodeId),"Bookmark "+er($)+" appears twice in cached step lookup at steps "+ei[$.nodeId]+" and "+_),ei[$.nodeId]=_})}}function es(_){var $="";return _.nodeType===Node.ELEMENT_NODE&&($=_.getAttributeNS("urn:webodf:names:steps","nodeId")||""),$}function el($){var ee=_.toString();return $.setAttributeNS("urn:webodf:names:steps","nodeId",ee),_+=1,ee}function eu(_){var $,et,en=new core.LoopWatchDog(0,1e4);for(void 0!==ep&&_>ep&&(_=ep),$=Math.floor(_/ee)*ee;!et&&0<=$;)et=em[$],$-=ee;for(et=et||ef;et.nextBookmark&&et.nextBookmark.steps<=_;)en.check(),et=et.nextBookmark;return runtime.assert(-1===_||et.steps<=_,"Bookmark @"+er(et)+" at step "+et.steps+" exceeds requested step of "+_),et}function ec(_){_.previousBookmark&&(_.previousBookmark.nextBookmark=_.nextBookmark),_.nextBookmark&&(_.nextBookmark.previousBookmark=_.previousBookmark)}function ed(_){for(var ee,et=null;!et&&_&&_!==$;)(ee=es(_))&&(et=eh[ee])&&et.node!==_&&(runtime.log("Cloned node detected. Creating new bookmark"),et=null,_.removeAttributeNS("urn:webodf:names:steps","nodeId")),_=_.parentNode;return et}var ef,ep,em={},eh={},eg=core.DomUtils,eb=Node.DOCUMENT_POSITION_FOLLOWING,ey=Node.DOCUMENT_POSITION_PRECEDING;this.updateBookmark=function(_,et){var eo,er,ed,ey,ev=Math.ceil(_/ee)*ee;if(void 0!==ep&&ep<_){for(ed=(er=eu(ep)).nextBookmark;ed&&ed.steps<=_;)eo=ed.nextBookmark,em[ey=Math.ceil(ed.steps/ee)*ee]===ed&&delete em[ey],eg.containsNode($,ed.node)?ed.steps=_+1:(ec(ed),delete eh[ed.nodeId]),ed=eo;ep=_}else er=eu(_);if((eo=eh[ed=es(et)||el(et)])?eo.node!==et&&(runtime.log("Cloned node detected. Creating new bookmark"),eo=eh[ed=el(et)]=new en(ed,et)):eo=eh[ed]=new en(ed,et),(ed=eo).steps!==_&&((eo=Math.ceil(ed.steps/ee)*ee)!==ev&&em[eo]===ed&&delete em[eo],ed.steps=_),er!==ed&&er.nextBookmark!==ed){if(er.steps===ed.steps)for(;0!=(ed.node.compareDocumentPosition(er.node)&eb)&&er!==ef;)er=er.previousBookmark;er!==ed&&er.nextBookmark!==ed&&(ec(ed),eo=er.nextBookmark,ed.nextBookmark=er.nextBookmark,ed.previousBookmark=er,er.nextBookmark=ed,eo&&(eo.previousBookmark=ed))}(er=em[ev])&&!(ed.steps>er.steps)||(em[ev]=ed),ei()},this.setToClosestStep=function(_,$){var ee;return ei(),(ee=eu(_)).setIteratorPosition($),ee.steps},this.setToClosestDomPoint=function(_,ee,et){var en,eo;if(ei(),_===$&&0===ee)en=ef;else if(_===$&&ee===$.childNodes.length)for(eo in en=ef,em)em.hasOwnProperty(eo)&&(_=em[eo]).steps>en.steps&&(en=_);else if(!(en=ed(_.childNodes.item(ee)||_)))for(et.setUnfilteredPosition(_,ee);!en&&et.previousNode();)en=ed(et.getCurrentNode());return en=en||ef,void 0!==ep&&en.steps>ep&&(en=eu(ep)),en.setIteratorPosition(et),en.steps},this.damageCacheAfterStep=function(_){0>_&&(_=-1),void 0===ep?ep=_:_<ep&&(ep=_),ei()},function(){var _=es($)||el($);ef=new eo(_,0,$)}()},ops.StepsCache.ENABLE_CACHE_VERIFICATION=!1,ops.StepsCache.Bookmark=function(){},ops.StepsCache.Bookmark.prototype.setIteratorPosition=function(_){}}(),function(){ops.OdtStepsTranslator=function(_,$,ee,et){function en(_,$,ee){var et=$.getCurrentNode();$.isBeforeNode()&&ei.isParagraph(et)&&(ee||(_+=1),er.updateBookmark(_,et))}function eo(_,$){if(!$||ee.acceptPosition(_)===el)return!0;for(;_.previousPosition();)if(ee.acceptPosition(_)===el){if($(eu,_.container(),_.unfilteredDomOffset()))return!0;break}for(;_.nextPosition();)if(ee.acceptPosition(_)===el){if($(ec,_.container(),_.unfilteredDomOffset()))return!0;break}return!1}var er,ei=odf.OdfUtils,es=core.DomUtils,el=core.PositionFilter.FilterResult.FILTER_ACCEPT,eu=core.StepDirection.PREVIOUS,ec=core.StepDirection.NEXT;this.convertStepsToDomPoint=function(_){var et,eo;if(isNaN(_))throw TypeError("Requested steps is not numeric ("+_+")");if(0>_)throw RangeError("Requested steps is negative ("+_+")");for(et=er.setToClosestStep(_,$);et<_&&$.nextPosition();)(eo=ee.acceptPosition($)===el)&&(et+=1),en(et,$,eo);if(et!==_)throw RangeError("Requested steps ("+_+") exceeds available steps ("+et+")");return{node:$.container(),offset:$.unfilteredDomOffset()}},this.convertDomPointToSteps=function(et,ei,eu){var ec;if(es.containsNode(_,et)||(ei=0>es.comparePoints(_,0,et,ei),et=_,ei=ei?0:_.childNodes.length),$.setUnfilteredPosition(et,ei),eo($,eu)||$.setUnfilteredPosition(et,ei),eu=$.container(),ei=$.unfilteredDomOffset(),et=er.setToClosestDomPoint(eu,ei,$),0>es.comparePoints($.container(),$.unfilteredDomOffset(),eu,ei))return 0<et?et-1:et;for(;($.container()!==eu||$.unfilteredDomOffset()!==ei)&&$.nextPosition();)(ec=ee.acceptPosition($)===el)&&(et+=1),en(et,$,ec);return et+0},this.prime=function(){var _,et;for(_=er.setToClosestStep(0,$);$.nextPosition();)(et=ee.acceptPosition($)===el)&&(_+=1),en(_,$,et)},this.handleStepsInserted=function(_){er.damageCacheAfterStep(_.position)},this.handleStepsRemoved=function(_){er.damageCacheAfterStep(_.position-1)},er=new ops.StepsCache(_,et,function(_,$){do{if(ee.acceptPosition($)===el){en(_,$,!0);break}en(_-1,$,!1)}while($.nextPosition())})}}(),ops.Operation=function(){},ops.Operation.prototype.init=function(_){},ops.Operation.prototype.execute=function(_){},ops.Operation.prototype.spec=function(){},ops.TextPositionFilter=function(){function _(_,$){for(;_&&$(_)!==eo;)_=_.previousSibling;return _}function $($,et,en,ei){var es;if(et){if(ee.isInlineRoot(et)&&ee.isGroupingElement(en))return er;if(1===(ei=ee.lookLeftForCharacter(et))||2===ei&&(ee.scanRightForAnyCharacter(en)||ee.scanRightForAnyCharacter(ee.nextNode($))))return eo}else if(ee.isGroupingElement($)&&ee.isInlineRoot(_($.previousSibling,ei)))return eo;return(ei=null===et&&ee.isParagraph($),es=ee.lookRightForCharacter(en),ei)?es?eo:ee.scanRightForAnyCharacter(en)?er:eo:es?(et=et||ee.previousNode($),ee.scanLeftForAnyCharacter(et)?er:eo):er}var ee=odf.OdfUtils,et=Node.ELEMENT_NODE,en=Node.TEXT_NODE,eo=core.PositionFilter.FilterResult.FILTER_ACCEPT,er=core.PositionFilter.FilterResult.FILTER_REJECT;this.acceptPosition=function(_){var ei,es,el,eu=_.container(),ec=eu.nodeType;if(ec!==et&&ec!==en)return er;if(ec===en){if(ec=_.unfilteredDomOffset(),ei=eu.data,runtime.assert(ec!==ei.length,"Unexpected offset."),0<ec){if(_=ei[ec-1],!ee.isODFWhitespace(_))return eo;if(1<ec){if(_=ei[ec-2],ee.isODFWhitespace(_)){if(!ee.isODFWhitespace(ei.substr(0,ec)))return er}else el=eo}else es=ee.previousNode(eu),ee.scanLeftForNonSpace(es)&&(el=eo);return el===eo?ee.isTrailingWhitespace(eu,ec)?er:eo:(_=ei[ec],ee.isODFWhitespace(_)?er:ee.scanLeftForAnyCharacter(ee.previousNode(eu))?er:eo)}es=_.leftNode(),el=eu,el=$(eu=eu.parentNode,es,el,_.getNodeFilter())}else el=ee.isGroupingElement(eu)?$(eu,es=_.leftNode(),el=_.rightNode(),_.getNodeFilter()):er;return el}},ops.OdtDocument=function(_){function $(_){return new core.PositionIterator(_,eN,ew,!1)}function ee(){var $=_.odfContainer().getContentElement(),ee=$&&$.localName;return runtime.assert("text"===ee,"Unsupported content element type '"+ee+"' for OdtDocument"),$}function et(){return em.getDocumentElement().ownerDocument}function en(_){for(;_&&!(_.namespaceURI===odf.Namespaces.officens&&"text"===_.localName||_.namespaceURI===odf.Namespaces.officens&&"annotation"===_.localName);)_=_.parentNode;return _}function eo(_,ee,et,en){var eo;return en=$(en),1===et.length?eo=et[0]:(eo=new core.PositionFilterChain,et.forEach(eo.addFilter)),(et=new core.StepIterator(eo,en)).setPosition(_,ee),et}function er(_){var et=$(ee());return _=ef.convertStepsToDomPoint(_),et.setUnfilteredPosition(_.node,_.offset),et}function ei(_){return _===eS}function es($){var ee=$.spec(),et=ee.memberid,en=new Date(ee.timestamp).toISOString(),ee=_.odfContainer();$.isEdit&&(et=em.getMember(et).getProperties().fullName,ee.setMetadata({"dc:creator":et,"dc:date":en},null),et={setProperties:{"dc:creator":et,"dc:date":en},removedProperties:[]},ep||(et.setProperties["meta:editing-cycles"]=ee.incrementEditingCycles(),ee.setMetadata(null,["meta:editing-duration","meta:document-statistic"])),ep=$,em.emit(ops.OdtDocument.signalMetadataUpdated,et))}function el(_){var $,ee,et=[],en=2;runtime.assert(_.isStep(),"positionIterator is not at a step");do{if(($=ec.getContentBounds(_))&&($=$.container,eh.isDowngradableSpaceElement($))){for(ee=$.lastChild;$.firstChild;)et.push($.firstChild),$.parentNode.insertBefore($.firstChild,$);$.parentNode.removeChild($),_.setPosition(ee,ee.nodeType===Node.TEXT_NODE?ee.length:ee.childNodes.length),_.roundToPreviousStep()}--en}while(0<en&&_.nextStep());et.forEach(eg.normalizeTextNodes)}function eu(_,$,ee){return _=_.childNodes.item($)||_,(_=eh.getParagraphElement(_))&&eg.containsNode(ee,_)?_:ee}var ec,ed,ef,ep,em=this,eh=odf.OdfUtils,eg=core.DomUtils,eb={},ey={},ev=new core.EventNotifier([ops.Document.signalMemberAdded,ops.Document.signalMemberUpdated,ops.Document.signalMemberRemoved,ops.Document.signalCursorAdded,ops.Document.signalCursorRemoved,ops.Document.signalCursorMoved,ops.OdtDocument.signalParagraphChanged,ops.OdtDocument.signalParagraphStyleModified,ops.OdtDocument.signalCommonStyleCreated,ops.OdtDocument.signalCommonStyleDeleted,ops.OdtDocument.signalTableAdded,ops.OdtDocument.signalOperationStart,ops.OdtDocument.signalOperationEnd,ops.OdtDocument.signalProcessingBatchStart,ops.OdtDocument.signalProcessingBatchEnd,ops.OdtDocument.signalUndoStackChanged,ops.OdtDocument.signalStepsInserted,ops.OdtDocument.signalStepsRemoved,ops.OdtDocument.signalMetadataUpdated,ops.OdtDocument.signalAnnotationAdded]),eS=core.StepDirection.NEXT,eN=NodeFilter.SHOW_ALL,eC=new gui.BlacklistNamespaceNodeFilter(["urn:webodf:names:cursor","urn:webodf:names:editinfo"]),ex=new gui.OdfTextBodyNodeFilter,ew=new core.NodeFilterChain([eC,ex]);this.createPositionIterator=$,this.getDocumentElement=function(){return _.odfContainer().rootElement},this.cloneDocumentElement=function(){var $=em.getDocumentElement(),ee=_.getAnnotationViewManager();return ee&&ee.forgetAnnotations(),$=$.cloneNode(!0),_.refreshAnnotations(),em.fixCursorPositions(),$},this.setDocumentElement=function(et){var en=_.odfContainer();ev.unsubscribe(ops.OdtDocument.signalStepsInserted,ef.handleStepsInserted),ev.unsubscribe(ops.OdtDocument.signalStepsRemoved,ef.handleStepsRemoved),en.setRootElement(et),_.setOdfContainer(en,!0),_.refreshCSS(),et=ee(),ef=new ops.OdtStepsTranslator(et,$(et),ed,500),ev.subscribe(ops.OdtDocument.signalStepsInserted,ef.handleStepsInserted),ev.subscribe(ops.OdtDocument.signalStepsRemoved,ef.handleStepsRemoved)},this.getDOMDocument=et,this.getRootElement=en,this.createStepIterator=eo,this.getIteratorAtPosition=er,this.convertCursorStepToDomPoint=function(_){return ef.convertStepsToDomPoint(_)},this.convertDomPointToCursorStep=function(_,$,ee){var et;return ee===eS&&(et=ei),ef.convertDomPointToSteps(_,$,et)},this.convertDomToCursorRange=function(_){var $;return $=ef.convertDomPointToSteps(_.anchorNode,_.anchorOffset),_=_.anchorNode===_.focusNode&&_.anchorOffset===_.focusOffset?$:ef.convertDomPointToSteps(_.focusNode,_.focusOffset),{position:$,length:_-$}},this.convertCursorToDomRange=function(_,$){var ee,en,eo=et().createRange();return ee=ef.convertStepsToDomPoint(_),$?(en=ef.convertStepsToDomPoint(_+$),0<$?(eo.setStart(ee.node,ee.offset),eo.setEnd(en.node,en.offset)):(eo.setStart(en.node,en.offset),eo.setEnd(ee.node,ee.offset))):eo.setStart(ee.node,ee.offset),eo},this.upgradeWhitespacesAtPosition=function(_){var $,ee=er(_),ee=new core.StepIterator(ed,ee),et=2;runtime.assert(ee.isStep(),"positionIterator is not at a step (requested step: "+_+")");do{if(($=ec.getContentBounds(ee))&&(_=$.container,$=$.startOffset,_.nodeType===Node.TEXT_NODE&&eh.isSignificantWhitespace(_,$))){runtime.assert(" "===_.data[$],"upgradeWhitespaceToElement: textNode.data[offset] should be a literal space");var en=_.ownerDocument.createElementNS(odf.Namespaces.textns,"text:s"),eo=_.parentNode,ei=_;en.appendChild(_.ownerDocument.createTextNode(" ")),1===_.length?eo.replaceChild(en,_):(_.deleteData($,1),0<$&&($<_.length&&_.splitText($),ei=_.nextSibling),eo.insertBefore(en,ei)),_=en,ee.setPosition(_,_.childNodes.length),ee.roundToPreviousStep()}--et}while(0<et&&ee.nextStep())},this.downgradeWhitespaces=el,this.downgradeWhitespacesAtPosition=function(_){_=er(_),el(_=new core.StepIterator(ed,_))},this.getTextNodeAtStep=function(_,$){var ee,en=er(_),eo=en.container(),ei=0,es=null;if(eo.nodeType===Node.TEXT_NODE?(ee=eo,ei=en.unfilteredDomOffset(),0<ee.length&&(0<ei&&(ee=ee.splitText(ei)),ee.parentNode.insertBefore(et().createTextNode(""),ee),ee=ee.previousSibling,ei=0)):(ee=et().createTextNode(""),ei=0,eo.insertBefore(ee,en.rightNode())),$){if(eb[$]&&em.getCursorPosition($)===_){for(es=eb[$].getNode();es.nextSibling&&"cursor"===es.nextSibling.localName;)es.parentNode.insertBefore(es.nextSibling,es);0<ee.length&&ee.nextSibling!==es&&(ee=et().createTextNode(""),ei=0),es.parentNode.insertBefore(ee,es)}}else for(;ee.nextSibling&&"cursor"===ee.nextSibling.localName;)ee.parentNode.insertBefore(ee.nextSibling,ee);for(;ee.previousSibling&&ee.previousSibling.nodeType===Node.TEXT_NODE;)(en=ee.previousSibling).appendData(ee.data),ei=en.length,(ee=en).parentNode.removeChild(ee.nextSibling);for(;ee.nextSibling&&ee.nextSibling.nodeType===Node.TEXT_NODE;)en=ee.nextSibling,ee.appendData(en.data),ee.parentNode.removeChild(en);return{textNode:ee,offset:ei}},this.fixCursorPositions=function(){Object.keys(eb).forEach(function(_){var $,ee,et,er=eb[_],ei=en(er.getNode()),es=em.createRootFilter(ei),el=!1;$=eu((et=er.getSelectedRange()).startContainer,et.startOffset,ei),ee=eo(et.startContainer,et.startOffset,[ed,es],$),et.collapsed?ei=ee:($=eu(et.endContainer,et.endOffset,ei),ei=eo(et.endContainer,et.endOffset,[ed,es],$)),ee.isStep()&&ei.isStep()?ee.container()!==ei.container()||ee.offset()!==ei.offset()||et.collapsed&&er.getAnchorNode()===er.getNode()||(el=!0,et.setStart(ee.container(),ee.offset()),et.collapse(!0)):(el=!0,runtime.assert(ee.roundToClosestStep(),"No walkable step found for cursor owned by "+_),et.setStart(ee.container(),ee.offset()),runtime.assert(ei.roundToClosestStep(),"No walkable step found for cursor owned by "+_),et.setEnd(ei.container(),ei.offset())),el&&(er.setSelectedRange(et,er.hasForwardSelection()),em.emit(ops.Document.signalCursorMoved,er))})},this.getCursorPosition=function(_){return(_=eb[_])?ef.convertDomPointToSteps(_.getNode(),0):0},this.getCursorSelection=function(_){_=eb[_];var $=0,ee=0;return _&&($=ef.convertDomPointToSteps(_.getNode(),0),ee=ef.convertDomPointToSteps(_.getAnchorNode(),0)),{position:ee,length:$-ee}},this.getPositionFilter=function(){return ed},this.getOdfCanvas=function(){return _},this.getCanvas=function(){return _},this.getRootNode=ee,this.addMember=function(_){runtime.assert(void 0===ey[_.getMemberId()],"This member already exists"),ey[_.getMemberId()]=_},this.getMember=function(_){return ey.hasOwnProperty(_)?ey[_]:null},this.removeMember=function(_){delete ey[_]},this.getCursor=function(_){return eb[_]},this.hasCursor=function(_){return eb.hasOwnProperty(_)},this.getMemberIds=function(){return Object.keys(ey)},this.addCursor=function(_){runtime.assert(!!_,"OdtDocument::addCursor without cursor");var $=_.getMemberId(),ee=em.convertCursorToDomRange(0,0);runtime.assert("string"==typeof $,"OdtDocument::addCursor has cursor without memberid"),runtime.assert(!eb[$],"OdtDocument::addCursor is adding a duplicate cursor with memberid "+$),_.setSelectedRange(ee,!0),eb[$]=_},this.removeCursor=function(_){var $=eb[_];return!!$&&($.removeFromDocument(),delete eb[_],em.emit(ops.Document.signalCursorRemoved,_),!0)},this.moveCursor=function(_,$,ee,et){_=eb[_],$=em.convertCursorToDomRange($,ee),_&&(_.setSelectedRange($,0<=ee),_.setSelectionType(et||ops.OdtCursor.RangeSelection))},this.getFormatting=function(){return _.getFormatting()},this.emit=function(_,$){ev.emit(_,$)},this.subscribe=function(_,$){ev.subscribe(_,$)},this.unsubscribe=function(_,$){ev.unsubscribe(_,$)},this.createRootFilter=function(_){return new RootFilter(_,eb,en)},this.close=function(_){_()},this.destroy=function(_){_()},function(){var _=ee();ed=new ops.TextPositionFilter,ec=new odf.StepUtils,ef=new ops.OdtStepsTranslator(_,$(_),ed,500),ev.subscribe(ops.OdtDocument.signalStepsInserted,ef.handleStepsInserted),ev.subscribe(ops.OdtDocument.signalStepsRemoved,ef.handleStepsRemoved),ev.subscribe(ops.OdtDocument.signalOperationEnd,es),ev.subscribe(ops.OdtDocument.signalProcessingBatchEnd,core.Task.processTasks)}()},ops.OdtDocument.signalParagraphChanged="paragraph/changed",ops.OdtDocument.signalTableAdded="table/added",ops.OdtDocument.signalCommonStyleCreated="style/created",ops.OdtDocument.signalCommonStyleDeleted="style/deleted",ops.OdtDocument.signalParagraphStyleModified="paragraphstyle/modified",ops.OdtDocument.signalOperationStart="operation/start",ops.OdtDocument.signalOperationEnd="operation/end",ops.OdtDocument.signalProcessingBatchStart="router/batchstart",ops.OdtDocument.signalProcessingBatchEnd="router/batchend",ops.OdtDocument.signalUndoStackChanged="undo/changed",ops.OdtDocument.signalStepsInserted="steps/inserted",ops.OdtDocument.signalStepsRemoved="steps/removed",ops.OdtDocument.signalMetadataUpdated="metadata/updated",ops.OdtDocument.signalAnnotationAdded="annotation/added",ops.OpAddAnnotation=function(){var _,$,ee,et,en,eo;function er($,ee,et){var en=$.getTextNodeAtStep(et,_);en&&(et=($=en.textNode).parentNode,en.offset!==$.length&&$.splitText(en.offset),et.insertBefore(ee,$.nextSibling),0===$.length&&et.removeChild($))}this.init=function(eo){_=eo.memberid,$=parseInt(eo.timestamp,10),ee=parseInt(eo.position,10),et=void 0!==eo.length?parseInt(eo.length,10)||0:void 0,en=eo.name},this.isEdit=!0,this.group=void 0,this.execute=function(ei){var es,el,eu=ei.getCursor(_);eo=ei.getDOMDocument();var ec,ed,ef,ep=new Date($);return(ec=eo.createElementNS(odf.Namespaces.officens,"office:annotation")).setAttributeNS(odf.Namespaces.officens,"office:name",en),(es=eo.createElementNS(odf.Namespaces.dcns,"dc:creator")).setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",_),es.textContent=ei.getMember(_).getProperties().fullName,(el=eo.createElementNS(odf.Namespaces.dcns,"dc:date")).appendChild(eo.createTextNode(ep.toISOString())),ep=eo.createElementNS(odf.Namespaces.textns,"text:list"),ed=eo.createElementNS(odf.Namespaces.textns,"text:list-item"),ef=eo.createElementNS(odf.Namespaces.textns,"text:p"),ed.appendChild(ef),ep.appendChild(ed),ec.appendChild(es),ec.appendChild(el),ec.appendChild(ep),void 0!==et&&((es=eo.createElementNS(odf.Namespaces.officens,"office:annotation-end")).setAttributeNS(odf.Namespaces.officens,"office:name",en),ec.annotationEndElement=es,er(ei,es,ee+et)),er(ei,ec,ee),ei.emit(ops.OdtDocument.signalStepsInserted,{position:ee}),eu&&(es=eo.createRange(),el=ec.getElementsByTagNameNS(odf.Namespaces.textns,"p")[0],es.selectNodeContents(el),eu.setSelectedRange(es,!1),eu.setSelectionType(ops.OdtCursor.RangeSelection),ei.emit(ops.Document.signalCursorMoved,eu)),ei.getOdfCanvas().addAnnotation(ec),ei.fixCursorPositions(),ei.emit(ops.OdtDocument.signalAnnotationAdded,{memberId:_,annotation:ec}),!0},this.spec=function(){return{optype:"AddAnnotation",memberid:_,timestamp:$,position:ee,length:et,name:en}}},ops.OpAddCursor=function(){var _,$;this.init=function(ee){_=ee.memberid,$=ee.timestamp},this.isEdit=!1,this.group=void 0,this.execute=function($){var ee=$.getCursor(_);return!ee&&(ee=new ops.OdtCursor(_,$),$.addCursor(ee),$.emit(ops.Document.signalCursorAdded,ee),!0)},this.spec=function(){return{optype:"AddCursor",memberid:_,timestamp:$}}},ops.OpAddMember=function(){var _,$,ee;this.init=function(et){_=et.memberid,$=parseInt(et.timestamp,10),ee=et.setProperties},this.isEdit=!1,this.group=void 0,this.execute=function($){var et;return!$.getMember(_)&&(et=new ops.Member(_,ee),$.addMember(et),$.emit(ops.Document.signalMemberAdded,et),!0)},this.spec=function(){return{optype:"AddMember",memberid:_,timestamp:$,setProperties:ee}}},ops.OpAddStyle=function(){var _,$,ee,et,en,eo,er=odf.Namespaces.stylens;this.init=function(er){_=er.memberid,$=er.timestamp,ee=er.styleName,et=er.styleFamily,en="true"===er.isAutomaticStyle||!0===er.isAutomaticStyle,eo=er.setProperties},this.isEdit=!0,this.group=void 0,this.execute=function(_){var $=_.getOdfCanvas().odfContainer(),ei=_.getFormatting(),es=_.getDOMDocument().createElementNS(er,"style:style");return!!es&&(eo&&ei.updateStyle(es,eo),es.setAttributeNS(er,"style:family",et),es.setAttributeNS(er,"style:name",ee),en?$.rootElement.automaticStyles.appendChild(es):$.rootElement.styles.appendChild(es),_.getOdfCanvas().refreshCSS(),en||_.emit(ops.OdtDocument.signalCommonStyleCreated,{name:ee,family:et}),!0)},this.spec=function(){return{optype:"AddStyle",memberid:_,timestamp:$,styleName:ee,styleFamily:et,isAutomaticStyle:en,setProperties:eo}}},odf.ObjectNameGenerator=function(_,$){function ee(_,$){var ee={};this.generateName=function(){var et,en=$(),eo=0;do et=_+eo,eo+=1;while(ee[et]||en[et]);return ee[et]=!0,et}}function et(){var $={};return[_.rootElement.automaticStyles,_.rootElement.styles].forEach(function(_){for(_=_.firstElementChild;_;)_.namespaceURI===en&&"style"===_.localName&&($[_.getAttributeNS(en,"name")]=!0),_=_.nextElementSibling}),$}var en=odf.Namespaces.stylens,eo=odf.Namespaces.drawns,er=odf.Namespaces.xlinkns,ei=(new core.Utils).hashString($),es=null,el=null,eu=null,ec={},ed={};this.generateStyleName=function(){return null===es&&(es=new ee("auto"+ei+"_",function(){return et()})),es.generateName()},this.generateFrameName=function(){var $,et;if(null===el){for($=0,et=_.rootElement.body.getElementsByTagNameNS(eo,"frame");$<et.length;$+=1)ec[et.item($).getAttributeNS(eo,"name")]=!0;el=new ee("fr"+ei+"_",function(){return ec})}return el.generateName()},this.generateImageName=function(){var $,et,en;if(null===eu){for($=0,en=_.rootElement.body.getElementsByTagNameNS(eo,"image");$<en.length;$+=1)ed[et=(et=(et=en.item($)).getAttributeNS(er,"href")).substring(9,et.lastIndexOf("."))]=!0;eu=new ee("img"+ei+"_",function(){return ed})}return eu.generateName()}},odf.TextStyleApplicator=function(_,$,ee){function et(_){function ee(_,$){return"object"==typeof _&&"object"==typeof $?Object.keys(_).every(function(et){return ee(_[et],$[et])}):_===$}var et={};this.isStyleApplied=function(en){return ee(_,en=$.getAppliedStylesForElement(en,et).styleProperties)}}function en(et){var en={};this.applyStyleToContainer=function(eo){el=eo.getAttributeNS(ei,"style-name");var er=eo.ownerDocument;if(el=el||"",!en.hasOwnProperty(el)){var el,eu,ec=el;eu=el?$.createDerivedStyleObject(el,"text",et):et,er=er.createElementNS(es,"style:style"),$.updateStyle(er,eu),er.setAttributeNS(es,"style:name",_.generateStyleName()),er.setAttributeNS(es,"style:family","text"),er.setAttributeNS("urn:webodf:names:scope","scope","document-content"),ee.appendChild(er),en[ec]=er}el=en[el].getAttributeNS(es,"name"),eo.setAttributeNS(ei,"text:style-name",el)}}function eo(_,$){var ee,et,en,eo=_.ownerDocument,es=_.parentNode,el=new core.LoopWatchDog(1e4);for((et=[]).push(_),en=_.nextSibling;en&&er.rangeContainsNode($,en);)el.check(),et.push(en),en=en.nextSibling;if("span"!==es.localName||es.namespaceURI!==ei?(ee=eo.createElementNS(ei,"text:span"),es.insertBefore(ee,_),eo=!1):(_.previousSibling&&!er.rangeContainsNode($,es.firstChild)?(ee=es.cloneNode(!1),es.parentNode.insertBefore(ee,es.nextSibling)):ee=es,eo=!0),et.forEach(function(_){_.parentNode!==ee&&ee.appendChild(_)}),en&&eo)for(et=ee.cloneNode(!1),ee.parentNode.insertBefore(et,ee.nextSibling);en;)el.check(),eo=en.nextSibling,et.appendChild(en),en=eo;return ee}var er=core.DomUtils,ei=odf.Namespaces.textns,es=odf.Namespaces.stylens;this.applyStyle=function(_,$,ee){var er,ei,es,el={};runtime.assert(ee&&ee.hasOwnProperty("style:text-properties"),"applyStyle without any text properties"),el["style:text-properties"]=ee["style:text-properties"],ei=new en(el),es=new et(el),_.forEach(function(_){!1===es.isStyleApplied(_)&&(er=eo(_,$),ei.applyStyleToContainer(er))})}},ops.OpApplyDirectStyling=function(){function _(_,ee,et){var en=_.getOdfCanvas().odfContainer(),eo=ei.splitBoundaries(ee),es=er.getTextNodes(ee,!1);new odf.TextStyleApplicator(new odf.ObjectNameGenerator(en,$),_.getFormatting(),en.rootElement.automaticStyles).applyStyle(es,ee,et),eo.forEach(ei.normalizeTextNodes)}var $,ee,et,en,eo,er=odf.OdfUtils,ei=core.DomUtils;this.init=function(_){$=_.memberid,ee=_.timestamp,et=parseInt(_.position,10),en=parseInt(_.length,10),eo=_.setProperties},this.isEdit=!0,this.group=void 0,this.execute=function(ei){var es=ei.convertCursorToDomRange(et,en),el=er.getParagraphElements(es);return _(ei,es,eo),es.detach(),ei.getOdfCanvas().refreshCSS(),ei.fixCursorPositions(),el.forEach(function(_){ei.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:_,memberId:$,timeStamp:ee})}),ei.getOdfCanvas().rerenderAnnotations(),!0},this.spec=function(){return{optype:"ApplyDirectStyling",memberid:$,timestamp:ee,position:et,length:en,setProperties:eo}}},ops.OpApplyHyperlink=function(){function _(_){for(;_;){if(ei.isHyperlink(_))return!0;_=_.parentNode}return!1}var $,ee,et,en,eo,er=core.DomUtils,ei=odf.OdfUtils;this.init=function(_){$=_.memberid,ee=_.timestamp,et=_.position,en=_.length,eo=_.hyperlink},this.isEdit=!0,this.group=void 0,this.execute=function(es){var el=es.getDOMDocument(),eu=es.convertCursorToDomRange(et,en),ec=er.splitBoundaries(eu),ed=[],ef=ei.getTextNodes(eu,!1);return 0!==ef.length&&(ef.forEach(function($){var ee=ei.getParagraphElement($);runtime.assert(!1===_($),"The given range should not contain any link.");var et=eo,en=el.createElementNS(odf.Namespaces.textns,"text:a");en.setAttributeNS(odf.Namespaces.xlinkns,"xlink:type","simple"),en.setAttributeNS(odf.Namespaces.xlinkns,"xlink:href",et),$.parentNode.insertBefore(en,$),en.appendChild($),-1===ed.indexOf(ee)&&ed.push(ee)}),ec.forEach(er.normalizeTextNodes),eu.detach(),es.fixCursorPositions(),es.getOdfCanvas().refreshSize(),es.getOdfCanvas().rerenderAnnotations(),ed.forEach(function(_){es.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:_,memberId:$,timeStamp:ee})}),!0)},this.spec=function(){return{optype:"ApplyHyperlink",memberid:$,timestamp:ee,position:et,length:en,hyperlink:eo}}},ops.OpInsertImage=function(){var _,$,ee,et,en,eo,er,ei,es=odf.Namespaces.drawns,el=odf.Namespaces.svgns,eu=odf.Namespaces.textns,ec=odf.Namespaces.xlinkns,ed=odf.OdfUtils;this.init=function(es){_=es.memberid,$=es.timestamp,ee=es.position,et=es.filename,en=es.frameWidth,eo=es.frameHeight,er=es.frameStyleName,ei=es.frameName},this.isEdit=!0,this.group=void 0,this.execute=function(ef){var ep,em,eh=ef.getOdfCanvas(),eg=ef.getTextNodeAtStep(ee,_);if(!eg)return!1;ep=eg.textNode,em=ed.getParagraphElement(ep);var eg=eg.offset!==ep.length?ep.splitText(eg.offset):ep.nextSibling,eb=ef.getDOMDocument(),ey=eb.createElementNS(es,"draw:image"),eb=eb.createElementNS(es,"draw:frame");return ey.setAttributeNS(ec,"xlink:href",et),ey.setAttributeNS(ec,"xlink:type","simple"),ey.setAttributeNS(ec,"xlink:show","embed"),ey.setAttributeNS(ec,"xlink:actuate","onLoad"),eb.setAttributeNS(es,"draw:style-name",er),eb.setAttributeNS(es,"draw:name",ei),eb.setAttributeNS(eu,"text:anchor-type","as-char"),eb.setAttributeNS(el,"svg:width",en),eb.setAttributeNS(el,"svg:height",eo),eb.appendChild(ey),ep.parentNode.insertBefore(eb,eg),ef.emit(ops.OdtDocument.signalStepsInserted,{position:ee}),0===ep.length&&ep.parentNode.removeChild(ep),eh.addCssForFrameWithImage(eb),eh.refreshCSS(),ef.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:em,memberId:_,timeStamp:$}),eh.rerenderAnnotations(),!0},this.spec=function(){return{optype:"InsertImage",memberid:_,timestamp:$,filename:et,position:ee,frameWidth:en,frameHeight:eo,frameStyleName:er,frameName:ei}}},ops.OpInsertTable=function(){function _(_,$){var ee;if(1===el.length)ee=el[0];else if(3===el.length)switch(_){case 0:ee=el[0];break;case et-1:ee=el[2];break;default:ee=el[1]}else ee=el[_];if(1===ee.length)return ee[0];if(3===ee.length)switch($){case 0:return ee[0];case en-1:return ee[2];default:return ee[1]}return ee[$]}var $,ee,et,en,eo,er,ei,es,el,eu=odf.OdfUtils;this.init=function(_){$=_.memberid,ee=_.timestamp,eo=_.position,et=_.initialRows,en=_.initialColumns,er=_.tableName,ei=_.tableStyleName,es=_.tableColumnStyleName,el=_.tableCellStyleMatrix},this.isEdit=!0,this.group=void 0,this.execute=function(el){var ec=el.getTextNodeAtStep(eo),ed=el.getRootNode();if(ec){var ef,ep,em,eh,eg=el.getDOMDocument(),eb=eg.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table"),ey=eg.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-column");for(ei&&eb.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",ei),er&&eb.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:name",er),ey.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:number-columns-repeated",en),es&&ey.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",es),eb.appendChild(ey),em=0;em<et;em+=1){for(eh=0,ey=eg.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-row");eh<en;eh+=1)ef=eg.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-cell"),(ep=_(em,eh))&&ef.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",ep),ep=eg.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:p"),ef.appendChild(ep),ey.appendChild(ef);eb.appendChild(ey)}return ec=eu.getParagraphElement(ec.textNode),ed.insertBefore(eb,ec.nextSibling),el.emit(ops.OdtDocument.signalStepsInserted,{position:eo}),el.getOdfCanvas().refreshSize(),el.emit(ops.OdtDocument.signalTableAdded,{tableElement:eb,memberId:$,timeStamp:ee}),el.getOdfCanvas().rerenderAnnotations(),!0}return!1},this.spec=function(){return{optype:"InsertTable",memberid:$,timestamp:ee,position:eo,initialRows:et,initialColumns:en,tableName:er,tableStyleName:ei,tableColumnStyleName:es,tableCellStyleMatrix:el}}},ops.OpInsertText=function(){function _(_){return"	"!==_&&er.isODFWhitespace(_)}var $,ee,et,en,eo,er=odf.OdfUtils;this.init=function(_){$=_.memberid,ee=_.timestamp,et=_.position,eo=_.text,en="true"===_.moveCursor||!0===_.moveCursor},this.isEdit=!0,this.group=void 0,this.execute=function(ei){var es,el,eu,ec,ed,ef,ep=null,em=ei.getDOMDocument(),eh=0,eg=ei.getCursor($);if(ei.upgradeWhitespacesAtPosition(et),es=ei.getTextNodeAtStep(et)){for(ef=0,ep=(el=es.textNode).nextSibling,eu=el.parentNode,ec=er.getParagraphElement(el);ef<eo.length;ef+=1){if(!(ed="	"===eo[ef])){var eb=ef;ed=_((ed=eo)[eb])&&(0===eb||eb===ed.length-1||_(ed[eb-1]))}ed&&(0===eh?(es.offset!==el.length&&(ep=el.splitText(es.offset)),0<ef&&el.appendData(eo.substring(0,ef))):eh<ef&&(eh=eo.substring(eh,ef),eu.insertBefore(em.createTextNode(eh),ep)),eh=ef+1,"	"===eo[ef]?(ed=em.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:tab")).appendChild(em.createTextNode("	")):(" "!==eo[ef]&&runtime.log("WARN: InsertText operation contains non-tab, non-space whitespace character (character code "+eo.charCodeAt(ef)+")"),(ed=em.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:s")).appendChild(em.createTextNode(" "))),eu.insertBefore(ed,ep))}return 0===eh?el.insertData(es.offset,eo):eh<eo.length&&(es=eo.substring(eh),eu.insertBefore(em.createTextNode(es),ep)),eu=el.parentNode,ep=el.nextSibling,eu.removeChild(el),eu.insertBefore(el,ep),0===el.length&&el.parentNode.removeChild(el),ei.emit(ops.OdtDocument.signalStepsInserted,{position:et}),eg&&en&&(ei.moveCursor($,et+eo.length,0),ei.emit(ops.Document.signalCursorMoved,eg)),ei.downgradeWhitespacesAtPosition(et),ei.downgradeWhitespacesAtPosition(et+eo.length),ei.getOdfCanvas().refreshSize(),ei.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:ec,memberId:$,timeStamp:ee}),ei.getOdfCanvas().rerenderAnnotations(),!0}return!1},this.spec=function(){return{optype:"InsertText",memberid:$,timestamp:ee,position:et,text:eo,moveCursor:en}}},odf.CollapsingRules=function(_){function $(_){return et.isODFNode(_)||"br"===_.localName&&et.isLineBreak(_.parentNode)||_.nodeType===Node.TEXT_NODE&&et.isODFNode(_.parentNode)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}function ee(eo){var er;return eo.nodeType===Node.TEXT_NODE?(er=eo.parentNode).removeChild(eo):er=en.removeUnwantedNodes(eo,$),(eo=er)&&(eo=er,eo=!et.isParagraph(eo)&&eo!==_&&et.hasNoODFContent(eo)),eo?ee(er):er}var et=odf.OdfUtils,en=core.DomUtils;this.mergeChildrenIntoParent=ee},ops.OpMergeParagraph=function(){function _(_){return odf.OdfUtils.isInlineRoot(_)?NodeFilter.FILTER_SKIP:eu.isGroupingElement(_)&&eu.hasNoODFContent(_)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}function $(_){if(_.nodeType===Node.TEXT_NODE){if(0===_.length)return runtime.log("WARN: Empty text node found during merge operation"),!0;if(eu.isODFWhitespace(_.data)&&!1===eu.isSignificantWhitespace(_,0))return!0;_="#text"}else _=(_.prefix?_.prefix+":":"")+_.localName;return runtime.log("WARN: Unexpected text element found near paragraph boundary ["+_+"]"),!1}function ee(_){_.collapsed||(ec.splitBoundaries(_),(_=eu.getTextElements(_,!1,!0).filter($)).forEach(function(_){_.parentNode.removeChild(_)}))}function et(_,$,ee){_=_.convertCursorStepToDomPoint($);var et=eu.getParagraphElement(_.node,_.offset);return runtime.assert(!!et,"Paragraph not found at step "+$),ee&&ee.setPosition(_.node,_.offset),et}var en,eo,er,ei,es,el,eu=odf.OdfUtils,ec=core.DomUtils,ed=odf.Namespaces.textns;this.init=function(_){en=_.memberid,eo=_.timestamp,er=_.moveCursor,ei=_.paragraphStyleName,es=parseInt(_.sourceStartPosition,10),el=parseInt(_.destinationStartPosition,10)},this.isEdit=!0,this.group=void 0,this.execute=function($){var eu,ef,ep=$.getCursor(en);eu=$.getRootNode();var em,eh=new odf.CollapsingRules(eu),eg=$.createStepIterator(eu,0,[$.getPositionFilter()],eu);runtime.assert(el<es,"Destination paragraph ("+el+") must be before source paragraph ("+es+")"),ef=et($,el),eu=et($,es,eg),eg.previousStep(),runtime.assert(ec.containsNode(ef,eg.container()),"Destination paragraph must be adjacent to the source paragraph"),em=ef.ownerDocument.createRange(),eg.setPosition(ef,ef.childNodes.length),eg.roundToPreviousStep(),em.setStart(eg.container(),eg.offset()),em.setEnd(ef,ef.childNodes.length),ee(em),em=ef.childNodes.length;var eb=eu.ownerDocument.createRange();for(eg.setPosition(eu,0),eg.roundToNextStep(),eb.setStart(eu,0),eb.setEnd(eg.container(),eg.offset()),ee(eb),eb=eu.firstChild;eb;)"editinfo"===eb.localName?eu.removeChild(eb):(ef.appendChild(eb),ec.removeUnwantedNodes(eb,_)),eb=eu.firstChild;return runtime.assert(0===eu.childNodes.length,"Source paragraph should be empty before it is removed"),eh.mergeChildrenIntoParent(eu),$.emit(ops.OdtDocument.signalStepsRemoved,{position:es-1}),eg.setPosition(ef,em),eg.roundToClosestStep(),eg.previousStep()||eg.roundToNextStep(),$.downgradeWhitespaces(eg),ei?ef.setAttributeNS(ed,"text:style-name",ei):ef.removeAttributeNS(ed,"style-name"),ep&&er&&($.moveCursor(en,es-1,0),$.emit(ops.Document.signalCursorMoved,ep)),$.fixCursorPositions(),$.getOdfCanvas().refreshSize(),$.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:ef,memberId:en,timeStamp:eo}),$.getOdfCanvas().rerenderAnnotations(),!0},this.spec=function(){return{optype:"MergeParagraph",memberid:en,timestamp:eo,moveCursor:er,paragraphStyleName:ei,sourceStartPosition:es,destinationStartPosition:el}}},ops.OpMoveCursor=function(){var _,$,ee,et,en;this.init=function(eo){_=eo.memberid,$=eo.timestamp,ee=eo.position,et=eo.length||0,en=eo.selectionType||ops.OdtCursor.RangeSelection},this.isEdit=!1,this.group=void 0,this.execute=function($){var eo,er=$.getCursor(_);return!!er&&(eo=$.convertCursorToDomRange(ee,et),er.setSelectedRange(eo,0<=et),er.setSelectionType(en),$.emit(ops.Document.signalCursorMoved,er),!0)},this.spec=function(){return{optype:"MoveCursor",memberid:_,timestamp:$,position:ee,length:et,selectionType:en}}},ops.OpRemoveAnnotation=function(){var _,$,ee,et,en=core.DomUtils;this.init=function(en){_=en.memberid,$=en.timestamp,ee=parseInt(en.position,10),et=parseInt(en.length,10)},this.isEdit=!0,this.group=void 0,this.execute=function(_){function $(_){et.parentNode.insertBefore(_,et)}for(var et,eo=_.getIteratorAtPosition(ee).container();eo.namespaceURI!==odf.Namespaces.officens||"annotation"!==eo.localName;)eo=eo.parentNode;return null!==eo&&(eo=(et=eo).annotationEndElement,_.getOdfCanvas().forgetAnnotation(et),en.getElementsByTagNameNS(et,"urn:webodf:names:cursor","cursor").forEach($),en.getElementsByTagNameNS(et,"urn:webodf:names:cursor","anchor").forEach($),et.parentNode.removeChild(et),eo&&eo.parentNode.removeChild(eo),_.emit(ops.OdtDocument.signalStepsRemoved,{position:0<ee?ee-1:ee}),_.getOdfCanvas().rerenderAnnotations(),_.fixCursorPositions(),!0)},this.spec=function(){return{optype:"RemoveAnnotation",memberid:_,timestamp:$,position:ee,length:et}}},ops.OpRemoveBlob=function(){var _,$,ee;this.init=function(et){_=et.memberid,$=et.timestamp,ee=et.filename},this.isEdit=!0,this.group=void 0,this.execute=function(_){return _.getOdfCanvas().odfContainer().removeBlob(ee),!0},this.spec=function(){return{optype:"RemoveBlob",memberid:_,timestamp:$,filename:ee}}},ops.OpRemoveCursor=function(){var _,$;this.init=function(ee){_=ee.memberid,$=ee.timestamp},this.isEdit=!1,this.group=void 0,this.execute=function($){return!!$.removeCursor(_)},this.spec=function(){return{optype:"RemoveCursor",memberid:_,timestamp:$}}},ops.OpRemoveHyperlink=function(){var _,$,ee,et,en=core.DomUtils,eo=odf.OdfUtils;this.init=function(en){_=en.memberid,$=en.timestamp,ee=en.position,et=en.length},this.isEdit=!0,this.group=void 0,this.execute=function(er){var ei=er.convertCursorToDomRange(ee,et),es=eo.getHyperlinkElements(ei);return runtime.assert(1===es.length,"The given range should only contain a single link."),es=en.mergeIntoParent(es[0]),ei.detach(),er.fixCursorPositions(),er.getOdfCanvas().refreshSize(),er.getOdfCanvas().rerenderAnnotations(),er.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:eo.getParagraphElement(es),memberId:_,timeStamp:$}),!0},this.spec=function(){return{optype:"RemoveHyperlink",memberid:_,timestamp:$,position:ee,length:et}}},ops.OpRemoveMember=function(){var _,$;this.init=function(ee){_=ee.memberid,$=parseInt(ee.timestamp,10)},this.isEdit=!1,this.group=void 0,this.execute=function($){return!!$.getMember(_)&&($.removeMember(_),$.emit(ops.Document.signalMemberRemoved,_),!0)},this.spec=function(){return{optype:"RemoveMember",memberid:_,timestamp:$}}},ops.OpRemoveStyle=function(){var _,$,ee,et;this.init=function(en){_=en.memberid,$=en.timestamp,ee=en.styleName,et=en.styleFamily},this.isEdit=!0,this.group=void 0,this.execute=function(_){var $=_.getFormatting().getStyleElement(ee,et);return!!$&&($.parentNode.removeChild($),_.getOdfCanvas().refreshCSS(),_.emit(ops.OdtDocument.signalCommonStyleDeleted,{name:ee,family:et}),!0)},this.spec=function(){return{optype:"RemoveStyle",memberid:_,timestamp:$,styleName:ee,styleFamily:et}}},ops.OpRemoveText=function(){var _,$,ee,et,en=odf.OdfUtils,eo=core.DomUtils;this.init=function(en){runtime.assert(0<=en.length,"OpRemoveText only supports positive lengths"),_=en.memberid,$=en.timestamp,ee=parseInt(en.position,10),et=parseInt(en.length,10)},this.isEdit=!0,this.group=void 0,this.execute=function(er){var ei,es,el,eu=er.getCursor(_),ec=new odf.CollapsingRules(er.getRootNode());return er.upgradeWhitespacesAtPosition(ee),er.upgradeWhitespacesAtPosition(ee+et),ei=er.convertCursorToDomRange(ee,et),eo.splitBoundaries(ei),es=en.getTextElements(ei,!1,!0),el=en.getParagraphElement(ei.startContainer,ei.startOffset),runtime.assert(void 0!==el,"Attempting to remove text outside a paragraph element"),ei.detach(),es.forEach(function(_){_.parentNode?(runtime.assert(eo.containsNode(el,_),"RemoveText only supports removing elements within the same paragraph"),ec.mergeChildrenIntoParent(_)):runtime.log("WARN: text element has already been removed from it's container")}),er.emit(ops.OdtDocument.signalStepsRemoved,{position:ee}),er.downgradeWhitespacesAtPosition(ee),er.fixCursorPositions(),er.getOdfCanvas().refreshSize(),er.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:el,memberId:_,timeStamp:$}),eu&&(eu.resetSelectionType(),er.emit(ops.Document.signalCursorMoved,eu)),er.getOdfCanvas().rerenderAnnotations(),!0},this.spec=function(){return{optype:"RemoveText",memberid:_,timestamp:$,position:ee,length:et}}},ops.OpSetBlob=function(){var _,$,ee,et,en;this.init=function(eo){_=eo.memberid,$=eo.timestamp,ee=eo.filename,et=eo.mimetype,en=eo.content},this.isEdit=!0,this.group=void 0,this.execute=function(_){return _.getOdfCanvas().odfContainer().setBlob(ee,et,en),!0},this.spec=function(){return{optype:"SetBlob",memberid:_,timestamp:$,filename:ee,mimetype:et,content:en}}},ops.OpSetParagraphStyle=function(){function _(_,$,ee){var et=[_.getPositionFilter()],en=ee.container();return ee=ee.unfilteredDomOffset(),!1===_.createStepIterator(en,ee,et,$).previousStep()}var $,ee,et,en,eo=odf.OdfUtils;this.init=function(_){$=_.memberid,ee=_.timestamp,et=_.position,en=_.styleName},this.isEdit=!0,this.group=void 0,this.execute=function(er){var ei,es;return ei=er.getIteratorAtPosition(et),!!(es=eo.getParagraphElement(ei.container()))&&(runtime.assert(_(er,es,ei),"SetParagraphStyle position should be the first position in the paragraph"),en?es.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:style-name",en):es.removeAttributeNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","style-name"),er.getOdfCanvas().refreshSize(),er.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:es,timeStamp:ee,memberId:$}),er.getOdfCanvas().rerenderAnnotations(),!0)},this.spec=function(){return{optype:"SetParagraphStyle",memberid:$,timestamp:ee,position:et,styleName:en}}},ops.OpSplitParagraph=function(){var _,$,ee,et,en,eo,er=odf.OdfUtils,ei=odf.Namespaces.textns;this.init=function(er){_=er.memberid,$=er.timestamp,et=er.position,ee=er.sourceParagraphPosition,eo=er.paragraphStyleName,en="true"===er.moveCursor||!0===er.moveCursor},this.isEdit=!0,this.group=void 0,this.execute=function(ee){var es,el,eu,ec,ed,ef,ep,em=ee.getCursor(_);if(ee.upgradeWhitespacesAtPosition(et),!(es=ee.getTextNodeAtStep(et))||!(el=er.getParagraphElement(es.textNode)))return!1;for(eu=er.isListItem(el.parentNode)?el.parentNode:el,0===es.offset?(ep=es.textNode.previousSibling,ef=null):(ep=es.textNode,ef=es.offset>=es.textNode.length?null:es.textNode.splitText(es.offset)),ec=es.textNode;ec!==eu;){if(ed=(ec=ec.parentNode).cloneNode(!1),ef&&ed.appendChild(ef),ep)for(;ep&&ep.nextSibling;)ed.appendChild(ep.nextSibling);else for(;ec.firstChild;)ed.appendChild(ec.firstChild);ec.parentNode.insertBefore(ed,ec.nextSibling),ep=ec,ef=ed}return er.isListItem(ef)&&(ef=ef.childNodes.item(0)),eo?ef.setAttributeNS(ei,"text:style-name",eo):ef.removeAttributeNS(ei,"style-name"),0===es.textNode.length&&es.textNode.parentNode.removeChild(es.textNode),ee.emit(ops.OdtDocument.signalStepsInserted,{position:et}),em&&en&&(ee.moveCursor(_,et+1,0),ee.emit(ops.Document.signalCursorMoved,em)),ee.fixCursorPositions(),ee.getOdfCanvas().refreshSize(),ee.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:el,memberId:_,timeStamp:$}),ee.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:ef,memberId:_,timeStamp:$}),ee.getOdfCanvas().rerenderAnnotations(),!0},this.spec=function(){return{optype:"SplitParagraph",memberid:_,timestamp:$,position:et,sourceParagraphPosition:ee,paragraphStyleName:eo,moveCursor:en}}},ops.OpUpdateMember=function(){var _,$,ee,et;function en($){var et="//dc:creator[@editinfo:memberid='"+_+"']";for($=xmldom.XPath.getODFElementsWithXPath($.getRootNode(),et,function(_){return"editinfo"===_?"urn:webodf:names:editinfo":odf.Namespaces.lookupNamespaceURI(_)}),et=0;et<$.length;et+=1)$[et].textContent=ee.fullName}this.init=function(en){_=en.memberid,$=parseInt(en.timestamp,10),ee=en.setProperties,et=en.removedProperties},this.isEdit=!1,this.group=void 0,this.execute=function($){var eo=$.getMember(_);return!!eo&&(et&&eo.removeProperties(et),ee&&(eo.setProperties(ee),ee.fullName&&en($)),$.emit(ops.Document.signalMemberUpdated,eo),!0)},this.spec=function(){return{optype:"UpdateMember",memberid:_,timestamp:$,setProperties:ee,removedProperties:et}}},ops.OpUpdateMetadata=function(){var _,$,ee,et;this.init=function(en){_=en.memberid,$=parseInt(en.timestamp,10),ee=en.setProperties,et=en.removedProperties},this.isEdit=!0,this.group=void 0,this.execute=function(_){var $=_.getOdfCanvas().odfContainer(),en=null;return et&&(en=et.attributes.split(",")),$.setMetadata(ee,en),_.emit(ops.OdtDocument.signalMetadataUpdated,{setProperties:null!==ee?ee:{},removedProperties:null!==en?en:[]}),!0},this.spec=function(){return{optype:"UpdateMetadata",memberid:_,timestamp:$,setProperties:ee,removedProperties:et}}},ops.OpUpdateParagraphStyle=function(){function _(_,$){var ee,et,en=$?$.split(","):[];for(ee=0;ee<en.length;ee+=1)et=en[ee].split(":"),_.removeAttributeNS(odf.Namespaces.lookupNamespaceURI(et[0]),et[1])}var $,ee,et,en,eo,er=odf.Namespaces.stylens;this.init=function(_){$=_.memberid,ee=_.timestamp,et=_.styleName,en=_.setProperties,eo=_.removedProperties},this.isEdit=!0,this.group=void 0,this.execute=function($){var ee,ei,es,el=$.getFormatting();return!!(ee=""!==et?el.getStyleElement(et,"paragraph"):el.getDefaultStyleElement("paragraph"))&&(ei=ee.getElementsByTagNameNS(er,"paragraph-properties").item(0),es=ee.getElementsByTagNameNS(er,"text-properties").item(0),en&&el.updateStyle(ee,en),eo&&(el=eo["style:paragraph-properties"],ei&&el&&(_(ei,el.attributes),0===ei.attributes.length&&ee.removeChild(ei)),el=eo["style:text-properties"],es&&el&&(_(es,el.attributes),0===es.attributes.length&&ee.removeChild(es)),_(ee,eo.attributes)),$.getOdfCanvas().refreshCSS(),$.emit(ops.OdtDocument.signalParagraphStyleModified,et),$.getOdfCanvas().rerenderAnnotations(),!0)},this.spec=function(){return{optype:"UpdateParagraphStyle",memberid:$,timestamp:ee,styleName:et,setProperties:en,removedProperties:eo}}},ops.OperationFactory=function(){var _;function $(_){return function($){return new _}}this.register=function($,ee){_[$]=ee},this.create=function($){var ee=null,et=_[$.optype];return et&&(ee=et($)).init($),ee},_={AddMember:$(ops.OpAddMember),UpdateMember:$(ops.OpUpdateMember),RemoveMember:$(ops.OpRemoveMember),AddCursor:$(ops.OpAddCursor),ApplyDirectStyling:$(ops.OpApplyDirectStyling),SetBlob:$(ops.OpSetBlob),RemoveBlob:$(ops.OpRemoveBlob),InsertImage:$(ops.OpInsertImage),InsertTable:$(ops.OpInsertTable),InsertText:$(ops.OpInsertText),RemoveText:$(ops.OpRemoveText),MergeParagraph:$(ops.OpMergeParagraph),SplitParagraph:$(ops.OpSplitParagraph),SetParagraphStyle:$(ops.OpSetParagraphStyle),UpdateParagraphStyle:$(ops.OpUpdateParagraphStyle),AddStyle:$(ops.OpAddStyle),RemoveStyle:$(ops.OpRemoveStyle),MoveCursor:$(ops.OpMoveCursor),RemoveCursor:$(ops.OpRemoveCursor),AddAnnotation:$(ops.OpAddAnnotation),RemoveAnnotation:$(ops.OpRemoveAnnotation),UpdateMetadata:$(ops.OpUpdateMetadata),ApplyHyperlink:$(ops.OpApplyHyperlink),RemoveHyperlink:$(ops.OpRemoveHyperlink)}},ops.OperationRouter=function(){},ops.OperationRouter.prototype.setOperationFactory=function(_){},ops.OperationRouter.prototype.setPlaybackFunction=function(_){},ops.OperationRouter.prototype.push=function(_){},ops.OperationRouter.prototype.close=function(_){},ops.OperationRouter.prototype.subscribe=function(_,$){},ops.OperationRouter.prototype.unsubscribe=function(_,$){},ops.OperationRouter.prototype.hasLocalUnsyncedOps=function(){},ops.OperationRouter.prototype.hasSessionHostConnection=function(){},ops.OperationRouter.signalProcessingBatchStart="router/batchstart",ops.OperationRouter.signalProcessingBatchEnd="router/batchend",ops.TrivialOperationRouter=function(){var _,$,ee=new core.EventNotifier([ops.OperationRouter.signalProcessingBatchStart,ops.OperationRouter.signalProcessingBatchEnd]),et=0;this.setOperationFactory=function($){_=$},this.setPlaybackFunction=function(_){$=_},this.push=function(en){et+=1,ee.emit(ops.OperationRouter.signalProcessingBatchStart,{}),en.forEach(function(ee){(ee=ee.spec()).timestamp=Date.now(),(ee=_.create(ee)).group="g"+et,$(ee)}),ee.emit(ops.OperationRouter.signalProcessingBatchEnd,{})},this.close=function(_){_()},this.subscribe=function(_,$){ee.subscribe(_,$)},this.unsubscribe=function(_,$){ee.unsubscribe(_,$)},this.hasLocalUnsyncedOps=function(){return!1},this.hasSessionHostConnection=function(){return!0}},ops.Session=function(_){function $(_){en.emit(ops.OdtDocument.signalProcessingBatchStart,_)}function ee(_){en.emit(ops.OdtDocument.signalProcessingBatchEnd,_)}var et=new ops.OperationFactory,en=new ops.OdtDocument(_),eo=null;this.setOperationFactory=function(_){et=_,eo&&eo.setOperationFactory(et)},this.setOperationRouter=function(_){eo&&(eo.unsubscribe(ops.OperationRouter.signalProcessingBatchStart,$),eo.unsubscribe(ops.OperationRouter.signalProcessingBatchEnd,ee)),(eo=_).subscribe(ops.OperationRouter.signalProcessingBatchStart,$),eo.subscribe(ops.OperationRouter.signalProcessingBatchEnd,ee),_.setPlaybackFunction(function(_){return en.emit(ops.OdtDocument.signalOperationStart,_),!!_.execute(en)&&(en.emit(ops.OdtDocument.signalOperationEnd,_),!0)}),_.setOperationFactory(et)},this.getOperationFactory=function(){return et},this.getOdtDocument=function(){return en},this.enqueue=function(_){eo.push(_)},this.close=function(_){eo.close(function($){$?_($):en.close(_)})},this.destroy=function(_){en.destroy(_)},this.setOperationRouter(new ops.TrivialOperationRouter)},gui.AnnotationController=function(_,$,ee){function et(){var _=ei.getCursor(ee),_=_&&_.getNode(),$=!1;_&&($=!eu.isWithinAnnotation(_,ei.getRootNode())),$!==es&&(es=$,el.emit(gui.AnnotationController.annotatableChanged,es))}function en(_){_.getMemberId()===ee&&et()}function eo(_){_===ee&&et()}function er(_){_.getMemberId()===ee&&et()}var ei=_.getOdtDocument(),es=!1,el=new core.EventNotifier([gui.AnnotationController.annotatableChanged]),eu=odf.OdfUtils,ec=core.StepDirection.NEXT;this.isAnnotatable=function(){return es},this.addAnnotation=function(){var $=new ops.OpAddAnnotation,et=ei.getCursorSelection(ee),en=et.length,et=et.position;es&&(0===en?en=void 0:(et=0<=en?et:et+en,en=Math.abs(en)),$.init({memberid:ee,position:et,length:en,name:ee+Date.now()}),_.enqueue([$]))},this.removeAnnotation=function(et){var en,eo;en=ei.getMember(ee).getProperties().fullName,(!0!==$.getState(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN)||en===eu.getAnnotationCreator(et))&&(en=ei.convertDomPointToCursorStep(et,0,ec),eo=ei.convertDomPointToCursorStep(et,et.childNodes.length),(et=new ops.OpRemoveAnnotation).init({memberid:ee,position:en,length:eo-en}),(eo=new ops.OpMoveCursor).init({memberid:ee,position:0<en?en-1:en,length:0}),_.enqueue([et,eo]))},this.subscribe=function(_,$){el.subscribe(_,$)},this.unsubscribe=function(_,$){el.unsubscribe(_,$)},this.destroy=function(_){ei.unsubscribe(ops.Document.signalCursorAdded,en),ei.unsubscribe(ops.Document.signalCursorRemoved,eo),ei.unsubscribe(ops.Document.signalCursorMoved,er),_()},$.registerConstraint(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN),ei.subscribe(ops.Document.signalCursorAdded,en),ei.subscribe(ops.Document.signalCursorRemoved,eo),ei.subscribe(ops.Document.signalCursorMoved,er),et()},gui.AnnotationController.annotatableChanged="annotatable/changed",gui.Avatar=function(_,$){var ee,et,en,eo=this;this.setColor=function(_){et.style.borderColor=_},this.setImageUrl=function(_){eo.isVisible()?et.src=_:en=_},this.isVisible=function(){return"block"===ee.style.display},this.show=function(){en&&(et.src=en,en=void 0),ee.style.display="block"},this.hide=function(){ee.style.display="none"},this.markAsFocussed=function(_){_?ee.classList.add("active"):ee.classList.remove("active")},this.destroy=function($){_.removeChild(ee),$()},function(){var en=_.ownerDocument;ee=en.createElement("div"),et=en.createElement("img"),ee.appendChild(et),ee.style.display=$?"block":"none",ee.className="handle",_.appendChild(ee)}()},gui.StepInfo=function(){},gui.StepInfo.VisualDirection={LEFT_TO_RIGHT:0,RIGHT_TO_LEFT:1},gui.StepInfo.prototype.container=function(){},gui.StepInfo.prototype.offset=function(){},gui.VisualStepScanner=function(){},gui.VisualStepScanner.prototype.process=function(_,$,ee){},gui.GuiStepUtils=function(){function _(_){_=ee.getContentBounds(_);var en,eo=null;return _&&(_.container.nodeType===Node.TEXT_NODE?((en=_.container.ownerDocument.createRange()).setStart(_.container,_.startOffset),en.setEnd(_.container,_.endOffset),(eo=0<en.getClientRects().length?en.getBoundingClientRect():null)&&" "===_.container.data.substring(_.startOffset,_.endOffset)&&1>=eo.width&&(eo=null),en.detach()):($.isCharacterElement(_.container)||$.isCharacterFrame(_.container))&&(eo=et.getBoundingClientRect(_.container))),eo}var $=odf.OdfUtils,ee=new odf.StepUtils,et=core.DomUtils,en=core.StepDirection.NEXT,eo=gui.StepInfo.VisualDirection.LEFT_TO_RIGHT,er=gui.StepInfo.VisualDirection.RIGHT_TO_LEFT;this.getContentRect=_,this.moveToFilteredStep=function($,ee,et){function ei(_,$){return $.process(es,ec,ed)&&(_=!0,!ef&&$.token&&(ef=$.token)),_}var es,el,eu,ec,ed,ef,ep=ee===en,em=$.snapshot();el=!1;do el=_($),es={token:$.snapshot(),container:$.container,offset:$.offset,direction:ee,visualDirection:ee===en?eo:er},eu=$.nextStep()?_($):null,$.restore(es.token),ep?(ec=el,ed=eu):(ec=eu,ed=el),el=et.reduce(ei,!1);while(!el&&$.advanceStep(ee));return el||et.forEach(function(_){!ef&&_.token&&(ef=_.token)}),$.restore(ef||em),!!ef}},gui.Caret=function(_,$,ee,et){function en(){ec.style.opacity="0"===ec.style.opacity?"1":"0",eb.trigger()}function eo(){return em.selectNodeContents(ep),em.getBoundingClientRect()}function er(_){return eE[_]!==ew[_]}function ei(){Object.keys(ew).forEach(function(_){eE[_]=ew[_]})}function es(){if(!1!==ew.isShown&&_.getSelectionType()===ops.OdtCursor.RangeSelection&&(et||_.getSelectedRange().collapsed)?(ew.visibility="visible",ec.style.visibility="visible",!1===ew.isFocused)?(ec.style.opacity="1",eb.cancel()):((eN||er("visibility"))&&(ec.style.opacity="1",eb.cancel()),eb.trigger()):(ew.visibility="hidden",ec.style.visibility="hidden",eb.cancel()),ex||eC){ee=_.getNode();var ee,en,es,el=ev.getBoundingClientRect(ey.getSizer()),ep=!1,em=0;if(ee.removeAttributeNS("urn:webodf:names:cursor","caret-sizer-active"),0<ee.getClientRects().length)em=(es=eo()).left-ev.getBoundingClientRect(ee).left,ep=!0;else if(eh.setPosition(ee,0),!(es=eS.getContentRect(eh))&&eh.nextStep()&&(en=eS.getContentRect(eh))&&(es=en,ep=!0),es||(ee.setAttributeNS("urn:webodf:names:cursor","caret-sizer-active","true"),es=eo(),ep=!0),!es)for(runtime.log("WARN: No suitable client rectangle found for visual caret for "+_.getMemberId());ee;){if(0<ee.getClientRects().length){es=ev.getBoundingClientRect(ee),ep=!0;break}ee=ee.parentNode}8>(ee={top:(es=ev.translateRect(es,el,ey.getZoomLevel())).top,height:es.height,right:ep?es.left:es.right,width:ev.adaptRangeDifferenceToZoomLevel(em,ey.getZoomLevel())}).height&&(ee={top:ee.top-(8-ee.height)/2,height:8,right:ee.right}),eu.style.height=ee.height+"px",eu.style.top=ee.top+"px",eu.style.left=ee.right-ee.width+"px",eu.style.width=ee.width?ee.width+"px":"",ef&&((ee=runtime.getWindow().getComputedStyle(_.getNode(),null)).font?ef.style.font=ee.font:(ef.style.fontStyle=ee.fontStyle,ef.style.fontVariant=ee.fontVariant,ef.style.fontWeight=ee.fontWeight,ef.style.fontSize=ee.fontSize,ef.style.lineHeight=ee.lineHeight,ef.style.fontFamily=ee.fontFamily))}ew.isShown&&eC&&$.scrollIntoView(ec.getBoundingClientRect()),er("isFocused")&&ed.markAsFocussed(ew.isFocused),ei(),ex=eC=eN=!1}function el(_){eu.parentNode.removeChild(eu),ep.parentNode.removeChild(ep),_()}var eu,ec,ed,ef,ep,em,eh,eg,eb,ey=_.getDocument().getCanvas(),ev=core.DomUtils,eS=new gui.GuiStepUtils,eN=!1,eC=!1,ex=!1,ew={isFocused:!1,isShown:!0,visibility:"hidden"},eE={isFocused:!ew.isFocused,isShown:!ew.isShown,visibility:"hidden"};this.handleUpdate=function(){ex=!0,eg.trigger()},this.refreshCursorBlinking=function(){eN=!0,eg.trigger()},this.setFocus=function(){ew.isFocused=!0,eg.trigger()},this.removeFocus=function(){ew.isFocused=!1,eg.trigger()},this.show=function(){ew.isShown=!0,eg.trigger()},this.hide=function(){ew.isShown=!1,eg.trigger()},this.setAvatarImageUrl=function(_){ed.setImageUrl(_)},this.setColor=function(_){ec.style.borderColor=_,ed.setColor(_)},this.getCursor=function(){return _},this.getFocusElement=function(){return ec},this.toggleHandleVisibility=function(){ed.isVisible()?ed.hide():ed.show()},this.showHandle=function(){ed.show()},this.hideHandle=function(){ed.hide()},this.setOverlayElement=function(_){ef=_,eu.appendChild(_),ex=!0,eg.trigger()},this.ensureVisible=function(){eC=!0,eg.trigger()},this.getBoundingClientRect=function(){return ev.getBoundingClientRect(eu)},this.destroy=function(_){core.Async.destroyAll([eg.destroy,eb.destroy,ed.destroy,el],_)},function(){var $=_.getDocument(),et=[$.createRootFilter(_.getMemberId()),$.getPositionFilter()],eo=$.getDOMDocument();em=eo.createRange(),(ep=eo.createElement("span")).className="webodf-caretSizer",ep.textContent="|",_.getNode().appendChild(ep),(eu=eo.createElement("div")).setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",_.getMemberId()),eu.className="webodf-caretOverlay",(ec=eo.createElement("div")).className="caret",eu.appendChild(ec),ed=new gui.Avatar(eu,ee),ey.getSizer().appendChild(eu),eh=$.createStepIterator(_.getNode(),0,et,$.getRootNode()),eg=core.Task.createRedrawTask(es),eb=core.Task.createTimeoutTask(en,500),eg.triggerImmediate()}()},odf.TextSerializer=function(){function _(et){var en,eo="",er=$.filter?$.filter.acceptNode(et):NodeFilter.FILTER_ACCEPT,ei=et.nodeType;if((er===NodeFilter.FILTER_ACCEPT||er===NodeFilter.FILTER_SKIP)&&ee.isTextContentContainingNode(et))for(en=et.firstChild;en;)eo+=_(en),en=en.nextSibling;return er===NodeFilter.FILTER_ACCEPT&&(ei===Node.ELEMENT_NODE&&ee.isParagraph(et)?eo+="\n":ei===Node.TEXT_NODE&&et.textContent&&(eo+=et.textContent)),eo}var $=this,ee=odf.OdfUtils;this.filter=null,this.writeToString=function($){return $?("\n"===($=_($))[$.length-1]&&($=$.substr(0,$.length-1)),$):""}},gui.MimeDataExporter=function(){var _;this.exportRangeToDataTransfer=function($,ee){var et;(et=ee.startContainer.ownerDocument.createElement("span")).appendChild(ee.cloneContents()),et=_.writeToString(et);try{$.setData("text/plain",et)}catch(_){$.setData("Text",et)}},(_=new odf.TextSerializer).filter=new odf.OdfNodeFilter},gui.Clipboard=function(_){this.setDataFromRange=function($,ee){var et,en=$.clipboardData;return et=runtime.getWindow(),!en&&et&&(en=et.clipboardData),en?(et=!0,_.exportRangeToDataTransfer(en,ee),$.preventDefault()):et=!1,et}},gui.SessionContext=function(_,$){var ee=_.getOdtDocument(),et=odf.OdfUtils;this.isLocalCursorWithinOwnAnnotation=function(){var _,en=ee.getCursor($);return!!en&&(_=en&&en.getNode(),en=ee.getMember($).getProperties().fullName,!!(_=et.getParentAnnotation(_,ee.getRootNode()))&&et.getAnnotationCreator(_)===en)}},gui.StyleSummary=function(_){function $($,ee){var et,eo=$+"|"+ee;return en.hasOwnProperty(eo)||(et=[],_.forEach(function(_){_=(_=_.styleProperties[$])&&_[ee],-1===et.indexOf(_)&&et.push(_)}),en[eo]=et),en[eo]}function ee(_,ee,et){return function(){var en=$(_,ee);return et.length>=en.length&&en.every(function(_){return -1!==et.indexOf(_)})}}function et(_,ee){var et=$(_,ee);return 1===et.length?et[0]:void 0}var en={};this.getPropertyValues=$,this.getCommonValue=et,this.isBold=ee("style:text-properties","fo:font-weight",["bold"]),this.isItalic=ee("style:text-properties","fo:font-style",["italic"]),this.hasUnderline=ee("style:text-properties","style:text-underline-style",["solid"]),this.hasStrikeThrough=ee("style:text-properties","style:text-line-through-style",["solid"]),this.fontSize=function(){var _=et("style:text-properties","fo:font-size");return _&&parseFloat(_)},this.fontName=function(){return et("style:text-properties","style:font-name")},this.isAlignedLeft=ee("style:paragraph-properties","fo:text-align",["left","start"]),this.isAlignedCenter=ee("style:paragraph-properties","fo:text-align",["center"]),this.isAlignedRight=ee("style:paragraph-properties","fo:text-align",["right","end"]),this.isAlignedJustified=ee("style:paragraph-properties","fo:text-align",["justify"]),this.text={isBold:this.isBold,isItalic:this.isItalic,hasUnderline:this.hasUnderline,hasStrikeThrough:this.hasStrikeThrough,fontSize:this.fontSize,fontName:this.fontName},this.paragraph={isAlignedLeft:this.isAlignedLeft,isAlignedCenter:this.isAlignedCenter,isAlignedRight:this.isAlignedRight,isAlignedJustified:this.isAlignedJustified}},gui.DirectFormattingController=function(_,$,ee,et,en,eo,er){function ei(){return ek.value().styleSummary}function es(){return ek.value().enabledFeatures}function el(_){var $;return _.collapsed?(($=_.startContainer).hasChildNodes()&&_.startOffset<$.childNodes.length&&($=$.childNodes.item(_.startOffset)),_=[$]):_=eB.getTextElements(_,!0,!1),_}function eu(){var _=eF.getCursor(et),en=_&&_.getSelectedRange(),eo=[],er=!0,ei={directTextStyling:!0,directParagraphStyling:!0};return en&&(0===(eo=el(en)).length&&(eo=[en.startContainer,en.endContainer],er=!1),eo=eF.getFormatting().getAppliedStyles(eo)),void 0!==eo[0]&&eH&&(eo[0].styleProperties=eM.mergeObjects(eo[0].styleProperties,eH)),!0===$.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)&&(ei.directTextStyling=ei.directParagraphStyling=ee.isLocalCursorWithinOwnAnnotation()),ei.directTextStyling&&(ei.directTextStyling=er&&void 0!==_&&_.getSelectionType()===ops.OdtCursor.RangeSelection),{enabledFeatures:ei,appliedStyles:eo,styleSummary:new gui.StyleSummary(eo)}}function ec(_,$){var ee={};return Object.keys(_).forEach(function(et){var en=_[et](),eo=$[et]();en!==eo&&(ee[et]=eo)}),ee}function ed(){$=e_.styleSummary;var _,$,ee=ek.value(),et=ee.styleSummary,en=e_.enabledFeatures,eo=ee.enabledFeatures;_=ec($.text,et.text),$=ec($.paragraph,et.paragraph),en=!(eo.directTextStyling===en.directTextStyling&&eo.directParagraphStyling===en.directParagraphStyling),e_=ee,en&&eU.emit(gui.DirectFormattingController.enabledChanged,eo),0<Object.keys(_).length&&eU.emit(gui.DirectFormattingController.textStylingChanged,_),0<Object.keys($).length&&eU.emit(gui.DirectFormattingController.paragraphStylingChanged,$)}function ef(){ek.reset(),ed()}function ep(_){("string"==typeof _?_:_.getMemberId())===et&&ek.reset()}function em(){ek.reset()}function eh(_){var $=eF.getCursor(et);_=_.paragraphElement,$&&eB.getParagraphElement($.getNode())===_&&ek.reset()}function eg(_,$){return $(!_()),!0}function eb($){if(es().directTextStyling){var ee=eF.getCursorSelection(et),en={"style:text-properties":$};0!==ee.length?(($=new ops.OpApplyDirectStyling).init({memberid:et,position:ee.position,length:ee.length,setProperties:en}),_.enqueue([$])):(eH=eM.mergeObjects(eH||{},en),ek.reset())}}function ey(_,$){var ee={};ee[_]=$,eb(ee)}function ev(_){_=_.spec(),eH&&_.memberid===et&&"SplitParagraph"!==_.optype&&(eH=null,ek.reset())}function eS(_){ey("fo:font-weight",_?"bold":"normal")}function eN(_){ey("fo:font-style",_?"italic":"normal")}function eC(_){ey("style:text-underline-style",_?"solid":"none")}function ex(_){ey("style:text-line-through-style",_?"solid":"none")}function ew($){if(es().directParagraphStyling){var ee,eo=eF.getCursor(et).getSelectedRange(),eo=eB.getParagraphElements(eo),er=eF.getFormatting(),ei=[],el={};eo.forEach(function(_){var eo,es=eF.convertDomPointToCursorStep(_,0,ez),eu=_.getAttributeNS(odf.Namespaces.textns,"style-name");(_=eu?el.hasOwnProperty(eu)?el[eu]:void 0:ee)||(_=en.generateStyleName(),eu?(el[eu]=_,eo=er.createDerivedStyleObject(eu,"paragraph",{})):(ee=_,eo={}),eo=$(eo),(eu=new ops.OpAddStyle).init({memberid:et,styleName:_.toString(),styleFamily:"paragraph",isAutomaticStyle:!0,setProperties:eo}),ei.push(eu)),(eu=new ops.OpSetParagraphStyle).init({memberid:et,styleName:_.toString(),position:es}),ei.push(eu)}),_.enqueue(ei)}}function eE(_){ew(function($){return eM.mergeObjects($,_)})}function eT(_){eE({"style:paragraph-properties":{"fo:text-align":_}})}function eO(_,$){var ee,et=eF.getFormatting().getDefaultTabStopDistance(),en=$["style:paragraph-properties"];return en&&(en=en["fo:margin-left"],ee=eB.parseLength(en)),eM.mergeObjects($,{"style:paragraph-properties":{"fo:margin-left":ee&&ee.unit===et.unit?ee.value+_*et.value+ee.unit:_*et.value+et.unit}})}function eA(_,$){var ee=el(_),ee=0===ee.length?[_.startContainer]:ee,ee=eF.getFormatting().getAppliedStyles(ee),et=0<ee.length?ee[0].styleProperties:void 0,en=eF.getFormatting().getAppliedStylesForElement($).styleProperties;return!!et&&"text"===et["style:family"]&&!!et["style:text-properties"]&&(!en||!en["style:text-properties"]||(et=et["style:text-properties"],en=en["style:text-properties"],!Object.keys(et).every(function(_){return et[_]===en[_]})))}function eR(){}function eP(){return!1}function eD(){return!1}var e_,ek,eI=this,eF=_.getOdtDocument(),eM=new core.Utils,eB=odf.OdfUtils,eU=new core.EventNotifier([gui.DirectFormattingController.enabledChanged,gui.DirectFormattingController.textStylingChanged,gui.DirectFormattingController.paragraphStylingChanged]),eL=odf.Namespaces.textns,ez=core.StepDirection.NEXT,eH=null;this.enabledFeatures=es,this.formatTextSelection=eb,this.createCursorStyleOp=function(_,$,ee){var en=null,eo=eH;return ee&&(eo=(ee=ek.value().appliedStyles[0])&&ee.styleProperties),eo&&eo["style:text-properties"]&&((en=new ops.OpApplyDirectStyling).init({memberid:et,position:_,length:$,setProperties:{"style:text-properties":eo["style:text-properties"]}}),eH=null,ek.reset()),en},this.setBold=eS,this.setItalic=eN,this.setHasUnderline=eC,this.setHasStrikethrough=ex,this.setFontSize=function(_){ey("fo:font-size",_+"pt")},this.setFontName=function(_){ey("style:font-name",_)},this.getAppliedStyles=function(){return ek.value().appliedStyles},this.toggleBold=eg.bind(eI,function(){return ei().isBold()},eS),this.toggleItalic=eg.bind(eI,function(){return ei().isItalic()},eN),this.toggleUnderline=eg.bind(eI,function(){return ei().hasUnderline()},eC),this.toggleStrikethrough=eg.bind(eI,function(){return ei().hasStrikeThrough()},ex),this.isBold=function(){return ei().isBold()},this.isItalic=function(){return ei().isItalic()},this.hasUnderline=function(){return ei().hasUnderline()},this.hasStrikeThrough=function(){return ei().hasStrikeThrough()},this.fontSize=function(){return ei().fontSize()},this.fontName=function(){return ei().fontName()},this.isAlignedLeft=function(){return ei().isAlignedLeft()},this.isAlignedCenter=function(){return ei().isAlignedCenter()},this.isAlignedRight=function(){return ei().isAlignedRight()},this.isAlignedJustified=function(){return ei().isAlignedJustified()},this.alignParagraphLeft=function(){return eT("left"),!0},this.alignParagraphCenter=function(){return eT("center"),!0},this.alignParagraphRight=function(){return eT("right"),!0},this.alignParagraphJustified=function(){return eT("justify"),!0},this.indent=function(){return ew(eO.bind(null,1)),!0},this.outdent=function(){return ew(eO.bind(null,-1)),!0},this.createParagraphStyleOps=function(_){if(!es().directParagraphStyling)return[];var $,ee,eo=eF.getCursor(et),er=eo.getSelectedRange(),ei=[];eo.hasForwardSelection()?($=eo.getAnchorNode(),ee=eo.getNode()):($=eo.getNode(),ee=eo.getAnchorNode()),eo=eB.getParagraphElement(ee),runtime.assert(!!eo,"DirectFormattingController: Cursor outside paragraph");var el=eo,eu=[eF.getPositionFilter(),eF.createRootFilter(et)];return!1!==eF.createStepIterator(er.endContainer,er.endOffset,eu,el).nextStep()||(ee!==$&&(eo=eB.getParagraphElement($)),(eH||eA(er,eo))&&(er=(er=ek.value().appliedStyles[0])&&er.styleProperties)&&((eo=eo.getAttributeNS(eL,"style-name"))&&(er={"style:text-properties":er["style:text-properties"]},er=eF.getFormatting().createDerivedStyleObject(eo,"paragraph",er)),$=en.generateStyleName(),(eo=new ops.OpAddStyle).init({memberid:et,styleName:$,styleFamily:"paragraph",isAutomaticStyle:!0,setProperties:er}),ei.push(eo),(eo=new ops.OpSetParagraphStyle).init({memberid:et,styleName:$,position:_}),ei.push(eo))),ei},this.subscribe=function(_,$){eU.subscribe(_,$)},this.unsubscribe=function(_,$){eU.unsubscribe(_,$)},this.destroy=function(_){eF.unsubscribe(ops.Document.signalCursorAdded,ep),eF.unsubscribe(ops.Document.signalCursorRemoved,ep),eF.unsubscribe(ops.Document.signalCursorMoved,ep),eF.unsubscribe(ops.OdtDocument.signalParagraphStyleModified,em),eF.unsubscribe(ops.OdtDocument.signalParagraphChanged,eh),eF.unsubscribe(ops.OdtDocument.signalOperationEnd,ev),eF.unsubscribe(ops.OdtDocument.signalProcessingBatchEnd,ed),$.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,ef),_()},function(){eF.subscribe(ops.Document.signalCursorAdded,ep),eF.subscribe(ops.Document.signalCursorRemoved,ep),eF.subscribe(ops.Document.signalCursorMoved,ep),eF.subscribe(ops.OdtDocument.signalParagraphStyleModified,em),eF.subscribe(ops.OdtDocument.signalParagraphChanged,eh),eF.subscribe(ops.OdtDocument.signalOperationEnd,ev),eF.subscribe(ops.OdtDocument.signalProcessingBatchEnd,ed),$.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,ef),e_=(ek=new core.LazyProperty(eu)).value(),eo||(eI.formatTextSelection=eR,eI.setBold=eR,eI.setItalic=eR,eI.setHasUnderline=eR,eI.setHasStrikethrough=eR,eI.setFontSize=eR,eI.setFontName=eR,eI.toggleBold=eD,eI.toggleItalic=eD,eI.toggleUnderline=eD,eI.toggleStrikethrough=eD),er||(eI.alignParagraphCenter=eP,eI.alignParagraphJustified=eP,eI.alignParagraphLeft=eP,eI.alignParagraphRight=eP,eI.createParagraphStyleOps=function(){return[]},eI.indent=eP,eI.outdent=eP)}()},gui.DirectFormattingController.enabledChanged="enabled/changed",gui.DirectFormattingController.textStylingChanged="textStyling/changed",gui.DirectFormattingController.paragraphStylingChanged="paragraphStyling/changed",gui.DirectFormattingController.SelectionInfo=function(){},gui.KeyboardHandler=function(){function _(_,ee){switch(ee||(ee=$.None),_){case gui.KeyboardHandler.KeyCode.LeftMeta:case gui.KeyboardHandler.KeyCode.RightMeta:case gui.KeyboardHandler.KeyCode.MetaInMozilla:ee|=$.Meta;break;case gui.KeyboardHandler.KeyCode.Ctrl:ee|=$.Ctrl;break;case gui.KeyboardHandler.KeyCode.Alt:ee|=$.Alt;break;case gui.KeyboardHandler.KeyCode.Shift:ee|=$.Shift}return _+":"+ee}var $=gui.KeyboardHandler.Modifier,ee=null,et={};this.setDefault=function(_){ee=_},this.bind=function($,ee,en,eo){$=_($,ee),runtime.assert(eo||!1===et.hasOwnProperty($),"tried to overwrite the callback handler of key combo: "+$),et[$]=en},this.unbind=function($,ee){var en=_($,ee);delete et[en]},this.reset=function(){ee=null,et={}},this.handleEvent=function(en){var eo=en.keyCode,er=$.None;en.metaKey&&(er|=$.Meta),en.ctrlKey&&(er|=$.Ctrl),en.altKey&&(er|=$.Alt),en.shiftKey&&(er|=$.Shift),eo=et[eo=_(eo,er)],er=!1,eo?er=eo():null!==ee&&(er=ee(en)),er&&(en.preventDefault?en.preventDefault():en.returnValue=!1)}},gui.KeyboardHandler.Modifier={None:0,Meta:1,Ctrl:2,Alt:4,CtrlAlt:6,Shift:8,MetaShift:9,CtrlShift:10,AltShift:12},gui.KeyboardHandler.KeyCode={Backspace:8,Tab:9,Clear:12,Enter:13,Shift:16,Ctrl:17,Alt:18,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Delete:46,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,LeftMeta:91,RightMeta:93,MetaInMozilla:224},gui.HyperlinkClickHandler=function(_,$,ee){function et(){var $=_();runtime.assert(!!$.classList,"Document container has no classList element"),$.classList.remove("webodf-inactiveLinks")}function en(){var $=_();runtime.assert(!!$.classList,"Document container has no classList element"),$.classList.add("webodf-inactiveLinks")}function eo(){ec.removeEventListener("focus",en,!1),ef.forEach(function(_){$.unbind(_.keyCode,_.modifier),ee.unbind(_.keyCode,_.modifier)}),ef.length=0}function er(_){if(eo(),_!==ei.None){switch(ec.addEventListener("focus",en,!1),_){case ei.Ctrl:ef.push({keyCode:es.Ctrl,modifier:ei.None});break;case ei.Meta:ef.push({keyCode:es.LeftMeta,modifier:ei.None}),ef.push({keyCode:es.RightMeta,modifier:ei.None}),ef.push({keyCode:es.MetaInMozilla,modifier:ei.None})}ef.forEach(function(_){$.bind(_.keyCode,_.modifier,et),ee.bind(_.keyCode,_.modifier,en)})}}var ei=gui.KeyboardHandler.Modifier,es=gui.KeyboardHandler.KeyCode,el=xmldom.XPath,eu=odf.OdfUtils,ec=runtime.getWindow(),ed=ei.None,ef=[];runtime.assert(null!==ec,"Expected to be run in an environment which has a global window, like a browser."),this.handleClick=function($){var ee,et,en=$.target||$.srcElement;if($.ctrlKey?ee=ei.Ctrl:$.metaKey&&(ee=ei.Meta),ed===ei.None||ed===ee){e:{for(;null!==en;){if(eu.isHyperlink(en))break e;if(eu.isParagraph(en))break;en=en.parentNode}en=null}en&&""!==(en=eu.getHyperlinkTarget(en))&&("#"===en[0]?(en=en.substring(1),ee=_(),0===(et=el.getODFElementsWithXPath(ee,"//text:bookmark-start[@text:name='"+en+"']",odf.Namespaces.lookupNamespaceURI)).length&&(et=el.getODFElementsWithXPath(ee,"//text:bookmark[@text:name='"+en+"']",odf.Namespaces.lookupNamespaceURI)),0<et.length&&et[0].scrollIntoView(!0)):/^\s*(javascript|data):/.test(en)?runtime.log("WARN:","potentially malicious URL ignored"):ec.open(en),$.preventDefault?$.preventDefault():$.returnValue=!1)}},this.setModifier=function(_){ed!==_&&(runtime.assert(_===ei.None||_===ei.Ctrl||_===ei.Meta,"Unsupported KeyboardHandler.Modifier value: "+_),(ed=_)!==ei.None?en():et(),er(ed))},this.getModifier=function(){return ed},this.destroy=function(_){en(),eo(),_()}},gui.EventManager=function(_){function $(_){function $(_,$,ee){var et,en=!1;et="on"+$,_.attachEvent&&(_.attachEvent(et,ee),en=!0),!en&&_.addEventListener&&(_.addEventListener($,ee,!1),en=!0),(!en||eS[$])&&_.hasOwnProperty(et)&&(_[et]=ee)}function ee(_,$,ee){var et="on"+$;_.detachEvent&&_.detachEvent(et,ee),_.removeEventListener&&_.removeEventListener($,ee,!1),_[et]===ee&&(_[et]=null)}function et($){if(-1===eo.indexOf($)){if(eo.push($),en.filters.every(function(_){return _($)}))try{er.emit(_,$)}catch($){runtime.log("Error occurred while processing "+_+":\n"+$.message+"\n"+$.stack)}runtime.setTimeout(function(){eo.splice(eo.indexOf($),1)},0)}}var en=this,eo=[],er=new core.EventNotifier([_]);this.filters=[],this.subscribe=function($){er.subscribe(_,$)},this.unsubscribe=function($){er.unsubscribe(_,$)},this.destroy=function(){ee(ev,_,et),ee(ey,_,et),ee(ew,_,et)},eN[_]&&$(ev,_,et),$(ey,_,et),$(ew,_,et)}function ee(_,$,ee){function et($){ee($,en,function($){$.type=_,eo.emit(_,$)})}var en={},eo=new core.EventNotifier([_]);this.subscribe=function($){eo.subscribe(_,$)},this.unsubscribe=function($){eo.unsubscribe(_,$)},this.destroy=function(){$.forEach(function(_){eE.unsubscribe(_,et)})},function(){$.forEach(function(_){eE.subscribe(_,et)})}()}function et(_){runtime.clearTimeout(_),delete eT[_]}function en(_,$){var ee=runtime.setTimeout(function(){_(),et(ee)},$);return eT[ee]=!0,ee}function eo(_,$,ee){var eo=_.touches.length,er=_.touches[0],ei=$.timer;"touchmove"===_.type||"touchend"===_.type?ei&&et(ei):"touchstart"===_.type&&(1!==eo?runtime.clearTimeout(ei):ei=en(function(){ee({clientX:er.clientX,clientY:er.clientY,pageX:er.pageX,pageY:er.pageY,target:_.target||_.srcElement||null,detail:1})},400)),$.timer=ei}function er(_,$,ee){var et=_.touches[0],en=_.target||_.srcElement||null,eo=$.target;1!==_.touches.length||"touchend"===_.type?eo=null:"touchstart"===_.type&&"webodf-draggable"===en.getAttribute("class")?eo=en:"touchmove"===_.type&&eo&&(_.preventDefault(),_.stopPropagation(),ee({clientX:et.clientX,clientY:et.clientY,pageX:et.pageX,pageY:et.pageY,target:eo,detail:1})),$.target=eo}function ei(_,$,ee){var et=_.target||_.srcElement||null,en=$.dragging;"drag"===_.type?en=!0:"touchend"===_.type&&en&&(en=!1,ee({clientX:(_=_.changedTouches[0]).clientX,clientY:_.clientY,pageX:_.pageX,pageY:_.pageY,target:et,detail:1})),$.dragging=en}function es(){ew.classList.add("webodf-touchEnabled"),eE.unsubscribe("touchstart",es)}function el(_){var $=_.scrollX,ee=_.scrollY;this.restore=function(){_.scrollX===$&&_.scrollY===ee||_.scrollTo($,ee)}}function eu(_){var $=_.scrollTop,ee=_.scrollLeft;this.restore=function(){(_.scrollTop!==$||_.scrollLeft!==ee)&&(_.scrollTop=$,_.scrollLeft=ee)}}function ec(_,ee){var et=ex[_]||eC[_]||null;return!et&&ee&&(et=ex[_]=new $(_)),et}function ed(_,$){ec(_,!0).subscribe($)}function ef(_,$){var ee=ec(_,!1);ee&&ee.unsubscribe($)}function ep(){return _.getDOMDocument().activeElement===ey}function em(){ep()&&ey.blur(),ey.setAttribute("disabled","true")}function eh(){ey.removeAttribute("disabled")}function eg(_){for(var $=[];_;)(_.scrollWidth>_.clientWidth||_.scrollHeight>_.clientHeight)&&$.push(new eu(_)),_=_.parentNode;return $.push(new el(ev)),$}function eb(){var _;ep()||(_=eg(ey),eh(),ey.focus(),_.forEach(function(_){_.restore()}))}var ey,ev=runtime.getWindow(),eS={beforecut:!0,beforepaste:!0,longpress:!0,drag:!0,dragstop:!0},eN={mousedown:!0,mouseup:!0,focus:!0},eC={},ex={},ew=_.getCanvas().getElement(),eE=this,eT={};this.addFilter=function(_,$){ec(_,!0).filters.push($)},this.removeFilter=function(_,$){var ee=ec(_,!0),et=ee.filters.indexOf($);-1!==et&&ee.filters.splice(et,1)},this.subscribe=ed,this.unsubscribe=ef,this.hasFocus=ep,this.focus=eb,this.getEventTrap=function(){return ey},this.setEditing=function(_){var $=ep();$&&ey.blur(),_?ey.removeAttribute("readOnly"):ey.setAttribute("readOnly","true"),$&&eb()},this.destroy=function(_){ef("touchstart",es),Object.keys(eT).forEach(function(_){et(parseInt(_,10))}),eT.length=0,Object.keys(eC).forEach(function(_){eC[_].destroy()}),eC={},ef("mousedown",em),ef("mouseup",eh),ef("contextmenu",eh),Object.keys(ex).forEach(function(_){ex[_].destroy()}),ex={},ey.parentNode.removeChild(ey),_()},function(){var $=_.getOdfCanvas().getSizer(),et=$.ownerDocument;runtime.assert(!!ev,"EventManager requires a window object to operate correctly"),(ey=et.createElement("textarea")).id="eventTrap",ey.setAttribute("tabindex","-1"),ey.setAttribute("readOnly","true"),ey.setAttribute("rows","1"),$.appendChild(ey),ed("mousedown",em),ed("mouseup",eh),ed("contextmenu",eh),eC.longpress=new ee("longpress",["touchstart","touchmove","touchend"],eo),eC.drag=new ee("drag",["touchstart","touchmove","touchend"],er),eC.dragstop=new ee("dragstop",["drag","touchend"],ei),ed("touchstart",es)}()},gui.IOSSafariSupport=function(_){function $(){ee.innerHeight!==ee.outerHeight&&(et.style.display="none",runtime.requestAnimationFrame(function(){et.style.display="block"}))}var ee=runtime.getWindow(),et=_.getEventTrap();this.destroy=function(ee){_.unsubscribe("focus",$),et.removeAttribute("autocapitalize"),et.style.WebkitTransform="",ee()},_.subscribe("focus",$),et.setAttribute("autocapitalize","off"),et.style.WebkitTransform="translateX(-10000px)"},gui.HyperlinkController=function(_,$,ee,et){function en(){var _=!0;!0===$.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)&&(_=ee.isLocalCursorWithinOwnAnnotation()),_!==el&&(el=_,es.emit(gui.HyperlinkController.enabledChanged,el))}function eo(_){_.getMemberId()===et&&en()}var er=odf.OdfUtils,ei=_.getOdtDocument(),es=new core.EventNotifier([gui.HyperlinkController.enabledChanged]),el=!1;this.isEnabled=function(){return el},this.subscribe=function(_,$){es.subscribe(_,$)},this.unsubscribe=function(_,$){es.unsubscribe(_,$)},this.addHyperlink=function($,ee){if(el){var en=ei.getCursorSelection(et),eo=new ops.OpApplyHyperlink,er=[];(0===en.length||ee)&&(ee=ee||$,(eo=new ops.OpInsertText).init({memberid:et,position:en.position,text:ee}),en.length=ee.length,er.push(eo)),(eo=new ops.OpApplyHyperlink).init({memberid:et,position:en.position,length:en.length,hyperlink:$}),er.push(eo),_.enqueue(er)}},this.removeHyperlinks=function(){if(el){var $,ee,en=ei.createPositionIterator(ei.getRootNode()),eo=ei.getCursor(et).getSelectedRange(),es=er.getHyperlinkElements(eo),eu=eo.collapsed&&1===es.length,ec=ei.getDOMDocument().createRange(),ed=[];0!==es.length&&(es.forEach(function(_){ec.selectNodeContents(_),$=ei.convertDomToCursorRange({anchorNode:ec.startContainer,anchorOffset:ec.startOffset,focusNode:ec.endContainer,focusOffset:ec.endOffset}),(ee=new ops.OpRemoveHyperlink).init({memberid:et,position:$.position,length:$.length}),ed.push(ee)}),eu||(eu=es[0],-1===eo.comparePoint(eu,0)&&(ec.setStart(eu,0),ec.setEnd(eo.startContainer,eo.startOffset),0<($=ei.convertDomToCursorRange({anchorNode:ec.startContainer,anchorOffset:ec.startOffset,focusNode:ec.endContainer,focusOffset:ec.endOffset})).length&&((ee=new ops.OpApplyHyperlink).init({memberid:et,position:$.position,length:$.length,hyperlink:er.getHyperlinkTarget(eu)}),ed.push(ee))),es=es[es.length-1],en.moveToEndOfNode(es),en=en.unfilteredDomOffset(),1===eo.comparePoint(es,en)&&(ec.setStart(eo.endContainer,eo.endOffset),ec.setEnd(es,en),0<($=ei.convertDomToCursorRange({anchorNode:ec.startContainer,anchorOffset:ec.startOffset,focusNode:ec.endContainer,focusOffset:ec.endOffset})).length&&((ee=new ops.OpApplyHyperlink).init({memberid:et,position:$.position,length:$.length,hyperlink:er.getHyperlinkTarget(es)}),ed.push(ee)))),_.enqueue(ed),ec.detach())}},this.destroy=function(_){ei.unsubscribe(ops.Document.signalCursorMoved,eo),$.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,en),_()},ei.subscribe(ops.Document.signalCursorMoved,eo),$.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,en),en()},gui.HyperlinkController.enabledChanged="enabled/changed",gui.ImageController=function(_,$,ee,et,en){function eo(){var _=!0;!0===$.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)&&(_=ee.isLocalCursorWithinOwnAnnotation()),_!==ef&&(ef=_,ed.emit(gui.ImageController.enabledChanged,ef))}function er(_){_.getMemberId()===et&&eo()}var ei={"image/gif":".gif","image/jpeg":".jpg","image/png":".png"},es=odf.Namespaces.textns,el=_.getOdtDocument(),eu=odf.OdfUtils,ec=el.getFormatting(),ed=new core.EventNotifier([gui.HyperlinkController.enabledChanged]),ef=!1;this.isEnabled=function(){return ef},this.subscribe=function(_,$){ed.subscribe(_,$)},this.unsubscribe=function(_,$){ed.unsubscribe(_,$)},this.insertImage=function($,ee,eo,er){if(ef){var ed=new core.CSSUnits;if(runtime.assert(0<eo&&0<er,"Both width and height of the image should be greater than 0px."),er={width:eo,height:er},eo=eu.getParagraphElement(el.getCursor(et).getNode()).getAttributeNS(es,"style-name")){eo=ec.getContentSize(eo,"paragraph");var ep=1,em=1;er.width>eo.width&&(ep=eo.width/er.width),er.height>eo.height&&(em=eo.height/er.height),eo=Math.min(ep,em),er={width:er.width*eo,height:er.height*eo}}eo=ed.convert(er.width,"px","cm")+"cm",ed=ed.convert(er.height,"px","cm")+"cm",em=el.getOdfCanvas().odfContainer().rootElement.styles,er=$.toLowerCase();var eh,ep=ei.hasOwnProperty(er)?ei[er]:null;er=[],runtime.assert(null!==ep,"Image type is not supported: "+$),ep="Pictures/"+en.generateImageName()+ep,(eh=new ops.OpSetBlob).init({memberid:et,filename:ep,mimetype:$,content:ee}),er.push(eh),ec.getStyleElement("Graphics","graphic",[em])||(($=new ops.OpAddStyle).init({memberid:et,styleName:"Graphics",styleFamily:"graphic",isAutomaticStyle:!1,setProperties:{"style:graphic-properties":{"text:anchor-type":"paragraph","svg:x":"0cm","svg:y":"0cm","style:wrap":"dynamic","style:number-wrapped-paragraphs":"no-limit","style:wrap-contour":"false","style:vertical-pos":"top","style:vertical-rel":"paragraph","style:horizontal-pos":"center","style:horizontal-rel":"paragraph"}}}),er.push($)),$=en.generateStyleName(),(ee=new ops.OpAddStyle).init({memberid:et,styleName:$,styleFamily:"graphic",isAutomaticStyle:!0,setProperties:{"style:parent-style-name":"Graphics","style:graphic-properties":{"style:vertical-pos":"top","style:vertical-rel":"baseline","style:horizontal-pos":"center","style:horizontal-rel":"paragraph","fo:background-color":"transparent","style:background-transparency":"100%","style:shadow":"none","style:mirror":"none","fo:clip":"rect(0cm, 0cm, 0cm, 0cm)","draw:luminance":"0%","draw:contrast":"0%","draw:red":"0%","draw:green":"0%","draw:blue":"0%","draw:gamma":"100%","draw:color-inversion":"false","draw:image-opacity":"100%","draw:color-mode":"standard"}}}),er.push(ee),(eh=new ops.OpInsertImage).init({memberid:et,position:el.getCursorPosition(et),filename:ep,frameWidth:eo,frameHeight:ed,frameStyleName:$,frameName:en.generateFrameName()}),er.push(eh),_.enqueue(er)}},this.destroy=function(_){el.unsubscribe(ops.Document.signalCursorMoved,er),$.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,eo),_()},el.subscribe(ops.Document.signalCursorMoved,er),$.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,eo),eo()},gui.ImageController.enabledChanged="enabled/changed",gui.ImageSelector=function(_){function $(){var $=_.getSizer(),ee=en.createElement("div");return ee.id="imageSelector",ee.style.borderWidth="1px",$.appendChild(ee),et.forEach(function(_){var $=en.createElement("div");$.className=_,ee.appendChild($)}),ee}var ee=odf.Namespaces.svgns,et="topLeft topRight bottomRight bottomLeft topMiddle rightMiddle bottomMiddle leftMiddle".split(" "),en=_.getElement().ownerDocument,eo=!1;this.select=function(et){var er,ei,es=en.getElementById("imageSelector");es||(es=$()),eo=!0,er=es.parentNode,ei=et.getBoundingClientRect();var el=er.getBoundingClientRect(),eu=_.getZoomLevel();er=(ei.left-el.left)/eu-1,ei=(ei.top-el.top)/eu-1,es.style.display="block",es.style.left=er+"px",es.style.top=ei+"px",es.style.width=et.getAttributeNS(ee,"width"),es.style.height=et.getAttributeNS(ee,"height")},this.clearSelection=function(){var _;eo&&(_=en.getElementById("imageSelector"))&&(_.style.display="none"),eo=!1},this.isSelectorElement=function(_){var $=en.getElementById("imageSelector");return!!$&&(_===$||_.parentNode===$)}},function(){function _(_){function $(_){return eo=_.which&&String.fromCharCode(_.which)===en,en=void 0,!1===eo}function ee(){eo=!1}function et(_){en=_.data,eo=!1}var en,eo=!1;this.destroy=function(en){_.unsubscribe("textInput",ee),_.unsubscribe("compositionend",et),_.removeFilter("keypress",$),en()},_.subscribe("textInput",ee),_.subscribe("compositionend",et),_.addFilter("keypress",$)}gui.InputMethodEditor=function($,ee){function et(_){eh&&(_?eh.getNode().setAttributeNS("urn:webodf:names:cursor","composing","true"):(eh.getNode().removeAttributeNS("urn:webodf:names:cursor","composing"),ec.textContent=""))}function en(){ey&&(ey=!1,et(!1),eS.emit(gui.InputMethodEditor.signalCompositionEnd,{data:ev}),ev="")}function eo(){eC||(eC=!0,en(),eh&&eh.getSelectedRange().collapsed?eg.value="":eg.value=ep.writeToString(eh.getSelectedRange().cloneContents()),eg.setSelectionRange(0,eg.value.length),eC=!1)}function er(){ee.hasFocus()&&ed.trigger()}function ei(){ef=void 0,ed.cancel(),et(!0),ey||eS.emit(gui.InputMethodEditor.signalCompositionStart,{data:""})}function es(_){_=ef=_.data,ey=!0,ev+=_,ed.trigger()}function el(_){_.data!==ef&&(_=_.data,ey=!0,ev+=_,ed.trigger()),ef=void 0}function eu(){ec.textContent=eg.value}var ec,ed,ef,ep,em,eh=null,eg=ee.getEventTrap(),eb=eg.ownerDocument,ey=!1,ev="",eS=new core.EventNotifier([gui.InputMethodEditor.signalCompositionStart,gui.InputMethodEditor.signalCompositionEnd]),eN=[],eC=!1;this.subscribe=eS.subscribe,this.unsubscribe=eS.unsubscribe,this.registerCursor=function(_){_.getMemberId()===$&&((eh=_).getNode().appendChild(ec),_.subscribe(ops.OdtCursor.signalCursorUpdated,er),ee.subscribe("input",eu),ee.subscribe("compositionupdate",eu))},this.removeCursor=function(_){eh&&_===$&&(eh.getNode().removeChild(ec),eh.unsubscribe(ops.OdtCursor.signalCursorUpdated,er),ee.unsubscribe("input",eu),ee.unsubscribe("compositionupdate",eu),eh=null)},this.destroy=function(_){ee.unsubscribe("compositionstart",ei),ee.unsubscribe("compositionend",es),ee.unsubscribe("textInput",el),ee.unsubscribe("keypress",en),ee.unsubscribe("focus",eo),core.Async.destroyAll(em,_)},function(){(ep=new odf.TextSerializer).filter=new odf.OdfNodeFilter,ee.subscribe("compositionstart",ei),ee.subscribe("compositionend",es),ee.subscribe("textInput",el),ee.subscribe("keypress",en),ee.subscribe("focus",eo),eN.push(new _(ee)),em=eN.map(function(_){return _.destroy}),(ec=eb.createElement("span")).setAttribute("id","composer"),ed=core.Task.createTimeoutTask(eo,1),em.push(ed.destroy)}()},gui.InputMethodEditor.signalCompositionStart="input/compositionstart",gui.InputMethodEditor.signalCompositionEnd="input/compositionend"}(),gui.MetadataController=function(_,$){function ee(_){eo.emit(gui.MetadataController.signalMetadataChanged,_)}function et(_){var $=-1===er.indexOf(_);return $||runtime.log("Setting "+_+" is restricted."),$}var en=_.getOdtDocument(),eo=new core.EventNotifier([gui.MetadataController.signalMetadataChanged]),er=["dc:creator","dc:date","meta:editing-cycles","meta:editing-duration","meta:document-statistic"];this.setMetadata=function(ee,en){var eo,er={},ei="";ee&&Object.keys(ee).filter(et).forEach(function(_){er[_]=ee[_]}),en&&(ei=en.filter(et).join(",")),(0<ei.length||0<Object.keys(er).length)&&((eo=new ops.OpUpdateMetadata).init({memberid:$,setProperties:er,removedProperties:0<ei.length?{attributes:ei}:null}),_.enqueue([eo]))},this.getMetadata=function(_){var $;return runtime.assert("string"==typeof _,"Property must be a string"),$=_.split(":"),runtime.assert(2===$.length,"Property must be a namespace-prefixed string"),_=odf.Namespaces.lookupNamespaceURI($[0]),runtime.assert(!!_,"Prefix must be for an ODF namespace."),en.getOdfCanvas().odfContainer().getMetadata(_,$[1])},this.subscribe=function(_,$){eo.subscribe(_,$)},this.unsubscribe=function(_,$){eo.unsubscribe(_,$)},this.destroy=function(_){en.unsubscribe(ops.OdtDocument.signalMetadataUpdated,ee),_()},en.subscribe(ops.OdtDocument.signalMetadataUpdated,ee)},gui.MetadataController.signalMetadataChanged="metadata/changed",gui.PasteController=function(_,$,ee,et){function en(){ei=!0!==$.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)||ee.isLocalCursorWithinOwnAnnotation()}function eo(_){_.getMemberId()===et&&en()}var er=_.getOdtDocument(),ei=!1,es=odf.Namespaces.textns,el=core.StepDirection.NEXT,eu=odf.OdfUtils;this.isEnabled=function(){return ei},this.paste=function($){if(ei){var ee=er.getCursorPosition(et),en=er.getCursor(et).getNode(),en=eu.getParagraphElement(en),eo=en.getAttributeNS(es,"style-name")||"",ec=ee,ed=[],ef=er.convertDomPointToCursorStep(en,0,el);$.replace(/\r/g,"").split("\n").forEach(function(_){var $=new ops.OpInsertText,ee=new ops.OpSplitParagraph;$.init({memberid:et,position:ec,text:_,moveCursor:!0}),ed.push($),ec+=_.length,ee.init({memberid:et,position:ec,paragraphStyleName:eo,sourceParagraphPosition:ef,moveCursor:!0}),ed.push(ee),ef=ec+=1}),ed.pop(),_.enqueue(ed)}},this.destroy=function(_){er.unsubscribe(ops.Document.signalCursorMoved,eo),$.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,en),_()},er.subscribe(ops.Document.signalCursorMoved,eo),$.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,en),en()},gui.ClosestXOffsetScanner=function(_){function $($){return null!==$&&void 0!==et&&Math.abs($-_)>et}function ee(ee){null!==ee&&!1===$(ee)&&(et=Math.abs(ee-_))}var et,en=this,eo=gui.StepInfo.VisualDirection.LEFT_TO_RIGHT;this.token=void 0,this.process=function(_,et,er){var ei,es;return _.visualDirection===eo?(ei=et&&et.right,es=er&&er.left):(ei=et&&et.left,es=er&&er.right),!!($(ei)||$(es))||((et||er)&&(ee(ei),ee(es),en.token=_.token),!1)}},gui.LineBoundaryScanner=function(){var _=this,$=null;this.token=void 0,this.process=function(ee,et,en){var eo;if(eo=en){if($){var er=$;eo=Math.min(er.bottom-er.top,en.bottom-en.top);var ei=Math.max(er.top,en.top),er=Math.min(er.bottom,en.bottom)-ei;eo=.4>=(0<eo?er/eo:0)}else eo=!1}return et&&(!en||eo)&&(_.token=ee.token),!!eo||($=(ee=$)&&et?{left:Math.min(ee.left,et.left),right:Math.max(ee.right,et.right),top:Math.min(ee.top,et.top),bottom:Math.min(ee.bottom,et.bottom)}:ee||et,!1)}},gui.ParagraphBoundaryScanner=function(){var _,$=this,ee=!1,et=odf.OdfUtils;this.token=void 0,this.process=function(en){var eo=et.getParagraphElement(en.container());return ee||(_=eo,ee=!0),_!==eo||($.token=en.token,!1)}},odf.WordBoundaryFilter=function(_,$){function ee($,ee,et){for(var en,eo=null,er=_.getRootNode();$!==er&&null!==$&&null===eo;)et(en=0>ee?$.previousSibling:$.nextSibling)===NodeFilter.FILTER_ACCEPT&&(eo=en),$=$.parentNode;return eo}function et(_,$){var ee;return null===_?ef.NO_NEIGHBOUR:er.isCharacterElement(_)?ef.SPACE_CHAR:_.nodeType===en||er.isTextSpan(_)||er.isHyperlink(_)?es.test(ee=_.textContent.charAt($()))?ef.SPACE_CHAR:ei.test(ee)?ef.PUNCTUATION_CHAR:ef.WORD_CHAR:ef.OTHER}var en=Node.TEXT_NODE,eo=Node.ELEMENT_NODE,er=odf.OdfUtils,ei=/[!-#%-*,-\/:-;?-@\[-\]_{}\u00a1\u00ab\u00b7\u00bb\u00bf;\u00b7\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0700-\u070d\u07f7-\u07f9\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u169b-\u169c\u16eb-\u16ed\u1735-\u1736\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u1944-\u1945\u19de-\u19df\u1a1e-\u1a1f\u1b5a-\u1b60\u1c3b-\u1c3f\u1c7e-\u1c7f\u2000-\u206e\u207d-\u207e\u208d-\u208e\u3008-\u3009\u2768-\u2775\u27c5-\u27c6\u27e6-\u27ef\u2983-\u2998\u29d8-\u29db\u29fc-\u29fd\u2cf9-\u2cfc\u2cfe-\u2cff\u2e00-\u2e7e\u3000-\u303f\u30a0\u30fb\ua60d-\ua60f\ua673\ua67e\ua874-\ua877\ua8ce-\ua8cf\ua92e-\ua92f\ua95f\uaa5c-\uaa5f\ufd3e-\ufd3f\ufe10-\ufe19\ufe30-\ufe52\ufe54-\ufe61\ufe63\ufe68\ufe6a-\ufe6b\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|\ud800[\udd00-\udd01\udf9f\udfd0]|\ud802[\udd1f\udd3f\ude50-\ude58]|\ud809[\udc00-\udc7e]/,es=/\s/,el=core.PositionFilter.FilterResult.FILTER_ACCEPT,eu=core.PositionFilter.FilterResult.FILTER_REJECT,ec=odf.WordBoundaryFilter.IncludeWhitespace.TRAILING,ed=odf.WordBoundaryFilter.IncludeWhitespace.LEADING,ef={NO_NEIGHBOUR:0,SPACE_CHAR:1,PUNCTUATION_CHAR:2,WORD_CHAR:3,OTHER:4};this.acceptPosition=function(_){var en=_.container(),er=_.leftNode(),ei=_.rightNode(),es=_.unfilteredDomOffset,ep=function(){return _.unfilteredDomOffset()-1};return en.nodeType===eo&&(null===ei&&(ei=ee(en,1,_.getNodeFilter())),null===er&&(er=ee(en,-1,_.getNodeFilter()))),en!==ei&&(es=function(){return 0}),en!==er&&null!==er&&(ep=function(){return er.textContent.length-1}),en=et(er,ep),ei=et(ei,es),en===ef.WORD_CHAR&&ei===ef.WORD_CHAR||en===ef.PUNCTUATION_CHAR&&ei===ef.PUNCTUATION_CHAR||$===ec&&en!==ef.NO_NEIGHBOUR&&ei===ef.SPACE_CHAR||$===ed&&en===ef.SPACE_CHAR&&ei!==ef.NO_NEIGHBOUR?eu:el}},odf.WordBoundaryFilter.IncludeWhitespace={None:0,TRAILING:1,LEADING:2},gui.SelectionController=function(_,$){function ee(_){var ee=_.spec();(_.isEdit||ee.memberid===$)&&(eh=void 0,eg.cancel())}function et(){var _=eb.getCursor($).getNode();return eb.createStepIterator(_,0,[eS,eC],eb.getRootElement(_))}function en(_,$,ee){ee=new odf.WordBoundaryFilter(eb,ee);var et=eb.getRootElement(_)||eb.getRootNode(),en=eb.createRootFilter(et);return eb.createStepIterator(_,$,[eS,en,ee],et)}function eo(_,$){return $?{anchorNode:_.startContainer,anchorOffset:_.startOffset,focusNode:_.endContainer,focusOffset:_.endOffset}:{anchorNode:_.endContainer,anchorOffset:_.endOffset,focusNode:_.startContainer,focusOffset:_.startOffset}}function er(_,ee,et){var en=new ops.OpMoveCursor;return en.init({memberid:$,position:_,length:ee||0,selectionType:et}),en}function ei(ee,et,en){var ei;(ei=eo((ei=eb.getCursor($)).getSelectedRange(),ei.hasForwardSelection())).focusNode=ee,ei.focusOffset=et,en||(ei.anchorNode=ei.focusNode,ei.anchorOffset=ei.focusOffset),ee=eb.convertDomToCursorRange(ei),_.enqueue([er(ee.position,ee.length)])}function es(_){var $;($=en(_.startContainer,_.startOffset,ew)).roundToPreviousStep()&&_.setStart($.container(),$.offset()),($=en(_.endContainer,_.endOffset,eE)).roundToNextStep()&&_.setEnd($.container(),$.offset())}function el(_){var $=ev.getParagraphElements(_),ee=$[0],$=$[$.length-1];ee&&_.setStart(ee,0),$&&(ev.isParagraph(_.endContainer)&&0===_.endOffset?_.setEndBefore($):_.setEnd($,$.childNodes.length))}function eu(_,$,ee,et){var en,eo;et?(en=ee.startContainer,eo=ee.startOffset):(en=ee.endContainer,eo=ee.endOffset),ey.containsNode(_,en)||(eo=0>ey.comparePoints(_,0,en,eo)?0:_.childNodes.length,en=_),(_=eb.createStepIterator(en,eo,$,ev.getParagraphElement(en)||_)).roundToClosestStep()||runtime.assert(!1,"No step found in requested range"),et?ee.setStart(_.container(),_.offset()):ee.setEnd(_.container(),_.offset())}function ec(_,$){var ee=et();ee.advanceStep(_)&&ei(ee.container(),ee.offset(),$)}function ed(_,$){var ee,en=eh,eo=[new gui.LineBoundaryScanner,new gui.ParagraphBoundaryScanner];void 0===en&&ex&&(en=ex()),isNaN(en)||(ee=et(),eN.moveToFilteredStep(ee,_,eo)&&ee.advanceStep(_)&&(eo=[new gui.ClosestXOffsetScanner(en),new gui.LineBoundaryScanner,new gui.ParagraphBoundaryScanner],eN.moveToFilteredStep(ee,_,eo)&&(ei(ee.container(),ee.offset(),$),eh=en,eg.restart())))}function ef(_,$){var ee=et(),en=[new gui.LineBoundaryScanner,new gui.ParagraphBoundaryScanner];eN.moveToFilteredStep(ee,_,en)&&ei(ee.container(),ee.offset(),$)}function ep(_,ee){var et=eb.getCursor($),et=eo(et.getSelectedRange(),et.hasForwardSelection()),et=en(et.focusNode,et.focusOffset,ew);et.advanceStep(_)&&ei(et.container(),et.offset(),ee)}function em(_,ee,et){var en=!1,er=eb.getCursor($),er=eo(er.getSelectedRange(),er.hasForwardSelection()),en=eb.getRootElement(er.focusNode);runtime.assert(!!en,"SelectionController: Cursor outside root"),(er=eb.createStepIterator(er.focusNode,er.focusOffset,[eS,eC],en)).roundToClosestStep(),er.advanceStep(_)&&(et=et(er.container()))&&(_===eT?(er.setPosition(et,0),en=er.roundToNextStep()):(er.setPosition(et,et.childNodes.length),en=er.roundToPreviousStep()),en&&ei(er.container(),er.offset(),ee))}var eh,eg,eb=_.getOdtDocument(),ey=core.DomUtils,ev=odf.OdfUtils,eS=eb.getPositionFilter(),eN=new gui.GuiStepUtils,eC=eb.createRootFilter($),ex=null,ew=odf.WordBoundaryFilter.IncludeWhitespace.TRAILING,eE=odf.WordBoundaryFilter.IncludeWhitespace.LEADING,eT=core.StepDirection.PREVIOUS,eO=core.StepDirection.NEXT;this.selectionToRange=function(_){var $=0<=ey.comparePoints(_.anchorNode,_.anchorOffset,_.focusNode,_.focusOffset),ee=_.focusNode.ownerDocument.createRange();return $?(ee.setStart(_.anchorNode,_.anchorOffset),ee.setEnd(_.focusNode,_.focusOffset)):(ee.setStart(_.focusNode,_.focusOffset),ee.setEnd(_.anchorNode,_.anchorOffset)),{range:ee,hasForwardSelection:$}},this.rangeToSelection=eo,this.selectImage=function($){var ee,et=eb.getRootElement($),en=eb.createRootFilter(et),et=eb.createStepIterator($,0,[en,eb.getPositionFilter()],et);et.roundToPreviousStep()||runtime.assert(!1,"No walkable position before frame"),en=et.container(),ee=et.offset(),et.setPosition($,$.childNodes.length),et.roundToNextStep()||runtime.assert(!1,"No walkable position after frame"),$=er(($=eb.convertDomToCursorRange({anchorNode:en,anchorOffset:ee,focusNode:et.container(),focusOffset:et.offset()})).position,$.length,ops.OdtCursor.RegionSelection),_.enqueue([$])},this.expandToWordBoundaries=es,this.expandToParagraphBoundaries=el,this.selectRange=function(ee,et,en){var ei,ec=eb.getOdfCanvas().getElement(),ed=[eS];ei=ey.containsNode(ec,ee.startContainer),ec=ey.containsNode(ec,ee.endContainer),(ei||ec)&&(ei&&ec&&(2===en?es(ee):3<=en&&el(ee)),(en=et?eb.getRootElement(ee.startContainer):eb.getRootElement(ee.endContainer))||(en=eb.getRootNode()),ed.push(eb.createRootFilter(en)),eu(en,ed,ee,!0),eu(en,ed,ee,!1),ee=eo(ee,et),et=eb.convertDomToCursorRange(ee),ee=eb.getCursorSelection($),(et.position!==ee.position||et.length!==ee.length)&&(ee=er(et.position,et.length,ops.OdtCursor.RangeSelection),_.enqueue([ee])))},this.moveCursorToLeft=function(){return ec(eT,!1),!0},this.moveCursorToRight=function(){return ec(eO,!1),!0},this.extendSelectionToLeft=function(){return ec(eT,!0),!0},this.extendSelectionToRight=function(){return ec(eO,!0),!0},this.setCaretXPositionLocator=function(_){ex=_},this.moveCursorUp=function(){return ed(eT,!1),!0},this.moveCursorDown=function(){return ed(eO,!1),!0},this.extendSelectionUp=function(){return ed(eT,!0),!0},this.extendSelectionDown=function(){return ed(eO,!0),!0},this.moveCursorBeforeWord=function(){return ep(eT,!1),!0},this.moveCursorPastWord=function(){return ep(eO,!1),!0},this.extendSelectionBeforeWord=function(){return ep(eT,!0),!0},this.extendSelectionPastWord=function(){return ep(eO,!0),!0},this.moveCursorToLineStart=function(){return ef(eT,!1),!0},this.moveCursorToLineEnd=function(){return ef(eO,!1),!0},this.extendSelectionToLineStart=function(){return ef(eT,!0),!0},this.extendSelectionToLineEnd=function(){return ef(eO,!0),!0},this.extendSelectionToParagraphStart=function(){return em(eT,!0,ev.getParagraphElement),!0},this.extendSelectionToParagraphEnd=function(){return em(eO,!0,ev.getParagraphElement),!0},this.moveCursorToParagraphStart=function(){return em(eT,!1,ev.getParagraphElement),!0},this.moveCursorToParagraphEnd=function(){return em(eO,!1,ev.getParagraphElement),!0},this.moveCursorToDocumentStart=function(){return em(eT,!1,eb.getRootElement),!0},this.moveCursorToDocumentEnd=function(){return em(eO,!1,eb.getRootElement),!0},this.extendSelectionToDocumentStart=function(){return em(eT,!0,eb.getRootElement),!0},this.extendSelectionToDocumentEnd=function(){return em(eO,!0,eb.getRootElement),!0},this.extendSelectionToEntireDocument=function(){var ee,et,en,eo=eb.getCursor($),eo=eb.getRootElement(eo.getNode());return runtime.assert(!!eo,"SelectionController: Cursor outside root"),(en=eb.createStepIterator(eo,0,[eS,eC],eo)).roundToClosestStep(),ee=en.container(),et=en.offset(),en.setPosition(eo,eo.childNodes.length),en.roundToClosestStep(),eo=eb.convertDomToCursorRange({anchorNode:ee,anchorOffset:et,focusNode:en.container(),focusOffset:en.offset()}),_.enqueue([er(eo.position,eo.length)]),!0},this.destroy=function(_){eb.unsubscribe(ops.OdtDocument.signalOperationStart,ee),core.Async.destroyAll([eg.destroy],_)},function(){eg=core.Task.createTimeoutTask(function(){eh=void 0},2e3),eb.subscribe(ops.OdtDocument.signalOperationStart,ee)}()},gui.TextController=function(_,$,ee,et,en,eo){function er(){em=!0!==$.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)||ee.isLocalCursorWithinOwnAnnotation()}function ei(_){_.getMemberId()===et&&er()}function es(_,$,ee){var et=[ed.getPositionFilter()];return ee&&et.push(ed.createRootFilter(_.startContainer)),(ee=ed.createStepIterator(_.startContainer,_.startOffset,et,$)).roundToClosestStep()||runtime.assert(!1,"No walkable step found in paragraph element at range start"),$=ed.convertDomPointToCursorStep(ee.container(),ee.offset()),_.collapsed?_=$:(ee.setPosition(_.endContainer,_.endOffset),ee.roundToClosestStep()||runtime.assert(!1,"No walkable step found in paragraph element at range end"),_=ed.convertDomPointToCursorStep(ee.container(),ee.offset())),{position:$,length:_-$}}function el(_){var $,ee,en,eo=ef.getParagraphElements(_),er=_.cloneRange(),ei=[];return $=eo[0],1<eo.length&&(ef.hasNoODFContent($)&&($=eo[eo.length-1]),ee=$.getAttributeNS(odf.Namespaces.textns,"style-name")||""),eo.forEach(function($,eo){var el,eu;er.setStart($,0),er.collapse(!0),el=es(er,$,!1).position,0<eo&&((eu=new ops.OpMergeParagraph).init({memberid:et,paragraphStyleName:ee,destinationStartPosition:en,sourceStartPosition:el,moveCursor:1===eo}),ei.unshift(eu)),en=el,er.selectNodeContents($),(el=ep.rangeIntersection(er,_))&&0<(el=es(el,$,!0)).length&&((eu=new ops.OpRemoveText).init({memberid:et,position:el.position,length:el.length}),ei.unshift(eu))}),ei}function eu(_){return 0>_.length&&(_.position+=_.length,_.length=-_.length),_}function ec($){if(!em)return!1;var ee,en,eo=ed.getCursor(et).getSelectedRange().cloneRange(),er=eu(ed.getCursorSelection(et));if(0===er.length){er=void 0,ee=ed.getCursor(et).getNode(),en=ed.getRootElement(ee);var ei=[ed.getPositionFilter(),ed.createRootFilter(en)];(en=ed.createStepIterator(ee,0,ei,en)).roundToClosestStep()&&($?en.nextStep():en.previousStep())&&(er=eu(ed.convertDomToCursorRange({anchorNode:ee,anchorOffset:0,focusNode:en.container(),focusOffset:en.offset()})),$?(eo.setStart(ee,0),eo.setEnd(en.container(),en.offset())):(eo.setStart(en.container(),en.offset()),eo.setEnd(ee,0)))}return er&&_.enqueue(el(eo)),void 0!==er}var ed=_.getOdtDocument(),ef=odf.OdfUtils,ep=core.DomUtils,em=!1,eh=odf.Namespaces.textns,eg=core.StepDirection.NEXT;this.isEnabled=function(){return em},this.enqueueParagraphSplittingOps=function(){if(!em)return!1;var $=ed.getCursor(et),ee=$.getSelectedRange(),en=eu(ed.getCursorSelection(et)),er=[],$=ef.getParagraphElement($.getNode()),ei=$.getAttributeNS(eh,"style-name")||"";return 0<en.length&&(er=er.concat(el(ee))),(ee=new ops.OpSplitParagraph).init({memberid:et,position:en.position,paragraphStyleName:ei,sourceParagraphPosition:ed.convertDomPointToCursorStep($,0,eg),moveCursor:!0}),er.push(ee),eo&&(en=eo(en.position+1),er=er.concat(en)),_.enqueue(er),!0},this.removeTextByBackspaceKey=function(){return ec(!1)},this.removeTextByDeleteKey=function(){return ec(!0)},this.removeCurrentSelection=function(){if(!em)return!1;var $=ed.getCursor(et).getSelectedRange();return _.enqueue(el($)),!0},this.insertText=function($){if(em){var ee=ed.getCursor(et).getSelectedRange(),eo=eu(ed.getCursorSelection(et)),er=[],ei=!1;0<eo.length&&(er=er.concat(el(ee)),ei=!0),(ee=new ops.OpInsertText).init({memberid:et,position:eo.position,text:$,moveCursor:!0}),er.push(ee),en&&($=en(eo.position,$.length,ei))&&er.push($),_.enqueue(er)}},this.destroy=function(_){ed.unsubscribe(ops.Document.signalCursorMoved,ei),$.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,er),_()},ed.subscribe(ops.Document.signalCursorMoved,ei),$.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,er),er()},gui.UndoManager=function(){},gui.UndoManager.prototype.subscribe=function(_,$){},gui.UndoManager.prototype.unsubscribe=function(_,$){},gui.UndoManager.prototype.setDocument=function(_){},gui.UndoManager.prototype.setInitialState=function(){},gui.UndoManager.prototype.initialize=function(){},gui.UndoManager.prototype.purgeInitialState=function(){},gui.UndoManager.prototype.setPlaybackFunction=function(_){},gui.UndoManager.prototype.hasUndoStates=function(){},gui.UndoManager.prototype.hasRedoStates=function(){},gui.UndoManager.prototype.moveForward=function(_){},gui.UndoManager.prototype.moveBackward=function(_){},gui.UndoManager.prototype.onOperationExecuted=function(_){},gui.UndoManager.prototype.isDocumentModified=function(){},gui.UndoManager.prototype.setDocumentModified=function(_){},gui.UndoManager.signalUndoStackChanged="undoStackChanged",gui.UndoManager.signalUndoStateCreated="undoStateCreated",gui.UndoManager.signalUndoStateModified="undoStateModified",gui.UndoManager.signalDocumentModifiedChanged="documentModifiedChanged",gui.SessionControllerOptions=function(){this.annotationsEnabled=this.directParagraphStylingEnabled=this.directTextStylingEnabled=!1},function(){var _=core.PositionFilter.FilterResult.FILTER_ACCEPT;gui.SessionController=function($,ee,et,en){function eo(_,$){var ee=eF.getDOMDocument(),et=null;return ee.caretRangeFromPoint?et={container:(ee=ee.caretRangeFromPoint(_,$)).startContainer,offset:ee.startOffset}:ee.caretPositionFromPoint&&(ee=ee.caretPositionFromPoint(_,$))&&ee.offsetNode&&(et={container:ee.offsetNode,offset:ee.offset}),et}function er(_){var $=eF.getCursor(ee).getSelectedRange();$.collapsed?_.preventDefault():eH.setDataFromRange(_,$)?e0.removeCurrentSelection():runtime.log("Cut operation failed")}function ei(){return!1!==eF.getCursor(ee).getSelectedRange().collapsed}function es(_){var $=eF.getCursor(ee).getSelectedRange();$.collapsed?_.preventDefault():eH.setDataFromRange(_,$)||runtime.log("Copy operation failed")}function el(_){var $;eI.clipboardData&&eI.clipboardData.getData?$=eI.clipboardData.getData("Text"):_.clipboardData&&_.clipboardData.getData&&($=_.clipboardData.getData("text/plain")),$&&(e0.removeCurrentSelection(),e3.paste($)),_.preventDefault?_.preventDefault():_.returnValue=!1}function eu(){return!1}function ec(_){eJ&&eJ.onOperationExecuted(_)}function ed(_){eF.emit(ops.OdtDocument.signalUndoStackChanged,_)}function ef(){var _;return!!eJ&&(_=eG.hasFocus(),eJ.moveBackward(1),_&&eG.focus(),!0)}function ep(){var _;return!!eJ&&(_=eG.hasFocus(),eJ.moveForward(1),_&&eG.focus(),!0)}function em($){var en=eF.getCursor(ee).getSelectedRange(),er=($.target||$.srcElement||null).getAttribute("end");en&&er&&($=eo($.clientX,$.clientY))&&(e5.setUnfilteredPosition($.container,$.offset),eq.acceptPosition(e5)===_&&(en=en.cloneRange(),"left"===er?en.setStart(e5.container(),e5.unfilteredDomOffset()):en.setEnd(e5.container(),e5.unfilteredDomOffset()),et.setSelectedRange(en,"right"===er),eF.emit(ops.Document.signalCursorMoved,et)))}function eh(){e7.selectRange(et.getSelectedRange(),et.hasForwardSelection(),1)}function eg(){var $=eI.getSelection(),ee=0<$.rangeCount&&e7.selectionToRange($);eV&&ee&&(eK=!0,e2.clearSelection(),e5.setUnfilteredPosition($.focusNode,$.focusOffset),eq.acceptPosition(e5)===_&&(2===e8?e7.expandToWordBoundaries(ee.range):3<=e8&&e7.expandToParagraphBoundaries(ee.range),et.setSelectedRange(ee.range,ee.hasForwardSelection),eF.emit(ops.Document.signalCursorMoved,et)))}function eb(_){var $=_.target||_.srcElement||null,et=eF.getCursor(ee);(eV=null!==$&&eU.containsNode(eF.getOdfCanvas().getElement(),$))&&(eK=!1,$=eF.getRootElement($)||eF.getRootNode(),eq=eF.createRootFilter($),e8=0===_.button?_.detail:0,et&&_.shiftKey?eI.getSelection().collapse(et.getAnchorNode(),0):(_=eI.getSelection(),$=et.getSelectedRange(),_.extend?et.hasForwardSelection()?(_.collapse($.startContainer,$.startOffset),_.extend($.endContainer,$.endOffset)):(_.collapse($.endContainer,$.endOffset),_.extend($.startContainer,$.startOffset)):(_.removeAllRanges(),_.addRange($.cloneRange()))),1<e8&&eg())}function ey(_){var $=eF.getRootElement(_),ee=eF.createRootFilter($),$=eF.createStepIterator(_,0,[ee,eF.getPositionFilter()],$);return $.setPosition(_,_.childNodes.length),$.roundToNextStep()?{container:$.container(),offset:$.offset()}:null}function ev(_){$=($=eI.getSelection())?{anchorNode:$.anchorNode,anchorOffset:$.anchorOffset,focusNode:$.focusNode,focusOffset:$.focusOffset}:null;var $,ee,et,en=eI.getSelection().isCollapsed;!$.anchorNode&&!$.focusNode&&(ee=eo(_.clientX,_.clientY))&&($.anchorNode=ee.container,$.anchorOffset=ee.offset,$.focusNode=$.anchorNode,$.focusOffset=$.anchorOffset),eL.isImage($.focusNode)&&0===$.focusOffset&&eL.isCharacterFrame($.focusNode.parentNode)?(ee=(et=$.focusNode.parentNode).getBoundingClientRect(),_.clientX>ee.left&&(ee=ey(et))&&($.focusNode=ee.container,$.focusOffset=ee.offset,en&&($.anchorNode=$.focusNode,$.anchorOffset=$.focusOffset))):eL.isImage($.focusNode.firstChild)&&1===$.focusOffset&&eL.isCharacterFrame($.focusNode)&&(ee=ey($.focusNode))&&($.anchorNode=$.focusNode=ee.container,$.anchorOffset=$.focusOffset=ee.offset),$.anchorNode&&$.focusNode&&($=e7.selectionToRange($),e7.selectRange($.range,$.hasForwardSelection,0===_.button?_.detail:0)),eG.focus()}function eS(_){var $;($=eo(_.clientX,_.clientY))&&(_={anchorNode:_=$.container,anchorOffset:$=$.offset,focusNode:_,focusOffset:$},_=e7.selectionToRange(_),e7.selectRange(_.range,_.hasForwardSelection,2),eG.focus())}function eN(_){var $,ee,en,eo=_.target||_.srcElement||null;eD.processRequests(),eV&&(eL.isImage(eo)&&eL.isCharacterFrame(eo.parentNode)&&eI.getSelection().isCollapsed?(e7.selectImage(eo.parentNode),eG.focus()):e2.isSelectorElement(eo)?eG.focus():eK?(ee=(eo=et.getSelectedRange()).collapsed,eL.isImage(eo.endContainer)&&0===eo.endOffset&&eL.isCharacterFrame(eo.endContainer.parentNode)&&(en=ey(en=eo.endContainer.parentNode))&&(eo.setEnd(en.container,en.offset),ee&&eo.collapse(!1)),e7.selectRange(eo,et.hasForwardSelection(),0===_.button?_.detail:0),eG.focus()):tr?ev(_):($=eU.cloneEvent(_),eP=runtime.setTimeout(function(){ev($)},0)),e8=0,eK=eV=!1)}function eC(_){var $=eF.getCursor(ee).getSelectedRange();$.collapsed||ez.exportRangeToDataTransfer(_.dataTransfer,$)}function ex(){eV&&eG.focus(),e8=0,eK=eV=!1}function ew(_){eN(_)}function eE(_){var $=_.target||_.srcElement||null,ee=null;"annotationRemoveButton"===$.className?(runtime.assert(eY,"Remove buttons are displayed on annotations while annotation editing is disabled in the controller."),ee=$.parentNode.getElementsByTagNameNS(odf.Namespaces.officens,"annotation").item(0),eQ.removeAnnotation(ee),eG.focus()):"webodf-draggable"!==$.getAttribute("class")&&eN(_)}function eT(_){(_=_.data)&&(-1===_.indexOf("\n")?e0.insertText(_):e3.paste(_))}function eO(_){return function(){return _(),!0}}function eA(_){return function($){return eF.getCursor(ee).getSelectionType()!==ops.OdtCursor.RangeSelection||_($)}}function eR(_){eG.unsubscribe("keydown",eW.handleEvent),eG.unsubscribe("keypress",ej.handleEvent),eG.unsubscribe("keyup",eX.handleEvent),eG.unsubscribe("copy",es),eG.unsubscribe("mousedown",eb),eG.unsubscribe("mousemove",eD.trigger),eG.unsubscribe("mouseup",eE),eG.unsubscribe("contextmenu",ew),eG.unsubscribe("dragstart",eC),eG.unsubscribe("dragend",ex),eG.unsubscribe("click",e4.handleClick),eG.unsubscribe("longpress",eS),eG.unsubscribe("drag",em),eG.unsubscribe("dragstop",eh),eF.unsubscribe(ops.OdtDocument.signalOperationEnd,e_.trigger),eF.unsubscribe(ops.Document.signalCursorAdded,e6.registerCursor),eF.unsubscribe(ops.Document.signalCursorRemoved,e6.removeCursor),eF.unsubscribe(ops.OdtDocument.signalOperationEnd,ec),_()}var eP,eD,e_,ek,eI=runtime.getWindow(),eF=$.getOdtDocument(),eM=new gui.SessionConstraints,eB=new gui.SessionContext($,ee),eU=core.DomUtils,eL=odf.OdfUtils,ez=new gui.MimeDataExporter,eH=new gui.Clipboard(ez),eW=new gui.KeyboardHandler,ej=new gui.KeyboardHandler,eX=new gui.KeyboardHandler,eV=!1,eZ=new odf.ObjectNameGenerator(eF.getOdfCanvas().odfContainer(),ee),eK=!1,eq=null,eJ=null,eG=new gui.EventManager(eF),eY=en.annotationsEnabled,eQ=new gui.AnnotationController($,eM,ee),e$=new gui.DirectFormattingController($,eM,eB,ee,eZ,en.directTextStylingEnabled,en.directParagraphStylingEnabled),e0=new gui.TextController($,eM,eB,ee,e$.createCursorStyleOp,e$.createParagraphStyleOps),e1=new gui.ImageController($,eM,eB,ee,eZ),e2=new gui.ImageSelector(eF.getOdfCanvas()),e5=eF.createPositionIterator(eF.getRootNode()),e3=new gui.PasteController($,eM,eB,ee),e6=new gui.InputMethodEditor(ee,eG),e8=0,e4=new gui.HyperlinkClickHandler(eF.getOdfCanvas().getElement,eW,eX),e9=new gui.HyperlinkController($,eM,eB,ee),e7=new gui.SelectionController($,ee),te=new gui.MetadataController($,ee),tt=gui.KeyboardHandler.Modifier,tn=gui.KeyboardHandler.KeyCode,to=-1!==eI.navigator.appVersion.toLowerCase().indexOf("mac"),tr=-1!==["iPad","iPod","iPhone"].indexOf(eI.navigator.platform);runtime.assert(null!==eI,"Expected to be run in an environment which has a global window, like a browser."),this.undo=ef,this.redo=ep,this.insertLocalCursor=function(){runtime.assert(void 0===$.getOdtDocument().getCursor(ee),"Inserting local cursor a second time.");var _=new ops.OpAddCursor;_.init({memberid:ee}),$.enqueue([_]),eG.focus()},this.removeLocalCursor=function(){runtime.assert(void 0!==$.getOdtDocument().getCursor(ee),"Removing local cursor without inserting before.");var _=new ops.OpRemoveCursor;_.init({memberid:ee}),$.enqueue([_])},this.startEditing=function(){e6.subscribe(gui.InputMethodEditor.signalCompositionStart,e0.removeCurrentSelection),e6.subscribe(gui.InputMethodEditor.signalCompositionEnd,eT),eG.subscribe("beforecut",ei),eG.subscribe("cut",er),eG.subscribe("beforepaste",eu),eG.subscribe("paste",el),eJ&&eJ.initialize(),eG.setEditing(!0),e4.setModifier(to?tt.Meta:tt.Ctrl),eW.bind(tn.Backspace,tt.None,eO(e0.removeTextByBackspaceKey),!0),eW.bind(tn.Delete,tt.None,e0.removeTextByDeleteKey),eW.bind(tn.Tab,tt.None,eA(function(){return e0.insertText("	"),!0})),to?(eW.bind(tn.Clear,tt.None,e0.removeCurrentSelection),eW.bind(tn.B,tt.Meta,eA(e$.toggleBold)),eW.bind(tn.I,tt.Meta,eA(e$.toggleItalic)),eW.bind(tn.U,tt.Meta,eA(e$.toggleUnderline)),eW.bind(tn.L,tt.MetaShift,eA(e$.alignParagraphLeft)),eW.bind(tn.E,tt.MetaShift,eA(e$.alignParagraphCenter)),eW.bind(tn.R,tt.MetaShift,eA(e$.alignParagraphRight)),eW.bind(tn.J,tt.MetaShift,eA(e$.alignParagraphJustified)),eY&&eW.bind(tn.C,tt.MetaShift,eQ.addAnnotation),eW.bind(tn.Z,tt.Meta,ef),eW.bind(tn.Z,tt.MetaShift,ep)):(eW.bind(tn.B,tt.Ctrl,eA(e$.toggleBold)),eW.bind(tn.I,tt.Ctrl,eA(e$.toggleItalic)),eW.bind(tn.U,tt.Ctrl,eA(e$.toggleUnderline)),eW.bind(tn.L,tt.CtrlShift,eA(e$.alignParagraphLeft)),eW.bind(tn.E,tt.CtrlShift,eA(e$.alignParagraphCenter)),eW.bind(tn.R,tt.CtrlShift,eA(e$.alignParagraphRight)),eW.bind(tn.J,tt.CtrlShift,eA(e$.alignParagraphJustified)),eY&&eW.bind(tn.C,tt.CtrlAlt,eQ.addAnnotation),eW.bind(tn.Z,tt.Ctrl,ef),eW.bind(tn.Z,tt.CtrlShift,ep)),ej.setDefault(eA(function(_){var $;return!!($=null===_.which||void 0===_.which?String.fromCharCode(_.keyCode):0!==_.which&&0!==_.charCode?String.fromCharCode(_.which):null)&&!_.altKey&&!_.ctrlKey&&!_.metaKey&&(e0.insertText($),!0)})),ej.bind(tn.Enter,tt.None,eA(e0.enqueueParagraphSplittingOps))},this.endEditing=function(){e6.unsubscribe(gui.InputMethodEditor.signalCompositionStart,e0.removeCurrentSelection),e6.unsubscribe(gui.InputMethodEditor.signalCompositionEnd,eT),eG.unsubscribe("cut",er),eG.unsubscribe("beforecut",ei),eG.unsubscribe("paste",el),eG.unsubscribe("beforepaste",eu),eG.setEditing(!1),e4.setModifier(tt.None),eW.bind(tn.Backspace,tt.None,function(){return!0},!0),eW.unbind(tn.Delete,tt.None),eW.unbind(tn.Tab,tt.None),to?(eW.unbind(tn.Clear,tt.None),eW.unbind(tn.B,tt.Meta),eW.unbind(tn.I,tt.Meta),eW.unbind(tn.U,tt.Meta),eW.unbind(tn.L,tt.MetaShift),eW.unbind(tn.E,tt.MetaShift),eW.unbind(tn.R,tt.MetaShift),eW.unbind(tn.J,tt.MetaShift),eY&&eW.unbind(tn.C,tt.MetaShift),eW.unbind(tn.Z,tt.Meta),eW.unbind(tn.Z,tt.MetaShift)):(eW.unbind(tn.B,tt.Ctrl),eW.unbind(tn.I,tt.Ctrl),eW.unbind(tn.U,tt.Ctrl),eW.unbind(tn.L,tt.CtrlShift),eW.unbind(tn.E,tt.CtrlShift),eW.unbind(tn.R,tt.CtrlShift),eW.unbind(tn.J,tt.CtrlShift),eY&&eW.unbind(tn.C,tt.CtrlAlt),eW.unbind(tn.Z,tt.Ctrl),eW.unbind(tn.Z,tt.CtrlShift)),ej.setDefault(null),ej.unbind(tn.Enter,tt.None)},this.getInputMemberId=function(){return ee},this.getSession=function(){return $},this.getSessionConstraints=function(){return eM},this.setUndoManager=function(_){eJ&&eJ.unsubscribe(gui.UndoManager.signalUndoStackChanged,ed),(eJ=_)&&(eJ.setDocument(eF),eJ.setPlaybackFunction($.enqueue),eJ.subscribe(gui.UndoManager.signalUndoStackChanged,ed))},this.getUndoManager=function(){return eJ},this.getMetadataController=function(){return te},this.getAnnotationController=function(){return eQ},this.getDirectFormattingController=function(){return e$},this.getHyperlinkClickHandler=function(){return e4},this.getHyperlinkController=function(){return e9},this.getImageController=function(){return e1},this.getSelectionController=function(){return e7},this.getTextController=function(){return e0},this.getEventManager=function(){return eG},this.getKeyboardHandlers=function(){return{keydown:eW,keypress:ej}},this.destroy=function(_){var $=[eD.destroy,e_.destroy,e$.destroy,e6.destroy,eG.destroy,e4.destroy,e9.destroy,te.destroy,e7.destroy,e0.destroy,eR];ek&&$.unshift(ek.destroy),runtime.clearTimeout(eP),core.Async.destroyAll($,_)},eD=core.Task.createRedrawTask(eg),e_=core.Task.createRedrawTask(function(){var _=eF.getCursor(ee);if(_&&_.getSelectionType()===ops.OdtCursor.RegionSelection&&(_=eL.getImageElements(_.getSelectedRange())[0])){e2.select(_.parentNode);return}e2.clearSelection()}),eW.bind(tn.Left,tt.None,eA(e7.moveCursorToLeft)),eW.bind(tn.Right,tt.None,eA(e7.moveCursorToRight)),eW.bind(tn.Up,tt.None,eA(e7.moveCursorUp)),eW.bind(tn.Down,tt.None,eA(e7.moveCursorDown)),eW.bind(tn.Left,tt.Shift,eA(e7.extendSelectionToLeft)),eW.bind(tn.Right,tt.Shift,eA(e7.extendSelectionToRight)),eW.bind(tn.Up,tt.Shift,eA(e7.extendSelectionUp)),eW.bind(tn.Down,tt.Shift,eA(e7.extendSelectionDown)),eW.bind(tn.Home,tt.None,eA(e7.moveCursorToLineStart)),eW.bind(tn.End,tt.None,eA(e7.moveCursorToLineEnd)),eW.bind(tn.Home,tt.Ctrl,eA(e7.moveCursorToDocumentStart)),eW.bind(tn.End,tt.Ctrl,eA(e7.moveCursorToDocumentEnd)),eW.bind(tn.Home,tt.Shift,eA(e7.extendSelectionToLineStart)),eW.bind(tn.End,tt.Shift,eA(e7.extendSelectionToLineEnd)),eW.bind(tn.Up,tt.CtrlShift,eA(e7.extendSelectionToParagraphStart)),eW.bind(tn.Down,tt.CtrlShift,eA(e7.extendSelectionToParagraphEnd)),eW.bind(tn.Home,tt.CtrlShift,eA(e7.extendSelectionToDocumentStart)),eW.bind(tn.End,tt.CtrlShift,eA(e7.extendSelectionToDocumentEnd)),to?(eW.bind(tn.Left,tt.Alt,eA(e7.moveCursorBeforeWord)),eW.bind(tn.Right,tt.Alt,eA(e7.moveCursorPastWord)),eW.bind(tn.Left,tt.Meta,eA(e7.moveCursorToLineStart)),eW.bind(tn.Right,tt.Meta,eA(e7.moveCursorToLineEnd)),eW.bind(tn.Home,tt.Meta,eA(e7.moveCursorToDocumentStart)),eW.bind(tn.End,tt.Meta,eA(e7.moveCursorToDocumentEnd)),eW.bind(tn.Left,tt.AltShift,eA(e7.extendSelectionBeforeWord)),eW.bind(tn.Right,tt.AltShift,eA(e7.extendSelectionPastWord)),eW.bind(tn.Left,tt.MetaShift,eA(e7.extendSelectionToLineStart)),eW.bind(tn.Right,tt.MetaShift,eA(e7.extendSelectionToLineEnd)),eW.bind(tn.Up,tt.AltShift,eA(e7.extendSelectionToParagraphStart)),eW.bind(tn.Down,tt.AltShift,eA(e7.extendSelectionToParagraphEnd)),eW.bind(tn.Up,tt.MetaShift,eA(e7.extendSelectionToDocumentStart)),eW.bind(tn.Down,tt.MetaShift,eA(e7.extendSelectionToDocumentEnd)),eW.bind(tn.A,tt.Meta,eA(e7.extendSelectionToEntireDocument))):(eW.bind(tn.Left,tt.Ctrl,eA(e7.moveCursorBeforeWord)),eW.bind(tn.Right,tt.Ctrl,eA(e7.moveCursorPastWord)),eW.bind(tn.Left,tt.CtrlShift,eA(e7.extendSelectionBeforeWord)),eW.bind(tn.Right,tt.CtrlShift,eA(e7.extendSelectionPastWord)),eW.bind(tn.A,tt.Ctrl,eA(e7.extendSelectionToEntireDocument))),tr&&(ek=new gui.IOSSafariSupport(eG)),eG.subscribe("keydown",eW.handleEvent),eG.subscribe("keypress",ej.handleEvent),eG.subscribe("keyup",eX.handleEvent),eG.subscribe("copy",es),eG.subscribe("mousedown",eb),eG.subscribe("mousemove",eD.trigger),eG.subscribe("mouseup",eE),eG.subscribe("contextmenu",ew),eG.subscribe("dragstart",eC),eG.subscribe("dragend",ex),eG.subscribe("click",e4.handleClick),eG.subscribe("longpress",eS),eG.subscribe("drag",em),eG.subscribe("dragstop",eh),eF.subscribe(ops.OdtDocument.signalOperationEnd,e_.trigger),eF.subscribe(ops.Document.signalCursorAdded,e6.registerCursor),eF.subscribe(ops.Document.signalCursorRemoved,e6.removeCursor),eF.subscribe(ops.OdtDocument.signalOperationEnd,ec)}}(),gui.CaretManager=function(_,$){function ee(_){return eo.hasOwnProperty(_)?eo[_]:null}function et(){return Object.keys(eo).map(function(_){return eo[_]})}function en($){var ee=eo[$];ee&&(delete eo[$],$===_.getInputMemberId()?(ei.unsubscribe(ops.OdtDocument.signalProcessingBatchEnd,ee.ensureVisible),ei.unsubscribe(ops.Document.signalCursorMoved,ee.refreshCursorBlinking),es.unsubscribe("compositionupdate",ee.handleUpdate),es.unsubscribe("compositionend",ee.handleUpdate),es.unsubscribe("focus",ee.setFocus),es.unsubscribe("blur",ee.removeFocus),er.removeEventListener("focus",ee.show,!1),er.removeEventListener("blur",ee.hide,!1)):ei.unsubscribe(ops.OdtDocument.signalProcessingBatchEnd,ee.handleUpdate),ee.destroy(function(){}))}var eo={},er=runtime.getWindow(),ei=_.getSession().getOdtDocument(),es=_.getEventManager();this.registerCursor=function(ee,et,en){var el=ee.getMemberId();return ee=new gui.Caret(ee,$,et,en),eo[el]=ee,el===_.getInputMemberId()?(runtime.log("Starting to track input on new cursor of "+el),ei.subscribe(ops.OdtDocument.signalProcessingBatchEnd,ee.ensureVisible),ei.subscribe(ops.Document.signalCursorMoved,ee.refreshCursorBlinking),es.subscribe("compositionupdate",ee.handleUpdate),es.subscribe("compositionend",ee.handleUpdate),es.subscribe("focus",ee.setFocus),es.subscribe("blur",ee.removeFocus),er.addEventListener("focus",ee.show,!1),er.addEventListener("blur",ee.hide,!1),ee.setOverlayElement(es.getEventTrap())):ei.subscribe(ops.OdtDocument.signalProcessingBatchEnd,ee.handleUpdate),ee},this.getCaret=ee,this.getCarets=et,this.destroy=function($){var ee=et().map(function(_){return _.destroy});_.getSelectionController().setCaretXPositionLocator(null),ei.unsubscribe(ops.Document.signalCursorRemoved,en),eo={},core.Async.destroyAll(ee,$)},_.getSelectionController().setCaretXPositionLocator(function(){var $,et=ee(_.getInputMemberId());return et&&($=et.getBoundingClientRect()),$?$.right:void 0}),ei.subscribe(ops.Document.signalCursorRemoved,en)},gui.EditInfoHandle=function(_){var $,ee=[],et=_.ownerDocument,en=et.documentElement.namespaceURI;this.setEdits=function(_){var eo,er,ei,es;for(ee=_,core.DomUtils.removeAllChildNodes($),_=0;_<ee.length;_+=1)(eo=et.createElementNS(en,"div")).className="editInfo",(er=et.createElementNS(en,"span")).className="editInfoColor",er.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",ee[_].memberid),(ei=et.createElementNS(en,"span")).className="editInfoAuthor",ei.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",ee[_].memberid),(es=et.createElementNS(en,"span")).className="editInfoTime",es.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",ee[_].memberid),es.appendChild(et.createTextNode(ee[_].time.toString())),eo.appendChild(er),eo.appendChild(ei),eo.appendChild(es),$.appendChild(eo)},this.show=function(){$.style.display="block"},this.hide=function(){$.style.display="none"},this.destroy=function(ee){_.removeChild($),ee()},($=et.createElementNS(en,"div")).setAttribute("class","editInfoHandle"),$.style.display="none",_.appendChild($)},ops.EditInfo=function(_,$){function ee(){var _,$=[];for(_ in en)en.hasOwnProperty(_)&&$.push({memberid:_,time:en[_].time});return $.sort(function(_,$){return _.time-$.time}),$}var et,en={};this.getNode=function(){return et},this.getOdtDocument=function(){return $},this.getEdits=function(){return en},this.getSortedEdits=function(){return ee()},this.addEdit=function(_,$){en[_]={time:$}},this.clearEdits=function(){en={}},this.destroy=function($){_.parentNode&&_.removeChild(et),$()},et=$.getDOMDocument().createElementNS("urn:webodf:names:editinfo","editinfo"),_.insertBefore(et,_.firstChild)},gui.EditInfoMarker=function(_,$){function ee(_,$){return runtime.setTimeout(function(){eo.style.opacity=_},$)}var et,en,eo,er,ei,es,el=this;this.addEdit=function($,et){var el=Date.now()-et;_.addEdit($,et),en.setEdits(_.getSortedEdits()),eo.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",$),runtime.clearTimeout(ei),runtime.clearTimeout(es),1e4>el?(er=ee(1,0),ei=ee(.5,1e4-el),es=ee(.2,2e4-el)):1e4<=el&&2e4>el?(er=ee(.5,0),es=ee(.2,2e4-el)):er=ee(.2,0)},this.getEdits=function(){return _.getEdits()},this.clearEdits=function(){_.clearEdits(),en.setEdits([]),eo.hasAttributeNS("urn:webodf:names:editinfo","editinfo:memberid")&&eo.removeAttributeNS("urn:webodf:names:editinfo","editinfo:memberid")},this.getEditInfo=function(){return _},this.show=function(){eo.style.display="block"},this.hide=function(){el.hideHandle(),eo.style.display="none"},this.showHandle=function(){en.show()},this.hideHandle=function(){en.hide()},this.destroy=function($){runtime.clearTimeout(er),runtime.clearTimeout(ei),runtime.clearTimeout(es),et.removeChild(eo),en.destroy(function(ee){ee?$(ee):_.destroy($)})},function(){var ee=_.getOdtDocument().getDOMDocument();(eo=ee.createElementNS(ee.documentElement.namespaceURI,"div")).setAttribute("class","editInfoMarker"),eo.onmouseover=function(){el.showHandle()},eo.onmouseout=function(){el.hideHandle()},(et=_.getNode()).appendChild(eo),en=new gui.EditInfoHandle(et),$||el.hide()}()},gui.HyperlinkTooltipView=function(_,$){var ee,et,en,eo=core.DomUtils,er=odf.OdfUtils,ei=runtime.getWindow();runtime.assert(null!==ei,"Expected to be run in an environment which has a global window, like a browser."),this.showTooltip=function(es){var el,eu,ec=es.target||es.srcElement,ed=_.getSizer(),ef=_.getZoomLevel();e:{for(;ec;){if(er.isHyperlink(ec))break e;if(er.isParagraph(ec)||er.isInlineRoot(ec))break;ec=ec.parentNode}ec=null}if(ec){switch(eo.containsNode(ed,en)||ed.appendChild(en),eu=et,$()){case gui.KeyboardHandler.Modifier.Ctrl:el=runtime.tr("Ctrl-click to follow link");break;case gui.KeyboardHandler.Modifier.Meta:el=runtime.tr("-click to follow link");break;default:el=""}eu.textContent=el,ee.textContent=er.getHyperlinkTarget(ec),en.style.display="block",eu=ei.innerWidth-en.offsetWidth-15,ec=es.clientX>eu?eu:es.clientX+15,eu=ei.innerHeight-en.offsetHeight-10,es=es.clientY>eu?eu:es.clientY+10,ec=(ec-(ed=ed.getBoundingClientRect()).left)/ef,es=(es-ed.top)/ef,en.style.left=ec+"px",en.style.top=es+"px"}},this.hideTooltip=function(){en.style.display="none"},this.destroy=function(_){en.parentNode&&en.parentNode.removeChild(en),_()},function(){var $=_.getElement().ownerDocument;ee=$.createElement("span"),et=$.createElement("span"),ee.className="webodf-hyperlinkTooltipLink",et.className="webodf-hyperlinkTooltipText",(en=$.createElement("div")).className="webodf-hyperlinkTooltip",en.appendChild(ee),en.appendChild(et),_.getElement().appendChild(en)}()},gui.OdfFieldView=function(_){function $(){var _=odf.OdfSchema.getFields().map(function(_){return _.replace(":","|")}),$=_.join(",\n")+"\n{ background-color: #D0D0D0; }\n",_=_.map(function(_){return _+":empty::after"}).join(",\n")+"\n{ content:' '; white-space: pre; }\n";return $+"\n"+_}var ee,et=_.getElement().ownerDocument;this.showFieldHighlight=function(){ee.appendChild(et.createTextNode($()))},this.hideFieldHighlight=function(){for(var _=ee.sheet,$=_.cssRules;$.length;)_.deleteRule($.length-1)},this.destroy=function(_){ee.parentNode&&ee.parentNode.removeChild(ee),_()},ee=function(){var _=et.getElementsByTagName("head").item(0),$=et.createElement("style"),ee="";return $.type="text/css",$.media="screen, print, handheld, projection",odf.Namespaces.forEachPrefix(function(_,$){ee+="@namespace "+_+" url("+$+");\n"}),$.appendChild(et.createTextNode(ee)),_.appendChild($),$}()},gui.ShadowCursor=function(_){var $=_.getDOMDocument().createRange(),ee=!0;this.removeFromDocument=function(){},this.getMemberId=function(){return gui.ShadowCursor.ShadowCursorMemberId},this.getSelectedRange=function(){return $},this.setSelectedRange=function(_,et){$=_,ee=!1!==et},this.hasForwardSelection=function(){return ee},this.getDocument=function(){return _},this.getSelectionType=function(){return ops.OdtCursor.RangeSelection},$.setStart(_.getRootNode(),0)},gui.ShadowCursor.ShadowCursorMemberId="",gui.SelectionView=function(_){},gui.SelectionView.prototype.rerender=function(){},gui.SelectionView.prototype.show=function(){},gui.SelectionView.prototype.hide=function(){},gui.SelectionView.prototype.destroy=function(_){},gui.SelectionViewManager=function(_){function $(){return Object.keys(ee).map(function(_){return ee[_]})}var ee={};this.getSelectionView=function(_){return ee.hasOwnProperty(_)?ee[_]:null},this.getSelectionViews=$,this.removeSelectionView=function(_){ee.hasOwnProperty(_)&&(ee[_].destroy(function(){}),delete ee[_])},this.hideSelectionView=function(_){ee.hasOwnProperty(_)&&ee[_].hide()},this.showSelectionView=function(_){ee.hasOwnProperty(_)&&ee[_].show()},this.rerenderSelectionViews=function(){Object.keys(ee).forEach(function(_){ee[_].rerender()})},this.registerCursor=function($,et){var en=$.getMemberId(),eo=new _($);return et?eo.show():eo.hide(),ee[en]=eo},this.destroy=function(_){function ee($,en){en?_(en):$<et.length?et[$].destroy(function(_){ee($+1,_)}):_()}var et=$();ee(0,void 0)}},gui.SessionViewOptions=function(){this.caretBlinksOnRangeSelect=this.caretAvatarsInitiallyVisible=this.editInfoMarkersInitiallyVisible=!0},function(){function _(_,$){return void 0!==_?!!_:$}gui.SessionView=function($,ee,et,en,eo,er){function ei(_){_.memberId===ee&&eN.getViewport().scrollIntoView(_.annotation.getBoundingClientRect())}function es(){var _=document.getElementsByTagName("head").item(0),$=document.createElement("style");return $.type="text/css",$.media="screen, print, handheld, projection",_.appendChild($),$}function el(_,$,et){function en($,ee,et){ee=$+'[editinfo|memberid="'+_+'"]'+et+ee;e:{var en=ey.firstChild;for($=$+'[editinfo|memberid="'+_+'"]'+et+"{";en;){if(en.nodeType===Node.TEXT_NODE&&0===en.data.indexOf($)){$=en;break e}en=en.nextSibling}$=null}$?$.data=ee:ey.appendChild(document.createTextNode(ee))}en("div.editInfoMarker","{ background-color: "+et+"; }",""),en("span.editInfoColor","{ background-color: "+et+"; }",""),en("span.editInfoAuthor",'{ content: "'+$+'"; }',":before"),en("dc|creator","{ background-color: "+et+"; }",""),en(".webodf-selectionOverlay","{ fill: "+et+"; stroke: "+et+";}",""),_===ee&&(en(".webodf-touchEnabled .webodf-selectionOverlay","{ display: block; }"," > .webodf-draggable"),_=gui.ShadowCursor.ShadowCursorMemberId,en(".webodf-selectionOverlay","{ fill: "+et+"; stroke: "+et+";}",""),en(".webodf-touchEnabled .webodf-selectionOverlay","{ display: block; }"," > .webodf-draggable"))}function eu(_){var $,ee;for(ee in ex)ex.hasOwnProperty(ee)&&($=ex[ee],_?$.show():$.hide())}function ec(_){eo.getCarets().forEach(function($){_?$.showHandle():$.hideHandle()})}function ed(_){el(_.getMemberId(),(_=_.getProperties()).fullName,_.color)}function ef(_){var $=_.getMemberId(),ee=et.getOdtDocument().getMember($).getProperties();eo.registerCursor(_,eE,eT),er.registerCursor(_,!0),(_=eo.getCaret($))&&(_.setAvatarImageUrl(ee.imageUrl),_.setColor(ee.color)),runtime.log("+++ View here +++ eagerly created an Caret for '"+$+"'! +++")}function ep(_){_=_.getMemberId();var $=er.getSelectionView(ee),et=er.getSelectionView(gui.ShadowCursor.ShadowCursorMemberId),en=eo.getCaret(ee);_===ee?(et.hide(),$&&$.show(),en&&en.show()):_===gui.ShadowCursor.ShadowCursorMemberId&&(et.show(),$&&$.hide(),en&&en.hide())}function em(_){er.removeSelectionView(_)}function eh(_){var $=_.paragraphElement,ee=_.memberId;_=_.timeStamp;var en,eo="",er=$.getElementsByTagNameNS("urn:webodf:names:editinfo","editinfo").item(0);er?en=ex[eo=er.getAttributeNS("urn:webodf:names:editinfo","id")]:(eo=Math.random().toString(),en=new ops.EditInfo($,et.getOdtDocument()),en=new gui.EditInfoMarker(en,ew),(er=$.getElementsByTagNameNS("urn:webodf:names:editinfo","editinfo").item(0)).setAttributeNS("urn:webodf:names:editinfo","id",eo),ex[eo]=en),en.addEdit(ee,new Date(_)),eC.trigger()}function eg(){var _;ev.hasChildNodes()&&core.DomUtils.removeAllChildNodes(ev),!0===en.getState(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN)&&(_=et.getOdtDocument().getMember(ee))&&(_=_.getProperties().fullName,ev.appendChild(document.createTextNode(".annotationWrapper:not([creator = '"+_+"']) .annotationRemoveButton { display: none; }")))}function eb(_){var $=Object.keys(ex).map(function(_){return ex[_]});eS.unsubscribe(ops.Document.signalMemberAdded,ed),eS.unsubscribe(ops.Document.signalMemberUpdated,ed),eS.unsubscribe(ops.Document.signalCursorAdded,ef),eS.unsubscribe(ops.Document.signalCursorRemoved,em),eS.unsubscribe(ops.OdtDocument.signalParagraphChanged,eh),eS.unsubscribe(ops.Document.signalCursorMoved,ep),eS.unsubscribe(ops.OdtDocument.signalParagraphChanged,er.rerenderSelectionViews),eS.unsubscribe(ops.OdtDocument.signalTableAdded,er.rerenderSelectionViews),eS.unsubscribe(ops.OdtDocument.signalParagraphStyleModified,er.rerenderSelectionViews),en.unsubscribe(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN,eg),eS.unsubscribe(ops.Document.signalMemberAdded,eg),eS.unsubscribe(ops.Document.signalMemberUpdated,eg),ey.parentNode.removeChild(ey),ev.parentNode.removeChild(ev),function ee(et,en){en?_(en):et<$.length?$[et].destroy(function(_){ee(et+1,_)}):_()}(0,void 0)}var ey,ev,eS,eN,eC,ex={},ew=_($.editInfoMarkersInitiallyVisible,!0),eE=_($.caretAvatarsInitiallyVisible,!0),eT=_($.caretBlinksOnRangeSelect,!0);this.showEditInfoMarkers=function(){ew||eu(ew=!0)},this.hideEditInfoMarkers=function(){ew&&eu(ew=!1)},this.showCaretAvatars=function(){eE||ec(eE=!0)},this.hideCaretAvatars=function(){eE&&ec(eE=!1)},this.getSession=function(){return et},this.getCaret=function(_){return eo.getCaret(_)},this.destroy=function(_){var $=[eC.destroy,eb];eS.unsubscribe(ops.OdtDocument.signalAnnotationAdded,ei),core.Async.destroyAll($,_)},eN=(eS=et.getOdtDocument()).getOdfCanvas(),eS.subscribe(ops.OdtDocument.signalAnnotationAdded,ei),eS.subscribe(ops.Document.signalMemberAdded,ed),eS.subscribe(ops.Document.signalMemberUpdated,ed),eS.subscribe(ops.Document.signalCursorAdded,ef),eS.subscribe(ops.Document.signalCursorRemoved,em),eS.subscribe(ops.OdtDocument.signalParagraphChanged,eh),eS.subscribe(ops.Document.signalCursorMoved,ep),eS.subscribe(ops.OdtDocument.signalParagraphChanged,er.rerenderSelectionViews),eS.subscribe(ops.OdtDocument.signalTableAdded,er.rerenderSelectionViews),eS.subscribe(ops.OdtDocument.signalParagraphStyleModified,er.rerenderSelectionViews),en.subscribe(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN,eg),eS.subscribe(ops.Document.signalMemberAdded,eg),eS.subscribe(ops.Document.signalMemberUpdated,eg),(ey=es()).appendChild(document.createTextNode("@namespace editinfo url(urn:webodf:names:editinfo);")),ey.appendChild(document.createTextNode("@namespace dc url(http://purl.org/dc/elements/1.1/);")),ev=es(),eg(),eC=core.Task.createRedrawTask(function(){var _=eN.getAnnotationViewManager();_&&(_.rehighlightAnnotations(),eS.fixCursorPositions())})}}(),gui.SvgSelectionView=function(_){function $(){var _=em.getRootNode();ed!==_&&(ed=_,(ef=em.getCanvas().getSizer()).appendChild(eg),eg.setAttribute("class","webodf-selectionOverlay"),ey.setAttribute("class","webodf-draggable"),ev.setAttribute("class","webodf-draggable"),ey.setAttribute("end","left"),ev.setAttribute("end","right"),ey.setAttribute("r",8),ev.setAttribute("r",8),eg.appendChild(eb),eg.appendChild(ey),eg.appendChild(ev))}function ee(_){return!!((_=_.getBoundingClientRect())&&0!==_.height)}function et(_){var $,et=eS.getTextElements(_,!0,!1),en=_.cloneRange(),eo=_.cloneRange();if(_=_.cloneRange(),!et.length)return null;e:{var er=et[$=0],ei=en.startContainer===er?en.startOffset:0,es=ei;for(en.setStart(er,ei),en.setEnd(er,es);!ee(en);){if(er.nodeType===Node.ELEMENT_NODE&&es<er.childNodes.length)es=er.childNodes.length;else if(er.nodeType===Node.TEXT_NODE&&es<er.length)es+=1;else if(et[$])er=et[$],$+=1,ei=es=0;else{$=!1;break e}en.setStart(er,ei),en.setEnd(er,es)}$=!0}if(!$)return null;e:{for($=et.length-1,er=et[$],es=ei=eo.endContainer===er?eo.endOffset:er.nodeType===Node.TEXT_NODE?er.length:er.childNodes.length,eo.setStart(er,ei),eo.setEnd(er,es);!ee(eo);){if(er.nodeType===Node.ELEMENT_NODE&&0<ei)ei=0;else if(er.nodeType===Node.TEXT_NODE&&0<ei)--ei;else if(et[$])er=et[$],--$,ei=es=er.length||er.childNodes.length;else{et=!1;break e}eo.setStart(er,ei),eo.setEnd(er,es)}et=!0}return et?(_.setStart(en.startContainer,en.startOffset),_.setEnd(eo.endContainer,eo.endOffset),{firstRange:en,lastRange:eo,fillerRange:_}):null}function en(_,$){var ee={};return ee.top=Math.min(_.top,$.top),ee.left=Math.min(_.left,$.left),ee.right=Math.max(_.right,$.right),ee.bottom=Math.max(_.bottom,$.bottom),ee.width=ee.right-ee.left,ee.height=ee.bottom-ee.top,ee}function eo(_,$){return $&&0<$.width&&0<$.height&&(_=_?en(_,$):$),_}function er(_){function $(_){return ew.setUnfilteredPosition(_,0),eb.acceptNode(_)===eE&&ei.acceptPosition(ew)===eE?eE:eT}function ee(_){var ee=null;return $(_)===eE&&(ee=eN.getBoundingClientRect(_)),ee}var et,en,er,ei,es,el=_.commonAncestorContainer,eu=_.startContainer,ec=_.endContainer,ed=_.startOffset,ef=_.endOffset,ep=null,eg=eh.createRange(),eb=new odf.OdfNodeFilter;if(eu===el||ec===el)return ep=(eg=_.cloneRange()).getBoundingClientRect(),eg.detach(),ep;for(_=eu;_.parentNode!==el;)_=_.parentNode;for(en=ec;en.parentNode!==el;)en=en.parentNode;for(ei=em.createRootFilter(eu),el=_.nextSibling;el&&el!==en;)ep=eo(ep,er=ee(el)),el=el.nextSibling;if(eS.isParagraph(_))ep=eo(ep,eN.getBoundingClientRect(_));else if(_.nodeType===Node.TEXT_NODE)el=_,eg.setStart(el,ed),eg.setEnd(el,el===en?ef:el.length),ep=eo(ep,er=eg.getBoundingClientRect());else for(el=(es=eh.createTreeWalker(_,NodeFilter.SHOW_TEXT,$,!1)).currentNode=eu;el&&el!==ec;)eg.setStart(el,ed),eg.setEnd(el,el.length),ep=eo(ep,er=eg.getBoundingClientRect()),et=el,ed=0,el=es.nextNode();if(et||(et=eu),eS.isParagraph(en))ep=eo(ep,eN.getBoundingClientRect(en));else if(en.nodeType===Node.TEXT_NODE)el=en,eg.setStart(el,el===_?ed:0),eg.setEnd(el,ef),ep=eo(ep,er=eg.getBoundingClientRect());else for(el=(es=eh.createTreeWalker(en,NodeFilter.SHOW_TEXT,$,!1)).currentNode=ec;el&&el!==et;)eg.setStart(el,0),eg.setEnd(el,ef),ep=eo(ep,er=eg.getBoundingClientRect()),(el=es.previousNode())&&(ef=el.length);return ep}function ei(_,$){var ee=_.getBoundingClientRect(),et={width:0};return et.top=ee.top,et.bottom=ee.bottom,et.height=ee.height,et.left=et.right=$?ee.right:ee.left,et}function es(){var ee,eo=_.getSelectedRange();if(ee=ex&&_.getSelectionType()===ops.OdtCursor.RangeSelection&&!eo.collapsed){$();var es,el,eu,ec,ed,ep,em,eh=eN.getBoundingClientRect(ef),eS=eC.getZoomLevel(),eo=et(eo);if(eo){for(es=0,ee=eo.firstRange,el=eo.lastRange,eu=eo.fillerRange,ec=eN.translateRect(ei(ee,!1),eh,eS),ep=eN.translateRect(ei(el,!0),eh,eS),em=(ed=(ed=er(eu))?eN.translateRect(ed,eh,eS):en(ec,ep)).left,ed=ec.left+Math.max(0,ed.width-(ec.left-ed.left)),eh=Math.min(ec.top,ep.top),eS=ep.top+ep.height,em=[{x:ec.left,y:eh+ec.height},{x:ec.left,y:eh},{x:ed,y:eh},{x:ed,y:eS-ep.height},{x:ep.right,y:eS-ep.height},{x:ep.right,y:eS},{x:em,y:eS},{x:em,y:eh+ec.height},{x:ec.left,y:eh+ec.height}],ed="";es<em.length;es+=1)ed+=em[es].x+","+em[es].y+" ";eb.setAttribute("points",ed),ey.setAttribute("cx",ec.left),ey.setAttribute("cy",eh+ec.height/2),ev.setAttribute("cx",ep.right),ev.setAttribute("cy",eS-ep.height/2),ee.detach(),el.detach(),eu.detach()}ee=!!eo}eg.style.display=ee?"block":"none"}function el($){ex&&$===_&&ep.trigger()}function eu(_){_=8/_,ey.setAttribute("r",_),ev.setAttribute("r",_)}function ec($){ef.removeChild(eg),ef.classList.remove("webodf-virtualSelections"),_.getDocument().unsubscribe(ops.Document.signalCursorMoved,el),eC.unsubscribe(gui.ZoomHelper.signalZoomChanged,eu),$()}var ed,ef,ep,em=_.getDocument(),eh=em.getDOMDocument(),eg=eh.createElementNS("http://www.w3.org/2000/svg","svg"),eb=eh.createElementNS("http://www.w3.org/2000/svg","polygon"),ey=eh.createElementNS("http://www.w3.org/2000/svg","circle"),ev=eh.createElementNS("http://www.w3.org/2000/svg","circle"),eS=odf.OdfUtils,eN=core.DomUtils,eC=em.getCanvas().getZoomHelper(),ex=!0,ew=_.getDocument().createPositionIterator(em.getRootNode()),eE=NodeFilter.FILTER_ACCEPT,eT=NodeFilter.FILTER_REJECT;this.rerender=function(){ex&&ep.trigger()},this.show=function(){ex=!0,ep.trigger()},this.hide=function(){ex=!1,ep.trigger()},this.destroy=function(_){core.Async.destroyAll([ep.destroy,ec],_)},function(){var ee=_.getMemberId();ep=core.Task.createRedrawTask(es),$(),eg.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",ee),ef.classList.add("webodf-virtualSelections"),_.getDocument().subscribe(ops.Document.signalCursorMoved,el),eC.subscribe(gui.ZoomHelper.signalZoomChanged,eu),eu(eC.getZoomLevel())}()},gui.UndoStateRules=function(){function _(_,$){var ee=_.length;this.previous=function(){for(--ee;0<=ee;--ee)if($(_[ee]))return _[ee];return null}}function $(_){var $;return(_=_.spec()).hasOwnProperty("position")&&($=_.position),$}function ee(_){return _.isEdit}function et(_,ee,et){return et?(_=$(_),ee=$(ee),et=$(et),_-ee==ee-et):0==(et=$(_)-$(ee))||1===Math.abs(et)}this.isEditOperation=ee,this.isPartOfOperationSet=function($,en){var eo,er=void 0!==$.group;if(!$.isEdit||0===en.length||(eo=en[en.length-1],er&&$.group===eo.group))return!0;e:switch($.spec().optype){case"RemoveText":case"InsertText":eo=!0;break e;default:eo=!1}if(eo&&en.some(ee)){if(er){er=$.spec().optype;var ei,es,el,eu=(eo=new _(en,ee)).previous(),ec=null;for(runtime.assert(!!eu,"No edit operations found in state"),el=eu.group,runtime.assert(void 0!==el,"Operation has no group"),es=1;eu&&eu.group===el;){if(er===eu.spec().optype){ei=eu;break}eu=eo.previous()}if(ei){for(eu=eo.previous();eu;){if(eu.group!==el){if(2===es)break;el=eu.group,es+=1}if(er===eu.spec().optype){ec=eu;break}eu=eo.previous()}ei=et($,ei,ec)}else ei=!1;return ei}return ei=$.spec().optype,eo=(er=new _(en,ee)).previous(),runtime.assert(!!eo,"No edit operations found in state"),ei=ei===eo.spec().optype&&et($,eo,er.previous())}return!1}},function(){function _(_,$){this.mainId=void 0!==_?_:-1,this.subId=void 0!==$?$:-1}function $($,et,en){var eo,er,ei;function es(_,ee){return _+($.isEditOperation(ee)?1:0)}this.addOperation=function(_){$.isEditOperation(_)&&(ei+=1),er.push(_)},this.isNextStateId=function(_){return _.mainId===eo&&_.subId===ei},this.getNextStateId=function(){return new _(eo,ei)},this.getOperations=function(){return er},eo=ee+=1,er=et||[],ei=et&&en?et.reduce(es,0):0}var ee=0;gui.TrivialUndoManager=function(ee){function et(){return!0!==eg.isNextStateId(eh)}function en(_){0<(_=_.getOperations()).length&&(ex=!0,ep(_),ex=!1)}function eo(){eN.emit(gui.UndoManager.signalUndoStackChanged,{undoAvailable:eb.hasUndoStates(),redoAvailable:eb.hasRedoStates()})}function er(_){var $=et();_!==$&&eN.emit(gui.UndoManager.signalDocumentModifiedChanged,$)}function ei(){eg!==ef&&eg!==ev[ev.length-1]&&ev.push(eg)}function es(_){var $=_.previousSibling||_.nextSibling;_.parentNode.removeChild(_),ey.normalizeTextNodes($)}function el(_){return Object.keys(_).map(function($){return _[$]})}function eu(_){function ee(_){var $=_.spec();if(ei[$.memberid])switch($.optype){case"AddCursor":eo[$.memberid]||(eo[$.memberid]=_,delete ei[$.memberid],--et);break;case"MoveCursor":er[$.memberid]||(er[$.memberid]=_)}}var et,en,eo={},er={},ei={};for(en=_.pop(),em.getMemberIds().forEach(function(_){ei[_]=!0}),et=Object.keys(ei).length;en&&0<et;)(en=en.getOperations()).reverse(),en.forEach(ee),en=_.pop();return new $(eC,el(eo).concat(el(er)))}function ec(){var _=et(),$=ed=em.cloneDocumentElement();ey.getElementsByTagNameNS($,"urn:webodf:names:cursor","cursor").forEach(es),ey.getElementsByTagNameNS($,"urn:webodf:names:cursor","anchor").forEach(es),ei(),eg=ef=eu([ef].concat(ev)),ev.length=0,eS.length=0,_||(eh=eg.getNextStateId()),eo(),er(_)}var ed,ef,ep,em,eh,eg,eb=this,ey=core.DomUtils,ev=[],eS=[],eN=new core.EventNotifier([gui.UndoManager.signalUndoStackChanged,gui.UndoManager.signalUndoStateCreated,gui.UndoManager.signalUndoStateModified,gui.UndoManager.signalDocumentModifiedChanged,gui.TrivialUndoManager.signalDocumentRootReplaced]),eC=ee||new gui.UndoStateRules,ex=!1;this.subscribe=function(_,$){eN.subscribe(_,$)},this.unsubscribe=function(_,$){eN.unsubscribe(_,$)},this.isDocumentModified=et,this.setDocumentModified=function($){et()!==$&&(eh=$?new _:eg.getNextStateId(),eN.emit(gui.UndoManager.signalDocumentModifiedChanged,$))},this.hasUndoStates=function(){return 0<ev.length},this.hasRedoStates=function(){return 0<eS.length},this.setDocument=function(_){em=_},this.purgeInitialState=function(){var _=et();ev.length=0,eS.length=0,eh=(eg=ef=new $(eC)).getNextStateId(),ed=null,eo(),er(_)},this.setInitialState=ec,this.initialize=function(){ed||ec()},this.setPlaybackFunction=function(_){ep=_},this.onOperationExecuted=function(_){if(!ex){var ee=et();eC.isEditOperation(_)&&(eg===ef||0<eS.length)||!eC.isPartOfOperationSet(_,eg.getOperations())?(eS.length=0,ei(),eg=new $(eC,[_],!0),ev.push(eg),eN.emit(gui.UndoManager.signalUndoStateCreated,{operations:eg.getOperations()}),eo()):(eg.addOperation(_),eN.emit(gui.UndoManager.signalUndoStateModified,{operations:eg.getOperations()})),er(ee)}},this.moveForward=function(_){for(var $,ee=0,ei=et();_&&eS.length;)$=eS.pop(),ev.push($),en($),--_,ee+=1;return ee&&(eg=ev[ev.length-1],eo(),er(ei)),ee},this.moveBackward=function(_){for(var $=0,ee=et();_&&ev.length;)eS.push(ev.pop()),--_,$+=1;return $&&(em.getMemberIds().forEach(function(_){em.hasCursor(_)&&em.removeCursor(_)}),em.setDocumentElement(ed.cloneNode(!0)),eN.emit(gui.TrivialUndoManager.signalDocumentRootReplaced,{}),en(ef),ev.forEach(en),eg=ev[ev.length-1]||ef,eo(),er(ee)),$},eh=(eg=ef=new $(eC)).getNextStateId()},gui.TrivialUndoManager.signalDocumentRootReplaced="documentRootReplaced"}(),odf.GraphicProperties=function(_,$,ee){var et=this,en=odf.Namespaces.stylens,eo=odf.Namespaces.svgns;this.verticalPos=function(){return et.data.value("verticalPos")},this.verticalRel=function(){return et.data.value("verticalRel")},this.horizontalPos=function(){return et.data.value("horizontalPos")},this.horizontalRel=function(){return et.data.value("horizontalRel")},this.strokeWidth=function(){return et.data.value("strokeWidth")},et.data=new odf.LazyStyleProperties(void 0===ee?void 0:ee.data,{verticalPos:function(){var $=_.getAttributeNS(en,"vertical-pos");return""===$?void 0:$},verticalRel:function(){var $=_.getAttributeNS(en,"vertical-rel");return""===$?void 0:$},horizontalPos:function(){var $=_.getAttributeNS(en,"horizontal-pos");return""===$?void 0:$},horizontalRel:function(){var $=_.getAttributeNS(en,"horizontal-rel");return""===$?void 0:$},strokeWidth:function(){var ee=_.getAttributeNS(eo,"stroke-width");return $.parseLength(ee)}})},odf.ComputedGraphicProperties=function(){var _;this.setGraphicProperties=function($){_=$},this.verticalPos=function(){return _&&_.verticalPos()||"from-top"},this.verticalRel=function(){return _&&_.verticalRel()||"page"},this.horizontalPos=function(){return _&&_.horizontalPos()||"from-left"},this.horizontalRel=function(){return _&&_.horizontalRel()||"page"}},odf.PageLayoutProperties=function(_,$,ee){var et=this,en=odf.Namespaces.fons;this.pageHeight=function(){return et.data.value("pageHeight")||1123},this.pageWidth=function(){return et.data.value("pageWidth")||794},et.data=new odf.LazyStyleProperties(void 0===ee?void 0:ee.data,{pageHeight:function(){var ee;return _&&(ee=_.getAttributeNS(en,"page-height"),ee=$.parseLength(ee)),ee},pageWidth:function(){var ee;return _&&(ee=_.getAttributeNS(en,"page-width"),ee=$.parseLength(ee)),ee}})},odf.PageLayout=function(_,$,ee){var et=null;_&&(et=$.getPropertiesElement("page-layout-properties",_)),this.pageLayout=new odf.PageLayoutProperties(et,$,ee&&ee.pageLayout)},odf.PageLayoutCache=function(){},odf.PageLayoutCache.prototype.getPageLayout=function(_){},odf.PageLayoutCache.prototype.getDefaultPageLayout=function(){},odf.ParagraphProperties=function(_,$,ee){var et=this,en=odf.Namespaces.fons;this.marginTop=function(){return et.data.value("marginTop")},et.data=new odf.LazyStyleProperties(void 0===ee?void 0:ee.data,{marginTop:function(){var et=_.getAttributeNS(en,"margin-top");return $.parsePositiveLengthOrPercent(et,"marginTop",ee&&ee.data)}})},odf.ComputedParagraphProperties=function(){var _={},$=[];this.setStyleChain=function(ee){$=ee,_={}},this.marginTop=function(){var ee,et;if(_.hasOwnProperty("marginTop"))ee=_.marginTop;else{for(et=0;void 0===ee&&et<$.length;et+=1)ee=$[et].marginTop();_.marginTop=ee}return ee||0}},odf.TextProperties=function(_,$,ee){var et=this,en=odf.Namespaces.fons;this.fontSize=function(){return et.data.value("fontSize")},et.data=new odf.LazyStyleProperties(void 0===ee?void 0:ee.data,{fontSize:function(){var et=_.getAttributeNS(en,"font-size");return $.parsePositiveLengthOrPercent(et,"fontSize",ee&&ee.data)}})},odf.ComputedTextProperties=function(){var _={},$=[];this.setStyleChain=function(ee){$=ee,_={}},this.fontSize=function(){var ee,et;if(_.hasOwnProperty("fontSize"))ee=_.fontSize;else{for(et=0;void 0===ee&&et<$.length;et+=1)ee=$[et].fontSize();_.fontSize=ee}return ee||12}},odf.MasterPage=function(_,$){var ee;_?(ee=_.getAttributeNS(odf.Namespaces.stylens,"page-layout-name"),this.pageLayout=$.getPageLayout(ee)):this.pageLayout=$.getDefaultPageLayout()},odf.MasterPageCache=function(){},odf.MasterPageCache.prototype.getMasterPage=function(_){},odf.StylePileEntry=function(_,$,ee,et){this.masterPage=function(){var $=_.getAttributeNS(odf.Namespaces.stylens,"master-page-name"),et=null;return $&&(et=ee.getMasterPage($)),et},function(ee){var en=_.getAttributeNS(odf.Namespaces.stylens,"family"),eo=null;("graphic"===en||"chart"===en)&&(ee.graphic=void 0===et?void 0:et.graphic,null!==(eo=$.getPropertiesElement("graphic-properties",_,eo))&&(ee.graphic=new odf.GraphicProperties(eo,$,ee.graphic))),("paragraph"===en||"table-cell"===en||"graphic"===en||"presentation"===en||"chart"===en)&&(ee.paragraph=void 0===et?void 0:et.paragraph,null!==(eo=$.getPropertiesElement("paragraph-properties",_,eo))&&(ee.paragraph=new odf.ParagraphProperties(eo,$,ee.paragraph))),("text"===en||"paragraph"===en||"table-cell"===en||"graphic"===en||"presentation"===en||"chart"===en)&&(ee.text=void 0===et?void 0:et.text,null!==(eo=$.getPropertiesElement("text-properties",_,eo))&&(ee.text=new odf.TextProperties(eo,$,ee.text)))}(this)},odf.StylePile=function(_,$){function ee(ee,et){var er,ei;return ee.hasAttributeNS(eo,"parent-style-name")&&(ei=ee.getAttributeNS(eo,"parent-style-name"),-1===et.indexOf(ei)&&(er=en(ei,et))),new odf.StylePileEntry(ee,_,$,er)}var et,en,eo=odf.Namespaces.stylens,er={},ei={},es={},el={};en=function(_,$){var et,en=es[_];return!en&&(et=er[_])&&($.push(_),en=ee(et,$),es[_]=en),en},this.getStyle=function(_){var $,et=el[_]||es[_],en=[];return et||(($=ei[_])||($=er[_])&&en.push(_),$&&(et=ee($,en))),et},this.addCommonStyle=function(_){var $;_.hasAttributeNS(eo,"name")&&($=_.getAttributeNS(eo,"name"),er.hasOwnProperty($)||(er[$]=_))},this.addAutomaticStyle=function(_){var $;_.hasAttributeNS(eo,"name")&&($=_.getAttributeNS(eo,"name"),ei.hasOwnProperty($)||(ei[$]=_))},this.setDefaultStyle=function(_){void 0===et&&(et=ee(_,[]))},this.getDefaultStyle=function(){return et}},odf.ComputedGraphicStyle=function(){this.text=new odf.ComputedTextProperties,this.paragraph=new odf.ComputedParagraphProperties,this.graphic=new odf.ComputedGraphicProperties},odf.ComputedParagraphStyle=function(){this.text=new odf.ComputedTextProperties,this.paragraph=new odf.ComputedParagraphProperties},odf.ComputedTextStyle=function(){this.text=new odf.ComputedTextProperties},odf.StyleCache=function(_){function $(_,$,ee,et){var en;if($=ee.getAttributeNS($,"class-names"))for($=$.split(" "),en=0;en<$.length;en+=1)(ee=$[en])&&(et.push(_),et.push(ee))}function ee(_,ee){var et=ey.getStyleName("paragraph",_);return void 0!==et&&(ee.push("paragraph"),ee.push(et)),_.namespaceURI!==eg||"h"!==_.localName&&"p"!==_.localName||$("paragraph",eg,_,ee),ee}function et(_,$,ee){var et,en,eo,ei,es=[];for(et=0;et<_.length;et+=2)eo=_[et],ei=_[et+1],void 0!==(ei=(eo=er[eo]).getStyle(ei))&&void 0!==(ei=ei[$])&&ei!==en&&(es.push(ei),en=ei);return(ei=(eo=er[ee]).getDefaultStyle())&&void 0!==(ei=ei[$])&&ei!==en&&es.push(ei),es}function en(et,eo){var er=ey.getStyleName("text",et),ei=et.parentNode;return void 0!==er&&(eo.push("text"),eo.push(er)),"span"===et.localName&&et.namespaceURI===eg&&$("text",eg,et,eo),ei&&ei!==_&&(ei.namespaceURI!==eg||"p"!==ei.localName&&"h"!==ei.localName?en(ei,eo):ee(ei,eo)),eo}function eo(_){return er[_=_.getAttributeNS(eb,"family")]}var er,ei,es,el,eu,ec,ed,ef,ep,em,eh=this,eg=odf.Namespaces.textns,eb=odf.Namespaces.stylens,ey=new odf.StyleInfo,ev=new odf.StyleParseUtils;this.getComputedGraphicStyle=function(_){var $=[];void 0!==(_=ey.getStyleName("graphic",_))&&($.push("graphic"),$.push(_));var ee=el[_=$.join("/")];return runtime.assert(0==$.length%2,"Invalid style chain."),void 0===ee&&((ee=new odf.ComputedGraphicStyle).graphic.setGraphicProperties(et($,"graphic","graphic")[0]),ee.text.setStyleChain(et($,"text","graphic")),ee.paragraph.setStyleChain(et($,"paragraph","graphic")),el[_]=ee),ee},this.getComputedParagraphStyle=function(_){var $=(_=ee(_,[])).join("/"),en=es[$];return runtime.assert(0==_.length%2,"Invalid style chain."),void 0===en&&((en=new odf.ComputedParagraphStyle).text.setStyleChain(et(_,"text","paragraph")),en.paragraph.setStyleChain(et(_,"paragraph","paragraph")),es[$]=en),en},this.getComputedTextStyle=function(_){var $=(_=en(_,[])).join("/"),ee=ei[$];return runtime.assert(0==_.length%2,"Invalid style chain."),void 0===ee&&((ee=new odf.ComputedTextStyle).text.setStyleChain(et(_,"text","text")),ei[$]=ee),ee},this.getPageLayout=function(_){var $=em[_];return $||(($=ep[_])?($=new odf.PageLayout($,ev,ef),em[_]=$):$=ef),$},this.getDefaultPageLayout=function(){return ef},this.getMasterPage=function(_){var $=ec[_];return void 0===$&&(($=eu[_])?($=new odf.MasterPage($,eh),ec[_]=$):$=null),$},this.getDefaultMasterPage=function(){return ed},this.update=function(){var $,ee,et=null,en=null;for(ei={},es={},el={},eu={},ec={},em={},ep={},er={text:new odf.StylePile(ev,eh),paragraph:new odf.StylePile(ev,eh),graphic:new odf.StylePile(ev,eh)},$=_.styles.firstElementChild;$;)$.namespaceURI===eb&&((ee=eo($))?"style"===$.localName?ee.addCommonStyle($):"default-style"===$.localName&&ee.setDefaultStyle($):"default-page-layout"===$.localName&&(et=$)),$=$.nextElementSibling;for(ef=new odf.PageLayout(et,ev),$=_.automaticStyles.firstElementChild;$;)$.namespaceURI===eb&&((ee=eo($))&&"style"===$.localName?ee.addAutomaticStyle($):"page-layout"===$.localName&&(ep[$.getAttributeNS(eb,"name")]=$)),$=$.nextElementSibling;for($=_.masterStyles.firstElementChild;$;)$.namespaceURI===eb&&"master-page"===$.localName&&(en=en||$,0<(et=(ee=$).getAttributeNS(eb,"name")).length&&!eu.hasOwnProperty(et)&&(eu[et]=ee)),$=$.nextElementSibling;ed=new odf.MasterPage(en,eh)}},ops.OperationTransformMatrix=function(){var _;function $(_){_.position+=_.length,_.length*=-1}function ee(_){var ee=0>_.length;return ee&&$(_),ee}function et(_,$){function ee(ee){_[ee]===$&&et.push(ee)}var et=[];return _&&["style:parent-style-name","style:next-style-name"].forEach(ee),et}function en(_,$){function ee(ee){_[ee]===$&&delete _[ee]}_&&["style:parent-style-name","style:next-style-name"].forEach(ee)}function eo(_){var $={};return Object.keys(_).forEach(function(ee){$[ee]="object"==typeof _[ee]?eo(_[ee]):_[ee]}),$}function er(_,$,ee,et){var en,eo,er=!1,ei=!1,es=[];if(et&&et.attributes&&(es=et.attributes.split(",")),_&&(ee||0<es.length)&&Object.keys(_).forEach(function($){var et,en=_[$];"object"!=typeof en&&(ee&&(et=ee[$]),void 0!==et?(delete _[$],ei=!0,et===en&&(delete ee[$],er=!0)):-1!==es.indexOf($)&&(delete _[$],ei=!0))}),$&&$.attributes&&(ee||0<es.length)){for(et=0,eo=$.attributes.split(",");et<eo.length;et+=1)en=eo[et],(ee&&void 0!==ee[en]||es&&-1!==es.indexOf(en))&&(eo.splice(et,1),--et,ei=!0);0<eo.length?$.attributes=eo.join(","):delete $.attributes}return{majorChanged:er,minorChanged:ei}}function ei(_){for(var $ in _)if(_.hasOwnProperty($))return!0;return!1}function es(_){for(var $ in _)if(_.hasOwnProperty($)&&("attributes"!==$||0<_.attributes.length))return!0;return!1}function el(_,$,ee,et,en){var eo,el=_?_[en]:null,eu=$?$[en]:null,ec=ee?ee[en]:null,ed=et?et[en]:null;return eo=er(el,eu,ec,ed),el&&!ei(el)&&delete _[en],eu&&!es(eu)&&delete $[en],ec&&!ei(ec)&&delete ee[en],ed&&!es(ed)&&delete et[en],eo}function eu(_,$){return{opSpecsA:[_],opSpecsB:[$]}}_={AddAnnotation:{AddAnnotation:function(_,$,ee){var et;return _.position<$.position?(et=_,ee=$):$.position<_.position?(et=$,ee=_):(et=ee?_:$,ee=ee?$:_),ee.position<et.position+et.length&&(et.length+=2),ee.position+=2,{opSpecsA:[_],opSpecsB:[$]}},AddCursor:eu,AddMember:eu,AddStyle:eu,ApplyDirectStyling:function(_,$){return _.position<=$.position?$.position+=2:_.position<=$.position+$.length&&($.length+=2),{opSpecsA:[_],opSpecsB:[$]}},InsertText:function(_,$){return $.position<=_.position?_.position+=$.text.length:(void 0!==_.length&&$.position<=_.position+_.length&&(_.length+=$.text.length),$.position+=2),{opSpecsA:[_],opSpecsB:[$]}},MergeParagraph:function(_,$){return $.sourceStartPosition<=_.position?--_.position:(void 0!==_.length&&$.sourceStartPosition<=_.position+_.length&&--_.length,$.sourceStartPosition+=2,_.position<$.destinationStartPosition&&($.destinationStartPosition+=2)),{opSpecsA:[_],opSpecsB:[$]}},MoveCursor:function(_,et){var en=ee(et);return _.position<et.position?et.position+=2:_.position<et.position+et.length&&(et.length+=2),en&&$(et),{opSpecsA:[_],opSpecsB:[et]}},RemoveAnnotation:function(_,$){return _.position<$.position?($.position<_.position+_.length&&(_.length-=$.length+2),$.position+=2):_.position-=$.length+2,{opSpecsA:[_],opSpecsB:[$]}},RemoveCursor:eu,RemoveMember:eu,RemoveStyle:eu,RemoveText:function(_,$){var ee,et=$.position,en=$.position+$.length,eo=[_],er=[$];return _.position<=$.position?$.position+=2:_.position<en&&($.length=_.position-$.position,er.unshift(ee={optype:"RemoveText",memberid:$.memberid,timestamp:$.timestamp,position:_.position+2,length:en-_.position})),$.position+$.length<=_.position?(_.position-=$.length,void 0!==_.length&&ee&&(_.length=ee.length>=_.length?0:_.length-ee.length)):void 0!==_.length&&(en<=(ee=_.position+_.length)?_.length-=$.length:et<ee&&(_.length=et-_.position)),{opSpecsA:eo,opSpecsB:er}},SetParagraphStyle:function(_,$){return _.position<$.position&&($.position+=2),{opSpecsA:[_],opSpecsB:[$]}},SplitParagraph:function(_,$){return _.position<$.sourceParagraphPosition&&($.sourceParagraphPosition+=2),$.position<=_.position?_.position+=1:(void 0!==_.length&&$.position<=_.position+_.length&&(_.length+=1),$.position+=2),{opSpecsA:[_],opSpecsB:[$]}},UpdateMember:eu,UpdateMetadata:eu,UpdateParagraphStyle:eu},AddCursor:{AddCursor:eu,AddMember:eu,AddStyle:eu,ApplyDirectStyling:eu,InsertText:eu,MergeParagraph:eu,MoveCursor:eu,RemoveAnnotation:eu,RemoveCursor:eu,RemoveMember:eu,RemoveStyle:eu,RemoveText:eu,SetParagraphStyle:eu,SplitParagraph:eu,UpdateMember:eu,UpdateMetadata:eu,UpdateParagraphStyle:eu},AddMember:{AddStyle:eu,ApplyDirectStyling:eu,InsertText:eu,MergeParagraph:eu,MoveCursor:eu,RemoveAnnotation:eu,RemoveCursor:eu,RemoveStyle:eu,RemoveText:eu,SetParagraphStyle:eu,SplitParagraph:eu,UpdateMetadata:eu,UpdateParagraphStyle:eu},AddStyle:{AddStyle:eu,ApplyDirectStyling:eu,InsertText:eu,MergeParagraph:eu,MoveCursor:eu,RemoveAnnotation:eu,RemoveCursor:eu,RemoveMember:eu,RemoveStyle:function(_,$){var ee,eo=[_],er=[$];return _.styleFamily===$.styleFamily&&(0<(ee=et(_.setProperties,$.styleName)).length&&er.unshift(ee={optype:"UpdateParagraphStyle",memberid:$.memberid,timestamp:$.timestamp,styleName:_.styleName,removedProperties:{attributes:ee.join(",")}}),en(_.setProperties,$.styleName)),{opSpecsA:eo,opSpecsB:er}},RemoveText:eu,SetParagraphStyle:eu,SplitParagraph:eu,UpdateMember:eu,UpdateMetadata:eu,UpdateParagraphStyle:eu},ApplyDirectStyling:{ApplyDirectStyling:function(_,$,ee){var et,en,er,es,eu,ec,ed,ef;return es=[_],er=[$],!(_.position+_.length<=$.position||_.position>=$.position+$.length)&&(et=ee?_:$,en=ee?$:_,(_.position!==$.position||_.length!==$.length)&&(ec=eo(et),ed=eo(en)),(($=el(en.setProperties,null,et.setProperties,null,"style:text-properties")).majorChanged||$.minorChanged)&&(er=[],_=[],es=et.position+et.length,eu=en.position+en.length,en.position<et.position?$.minorChanged&&((ef=eo(ed)).length=et.position-en.position,_.push(ef),en.position=et.position,en.length=eu-en.position):et.position<en.position&&$.majorChanged&&((ef=eo(ec)).length=en.position-et.position,er.push(ef),et.position=en.position,et.length=es-et.position),eu>es?$.minorChanged&&((ec=ed).position=es,ec.length=eu-es,_.push(ec),en.length=es-en.position):es>eu&&$.majorChanged&&(ec.position=eu,ec.length=es-eu,er.push(ec),et.length=eu-et.position),et.setProperties&&ei(et.setProperties)&&er.push(et),en.setProperties&&ei(en.setProperties)&&_.push(en),ee?(es=er,er=_):es=_)),{opSpecsA:es,opSpecsB:er}},InsertText:function(_,$){return $.position<=_.position?_.position+=$.text.length:$.position<=_.position+_.length&&(_.length+=$.text.length),{opSpecsA:[_],opSpecsB:[$]}},MergeParagraph:function(_,$){var ee=_.position,et=_.position+_.length;return ee>=$.sourceStartPosition&&--ee,et>=$.sourceStartPosition&&--et,_.position=ee,_.length=et-ee,{opSpecsA:[_],opSpecsB:[$]}},MoveCursor:eu,RemoveAnnotation:function(_,$){var ee=_.position,et=_.position+_.length,en=$.position+$.length,eo=[_],er=[$];return $.position<=ee&&et<=en?eo=[]:(en<ee&&(ee-=$.length+2),en<et&&(et-=$.length+2),_.position=ee,_.length=et-ee),{opSpecsA:eo,opSpecsB:er}},RemoveCursor:eu,RemoveMember:eu,RemoveStyle:eu,RemoveText:function(_,$){var ee=_.position+_.length,et=$.position+$.length,en=[_],eo=[$];return et<=_.position?_.position-=$.length:$.position<ee&&(_.position<$.position?_.length=et<ee?_.length-$.length:$.position-_.position:(_.position=$.position,et<ee?_.length=ee-et:en=[])),{opSpecsA:en,opSpecsB:eo}},SetParagraphStyle:eu,SplitParagraph:function(_,$){return $.position<_.position?_.position+=1:$.position<_.position+_.length&&(_.length+=1),{opSpecsA:[_],opSpecsB:[$]}},UpdateMember:eu,UpdateMetadata:eu,UpdateParagraphStyle:eu},InsertText:{InsertText:function(_,$,ee){return _.position<$.position?$.position+=_.text.length:_.position>$.position?_.position+=$.text.length:ee?$.position+=_.text.length:_.position+=$.text.length,{opSpecsA:[_],opSpecsB:[$]}},MergeParagraph:function(_,$){return _.position>=$.sourceStartPosition?--_.position:(_.position<$.sourceStartPosition&&($.sourceStartPosition+=_.text.length),_.position<$.destinationStartPosition&&($.destinationStartPosition+=_.text.length)),{opSpecsA:[_],opSpecsB:[$]}},MoveCursor:function(_,et){var en=ee(et);return _.position<et.position?et.position+=_.text.length:_.position<et.position+et.length&&(et.length+=_.text.length),en&&$(et),{opSpecsA:[_],opSpecsB:[et]}},RemoveAnnotation:function(_,$){var ee=_.position,et=$.position+$.length,en=[_],eo=[$];return $.position<=ee&&ee<=et?(en=[],$.length+=_.text.length):et<_.position?_.position-=$.length+2:$.position+=_.text.length,{opSpecsA:en,opSpecsB:eo}},RemoveCursor:eu,RemoveMember:eu,RemoveStyle:eu,RemoveText:function(_,$){ee=$.position+$.length;var ee,et=[_],en=[$];return ee<=_.position?_.position-=$.length:_.position<=$.position?$.position+=_.text.length:($.length=_.position-$.position,en.unshift(ee={optype:"RemoveText",memberid:$.memberid,timestamp:$.timestamp,position:_.position+_.text.length,length:ee-_.position}),_.position=$.position),{opSpecsA:et,opSpecsB:en}},SetParagraphStyle:function(_,$){return $.position>_.position&&($.position+=_.text.length),{opSpecsA:[_],opSpecsB:[$]}},SplitParagraph:function(_,$){return _.position<$.sourceParagraphPosition&&($.sourceParagraphPosition+=_.text.length),_.position<=$.position?$.position+=_.text.length:_.position+=1,{opSpecsA:[_],opSpecsB:[$]}},UpdateMember:eu,UpdateMetadata:eu,UpdateParagraphStyle:eu},MergeParagraph:{MergeParagraph:function(_,$,ee){var et,en=[_],eo=[$];return _.destinationStartPosition===$.destinationStartPosition?(en=[],eo=[],_.moveCursor&&(et={optype:"MoveCursor",memberid:_.memberid,timestamp:_.timestamp,position:_.sourceStartPosition-1},en.push(et)),$.moveCursor&&(et={optype:"MoveCursor",memberid:$.memberid,timestamp:$.timestamp,position:$.sourceStartPosition-1},eo.push(et)),_={optype:"SetParagraphStyle",memberid:(_=ee?_:$).memberid,timestamp:_.timestamp,position:_.destinationStartPosition,styleName:_.paragraphStyleName},ee?en.push(_):eo.push(_)):$.sourceStartPosition===_.destinationStartPosition?(_.destinationStartPosition=$.destinationStartPosition,--_.sourceStartPosition,_.paragraphStyleName=$.paragraphStyleName):_.sourceStartPosition===$.destinationStartPosition?($.destinationStartPosition=_.destinationStartPosition,--$.sourceStartPosition,$.paragraphStyleName=_.paragraphStyleName):_.destinationStartPosition<$.destinationStartPosition?(--$.destinationStartPosition,--$.sourceStartPosition):(--_.destinationStartPosition,--_.sourceStartPosition),{opSpecsA:en,opSpecsB:eo}},MoveCursor:function(_,$){var ee=$.position,et=$.position+$.length,en=Math.min(ee,et),ee=Math.max(ee,et);return en>=_.sourceStartPosition&&--en,ee>=_.sourceStartPosition&&--ee,0<=$.length?($.position=en,$.length=ee-en):($.position=ee,$.length=en-ee),{opSpecsA:[_],opSpecsB:[$]}},RemoveAnnotation:function(_,$){var ee=$.position+$.length,et=[_],en=[$];return $.position<=_.destinationStartPosition&&_.sourceStartPosition<=ee?(et=[],--$.length):_.sourceStartPosition<$.position?--$.position:(ee<_.destinationStartPosition&&(_.destinationStartPosition-=$.length+2),ee<_.sourceStartPosition&&(_.sourceStartPosition-=$.length+2)),{opSpecsA:et,opSpecsB:en}},RemoveCursor:eu,RemoveMember:eu,RemoveStyle:eu,RemoveText:function(_,$){return $.position>=_.sourceStartPosition?--$.position:($.position<_.destinationStartPosition&&(_.destinationStartPosition-=$.length),$.position<_.sourceStartPosition&&(_.sourceStartPosition-=$.length)),{opSpecsA:[_],opSpecsB:[$]}},SetParagraphStyle:function(_,$){var ee=[_],et=[$];return $.position>_.sourceStartPosition?--$.position:($.position===_.destinationStartPosition||$.position===_.sourceStartPosition)&&($.position=_.destinationStartPosition,_.paragraphStyleName=$.styleName),{opSpecsA:ee,opSpecsB:et}},SplitParagraph:function(_,$){var ee,et=[_],en=[$];return $.position<_.destinationStartPosition?(_.destinationStartPosition+=1,_.sourceStartPosition+=1):$.position>=_.destinationStartPosition&&$.position<_.sourceStartPosition?($.paragraphStyleName=_.paragraphStyleName,et.push(ee={optype:"SetParagraphStyle",memberid:_.memberid,timestamp:_.timestamp,position:_.destinationStartPosition,styleName:_.paragraphStyleName}),$.position===_.sourceStartPosition-1&&_.moveCursor&&et.push(ee={optype:"MoveCursor",memberid:_.memberid,timestamp:_.timestamp,position:$.position,length:0}),_.destinationStartPosition=$.position+1,_.sourceStartPosition+=1):$.position>=_.sourceStartPosition&&(--$.position,--$.sourceParagraphPosition),{opSpecsA:et,opSpecsB:en}},UpdateMember:eu,UpdateMetadata:eu,UpdateParagraphStyle:eu},MoveCursor:{MoveCursor:eu,RemoveAnnotation:function(_,et){var en=ee(_),eo=_.position+_.length,er=et.position+et.length;return et.position<=_.position&&eo<=er?(_.position=et.position-1,_.length=0):(er<_.position?_.position-=et.length+2:er<eo&&(_.length-=et.length+2),en&&$(_)),{opSpecsA:[_],opSpecsB:[et]}},RemoveCursor:function(_,$){return{opSpecsA:_.memberid===$.memberid?[]:[_],opSpecsB:[$]}},RemoveMember:eu,RemoveStyle:eu,RemoveText:function(_,et){var en=ee(_),eo=_.position+_.length,er=et.position+et.length;return er<=_.position?_.position-=et.length:et.position<eo&&(_.position<et.position?_.length=er<eo?_.length-et.length:et.position-_.position:(_.position=et.position,_.length=er<eo?eo-er:0)),en&&$(_),{opSpecsA:[_],opSpecsB:[et]}},SetParagraphStyle:eu,SplitParagraph:function(_,et){var en=ee(_);return et.position<_.position?_.position+=1:et.position<_.position+_.length&&(_.length+=1),en&&$(_),{opSpecsA:[_],opSpecsB:[et]}},UpdateMember:eu,UpdateMetadata:eu,UpdateParagraphStyle:eu},RemoveAnnotation:{RemoveAnnotation:function(_,$){var ee=[_],et=[$];return _.position===$.position&&_.length===$.length?(ee=[],et=[]):_.position<$.position?$.position-=_.length+2:_.position-=$.length+2,{opSpecsA:ee,opSpecsB:et}},RemoveCursor:eu,RemoveMember:eu,RemoveStyle:eu,RemoveText:function(_,$){var ee=_.position+_.length,et=$.position+$.length,en=[_],eo=[$];return _.position<=$.position&&et<=ee?(eo=[],_.length-=$.length):et<_.position?_.position-=$.length:$.position<_.position?(_.position=$.position+1,$.length-=_.length+2):$.position-=_.length+2,{opSpecsA:en,opSpecsB:eo}},SetParagraphStyle:function(_,$){var ee=$.position,et=_.position+_.length,en=[_],eo=[$];return _.position<=ee&&ee<=et?eo=[]:et<ee&&($.position-=_.length+2),{opSpecsA:en,opSpecsB:eo}},SplitParagraph:function(_,$){var ee=$.position,et=_.position+_.length,en=[_],eo=[$];return _.position<=ee&&ee<=et?(eo=[],_.length+=1):(et<$.sourceParagraphPosition&&($.sourceParagraphPosition-=_.length+2),et<ee?$.position-=_.length+2:_.position+=1),{opSpecsA:en,opSpecsB:eo}},UpdateMember:eu,UpdateMetadata:eu,UpdateParagraphStyle:eu},RemoveCursor:{RemoveCursor:function(_,$){var ee=_.memberid===$.memberid;return{opSpecsA:ee?[]:[_],opSpecsB:ee?[]:[$]}},RemoveMember:eu,RemoveStyle:eu,RemoveText:eu,SetParagraphStyle:eu,SplitParagraph:eu,UpdateMember:eu,UpdateMetadata:eu,UpdateParagraphStyle:eu},RemoveMember:{RemoveStyle:eu,RemoveText:eu,SetParagraphStyle:eu,SplitParagraph:eu,UpdateMetadata:eu,UpdateParagraphStyle:eu},RemoveStyle:{RemoveStyle:function(_,$){var ee=_.styleName===$.styleName&&_.styleFamily===$.styleFamily;return{opSpecsA:ee?[]:[_],opSpecsB:ee?[]:[$]}},RemoveText:eu,SetParagraphStyle:function(_,$){var ee=[_],et=[$];return"paragraph"===_.styleFamily&&_.styleName===$.styleName&&(ee.unshift({optype:"SetParagraphStyle",memberid:_.memberid,timestamp:_.timestamp,position:$.position,styleName:""}),$.styleName=""),{opSpecsA:ee,opSpecsB:et}},SplitParagraph:eu,UpdateMember:eu,UpdateMetadata:eu,UpdateParagraphStyle:function(_,$){var ee,eo=[_],er=[$];return"paragraph"===_.styleFamily&&(0<(ee=et($.setProperties,_.styleName)).length&&eo.unshift(ee={optype:"UpdateParagraphStyle",memberid:_.memberid,timestamp:_.timestamp,styleName:$.styleName,removedProperties:{attributes:ee.join(",")}}),_.styleName===$.styleName?er=[]:en($.setProperties,_.styleName)),{opSpecsA:eo,opSpecsB:er}}},RemoveText:{RemoveText:function(_,$){var ee=_.position+_.length,et=$.position+$.length,en=[_],eo=[$];return et<=_.position?_.position-=$.length:ee<=$.position?$.position-=_.length:$.position<ee&&(_.position<$.position?(_.length=et<ee?_.length-$.length:$.position-_.position,ee<et?($.position=_.position,$.length=et-ee):eo=[]):(ee<et?$.length-=_.length:$.position<_.position?$.length=_.position-$.position:eo=[],et<ee?(_.position=$.position,_.length=ee-et):en=[])),{opSpecsA:en,opSpecsB:eo}},SetParagraphStyle:function(_,$){return _.position<$.position&&($.position-=_.length),{opSpecsA:[_],opSpecsB:[$]}},SplitParagraph:function(_,$){var ee=_.position+_.length,et=[_],en=[$];return $.position<=_.position?_.position+=1:$.position<ee&&(_.length=$.position-_.position,et.unshift(ee={optype:"RemoveText",memberid:_.memberid,timestamp:_.timestamp,position:$.position+1,length:ee-$.position})),_.position+_.length<=$.position?$.position-=_.length:_.position<$.position&&($.position=_.position),_.position+_.length<$.sourceParagraphPosition&&($.sourceParagraphPosition-=_.length),{opSpecsA:et,opSpecsB:en}},UpdateMember:eu,UpdateMetadata:eu,UpdateParagraphStyle:eu},SetParagraphStyle:{SetParagraphStyle:function(_,$,ee){return _.position===$.position&&(ee?$.styleName=_.styleName:_.styleName=$.styleName),{opSpecsA:[_],opSpecsB:[$]}},SplitParagraph:function(_,$){var ee,et=[_],en=[$];return _.position>$.position?_.position+=1:_.position===$.sourceParagraphPosition&&($.paragraphStyleName=_.styleName,(ee=eo(_)).position=$.position+1,et.push(ee)),{opSpecsA:et,opSpecsB:en}},UpdateMember:eu,UpdateMetadata:eu,UpdateParagraphStyle:eu},SplitParagraph:{SplitParagraph:function(_,$,ee){var et,en;return _.position<$.position?et=!0:$.position<_.position?en=!0:_.position===$.position&&(ee?et=!0:en=!0),et?($.position+=1,$.sourceParagraphPosition=_.position<$.sourceParagraphPosition?$.sourceParagraphPosition+1:_.position+1):en&&(_.position+=1,_.sourceParagraphPosition=$.position<$.sourceParagraphPosition?_.sourceParagraphPosition+1:$.position+1),{opSpecsA:[_],opSpecsB:[$]}},UpdateMember:eu,UpdateMetadata:eu,UpdateParagraphStyle:eu},UpdateMember:{UpdateMetadata:eu,UpdateParagraphStyle:eu},UpdateMetadata:{UpdateMetadata:function(_,$,ee){var et,en=[_],eo=[$];return et=ee?_:$,er((_=ee?$:_).setProperties||null,_.removedProperties||null,et.setProperties||null,et.removedProperties||null),et.setProperties&&ei(et.setProperties)||et.removedProperties&&es(et.removedProperties)||(ee?en=[]:eo=[]),_.setProperties&&ei(_.setProperties)||_.removedProperties&&es(_.removedProperties)||(ee?eo=[]:en=[]),{opSpecsA:en,opSpecsB:eo}},UpdateParagraphStyle:eu},UpdateParagraphStyle:{UpdateParagraphStyle:function(_,$,ee){var et,en=[_],eo=[$];return _.styleName===$.styleName&&(et=ee?_:$,el((_=ee?$:_).setProperties,_.removedProperties,et.setProperties,et.removedProperties,"style:paragraph-properties"),el(_.setProperties,_.removedProperties,et.setProperties,et.removedProperties,"style:text-properties"),er(_.setProperties||null,_.removedProperties||null,et.setProperties||null,et.removedProperties||null),et.setProperties&&ei(et.setProperties)||et.removedProperties&&es(et.removedProperties)||(ee?en=[]:eo=[]),_.setProperties&&ei(_.setProperties)||_.removedProperties&&es(_.removedProperties)||(ee?eo=[]:en=[])),{opSpecsA:en,opSpecsB:eo}}}},this.passUnchanged=eu,this.extendTransformations=function($){Object.keys($).forEach(function(ee){var et,en=$[ee],eo=_.hasOwnProperty(ee);runtime.log((eo?"Extending":"Adding")+" map for optypeA: "+ee),eo||(_[ee]={}),et=_[ee],Object.keys(en).forEach(function(_){var $=et.hasOwnProperty(_);runtime.assert(ee<=_,"Wrong order:"+ee+", "+_),runtime.log("  "+($?"Overwriting":"Adding")+" entry for optypeB: "+_),et[_]=en[_]})})},this.transformOpspecVsOpspec=function($,ee){var et,en=$.optype<=ee.optype;return runtime.log("Crosstransforming:"),runtime.log(runtime.toJson($)),runtime.log(runtime.toJson(ee)),en||(et=$,$=ee,ee=et),(et=(et=_[$.optype])&&et[ee.optype])?(et=et($,ee,!en),en||null===et||(et={opSpecsA:et.opSpecsB,opSpecsB:et.opSpecsA})):et=null,runtime.log("result:"),et?(runtime.log(runtime.toJson(et.opSpecsA)),runtime.log(runtime.toJson(et.opSpecsB))):runtime.log("null"),et}},ops.OperationTransformer=function(){function _(ee,et){for(var en,eo,er=[],ei=[];0<ee.length&&et;){if(en=ee.shift(),!(en=$.transformOpspecVsOpspec(en,et)))return null;if(er=er.concat(en.opSpecsA),0===en.opSpecsB.length){er=er.concat(ee),et=null;break}for(;1<en.opSpecsB.length;){if(!(eo=_(ee,en.opSpecsB.shift())))return null;ei=ei.concat(eo.opSpecsB),ee=eo.opSpecsA}et=en.opSpecsB.pop()}return et&&ei.push(et),{opSpecsA:er,opSpecsB:ei}}var $=new ops.OperationTransformMatrix;this.getOperationTransformMatrix=function(){return $},this.transform=function($,ee){for(var et,en=[];0<ee.length;){if(!(et=_($,ee.shift())))return null;$=et.opSpecsA,en=en.concat(et.opSpecsB)}return{opSpecsA:$,opSpecsB:en}}};var webodf_css='@namespace draw url(urn:oasis:names:tc:opendocument:xmlns:drawing:1.0);@namespace fo url(urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0);@namespace office url(urn:oasis:names:tc:opendocument:xmlns:office:1.0);@namespace presentation url(urn:oasis:names:tc:opendocument:xmlns:presentation:1.0);@namespace style url(urn:oasis:names:tc:opendocument:xmlns:style:1.0);@namespace svg url(urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0);@namespace table url(urn:oasis:names:tc:opendocument:xmlns:table:1.0);@namespace text url(urn:oasis:names:tc:opendocument:xmlns:text:1.0);@namespace webodfhelper url(urn:webodf:names:helper);@namespace cursor url(urn:webodf:names:cursor);@namespace editinfo url(urn:webodf:names:editinfo);@namespace annotation url(urn:webodf:names:annotation);@namespace dc url(http://purl.org/dc/elements/1.1/);@namespace svgns url(http://www.w3.org/2000/svg);office|document > *, office|document-content > * {display: none;}office|body, office|document {display: inline-block;position: relative;}text|p, text|h {display: block;padding: 0;margin: 0;line-height: normal;position: relative;}text|p::after, text|h::after {content: "\\200B";white-space: pre;}*[webodfhelper|containsparagraphanchor] {position: relative;}text|s {white-space: pre;}text|tab {display: inline;white-space: pre;}text|tracked-changes {display: none;}office|binary-data {display: none;}office|text {display: block;text-align: left;overflow: visible;word-wrap: break-word;}office|text::selection {background: transparent;}.webodf-virtualSelections *::selection {background: transparent;}.webodf-virtualSelections *::-moz-selection {background: transparent;}office|text * draw|text-box {display: block;border: 1px solid #d3d3d3;}office|text draw|frame {z-index: 1;}office|spreadsheet {display: block;border-collapse: collapse;empty-cells: show;font-family: sans-serif;font-size: 10pt;text-align: left;page-break-inside: avoid;overflow: hidden;}office|presentation {display: inline-block;text-align: left;}#shadowContent {display: inline-block;text-align: left;}draw|page {display: block;position: relative;overflow: hidden;}presentation|notes, presentation|footer-decl, presentation|date-time-decl {display: none;}@media print {draw|page {border: 1pt solid black;page-break-inside: avoid;}presentation|notes {}}office|spreadsheet text|p {border: 0px;padding: 1px;margin: 0px;}office|spreadsheet table|table {margin: 3px;}office|spreadsheet table|table:after {}office|spreadsheet table|table-row {counter-increment: row;}office|spreadsheet table|table-row:before {width: 3em;background: #cccccc;border: 1px solid black;text-align: center;content: counter(row);display: table-cell;}office|spreadsheet table|table-cell {border: 1px solid #cccccc;}table|table {display: table;}draw|frame table|table {width: 100%;height: 100%;background: white;}table|table-header-rows {display: table-header-group;}table|table-row {display: table-row;}table|table-column {display: table-column;}table|table-cell {width: 0.889in;display: table-cell;word-break: break-all;}draw|frame {display: block;}draw|image {display: block;width: 100%;height: 100%;top: 0px;left: 0px;background-repeat: no-repeat;background-size: 100% 100%;-moz-background-size: 100% 100%;}draw|frame > draw|image:nth-of-type(n+2) {display: none;}text|list:before {display: none;content:"";}text|list {display: block;}text|list-item {display: block;}text|number {display:none;}text|a {color: blue;text-decoration: underline;cursor: pointer;}.webodf-inactiveLinks text|a {cursor: text;}text|note-citation {vertical-align: super;font-size: smaller;}text|note-body {display: none;}text|note:hover text|note-citation {background: #dddddd;}text|note:hover text|note-body {display: block;left:1em;max-width: 80%;position: absolute;background: #ffffaa;}text|bibliography-source {display: none;}svg|title, svg|desc {display: none;}video {width: 100%;height: 100%}cursor|anchor {display: none;}cursor|cursor {display: none;}.webodf-caretOverlay {position: absolute;top: 5%;height: 1em;z-index: 10;padding-left: 1px;pointer-events: none;}.webodf-caretOverlay .caret {position: absolute;border-left: 2px solid black;top: 0;bottom: 0;right: 0;}.webodf-caretOverlay .handle {position: absolute;margin-top: 5px;padding-top: 3px;margin-left: auto;margin-right: auto;width: 64px;height: 68px;border-radius: 5px;opacity: 0.3;text-align: center;background-color: black;box-shadow: 0px 0px 5px rgb(90, 90, 90);border: 1px solid black;top: -85px;right: -32px;}.webodf-caretOverlay .handle > img {box-shadow: 0px 0px 5px rgb(90, 90, 90) inset;background-color: rgb(200, 200, 200);border-radius: 5px;border: 2px solid;height: 60px;width: 60px;display: block;margin: auto;}.webodf-caretOverlay .handle.active {opacity: 0.8;}.webodf-caretOverlay .handle:after {content: " ";position: absolute;width: 0px;height: 0px;border-style: solid;border-width: 8.7px 5px 0 5px;border-color: black transparent transparent transparent;top: 100%;left: 43%;}.webodf-caretSizer {display: inline-block;width: 0;visibility: hidden;}#eventTrap {display: block;position: absolute;bottom: 0;left: 0;outline: none;opacity: 0;color: rgba(255, 255, 255, 0);pointer-events: none;white-space: pre;overflow: hidden;}cursor|cursor > #composer {text-decoration: underline;}cursor|cursor[cursor|caret-sizer-active="true"],cursor|cursor[cursor|composing="true"] {display: inline;}editinfo|editinfo {display: inline-block;}.editInfoMarker {position: absolute;width: 10px;height: 100%;left: -20px;opacity: 0.8;top: 0;border-radius: 5px;background-color: transparent;box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);}.editInfoMarker:hover {box-shadow: 0px 0px 8px rgba(0, 0, 0, 1);}.editInfoHandle {position: absolute;background-color: black;padding: 5px;border-radius: 5px;opacity: 0.8;box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);bottom: 100%;margin-bottom: 10px;z-index: 3;left: -25px;}.editInfoHandle:after {content: " ";position: absolute;width: 0px;height: 0px;border-style: solid;border-width: 8.7px 5px 0 5px;border-color: black transparent transparent transparent;top: 100%;left: 5px;}.editInfo {font-family: sans-serif;font-weight: normal;font-style: normal;text-decoration: none;color: white;width: 100%;height: 12pt;}.editInfoColor {float: left;width: 10pt;height: 10pt;border: 1px solid white;}.editInfoAuthor {float: left;margin-left: 5pt;font-size: 10pt;text-align: left;height: 12pt;line-height: 12pt;}.editInfoTime {float: right;margin-left: 30pt;font-size: 8pt;font-style: italic;color: yellow;height: 12pt;line-height: 12pt;}.annotationWrapper {display: inline;position: relative;}.annotationRemoveButton:before {content: "\xd7";color: white;padding: 5px;line-height: 1em;}.annotationRemoveButton {width: 20px;height: 20px;border-radius: 10px;background-color: black;box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);position: absolute;top: -10px;left: -10px;z-index: 3;text-align: center;font-family: sans-serif;font-style: normal;font-weight: normal;text-decoration: none;font-size: 15px;}.annotationRemoveButton:hover {cursor: pointer;box-shadow: 0px 0px 5px rgba(0, 0, 0, 1);}.annotationNote {width: 4cm;position: absolute;display: inline;z-index: 10;top: 0;}.annotationNote > office|annotation {display: block;text-align: left;}.annotationConnector {position: absolute;display: inline;top: 0;z-index: 2;border-top: 1px dashed brown;}.annotationConnector.angular {-moz-transform-origin: left top;-webkit-transform-origin: left top;-ms-transform-origin: left top;transform-origin: left top;}.annotationConnector.horizontal {left: 0;}.annotationConnector.horizontal:before {content: "";display: inline;position: absolute;width: 0px;height: 0px;border-style: solid;border-width: 8.7px 5px 0 5px;border-color: brown transparent transparent transparent;top: -1px;left: -5px;}office|annotation {width: 100%;height: 100%;display: none;background: rgb(198, 238, 184);background: -moz-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: -webkit-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: -o-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: -ms-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: linear-gradient(180deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);box-shadow: 0 3px 4px -3px #ccc;}office|annotation > dc|creator {display: block;font-size: 10pt;font-weight: normal;font-style: normal;font-family: sans-serif;color: white;background-color: brown;padding: 4px;}office|annotation > dc|date {display: block;font-size: 10pt;font-weight: normal;font-style: normal;font-family: sans-serif;border: 4px solid transparent;color: black;}office|annotation > text|list {display: block;padding: 5px;}office|annotation text|p {font-size: 10pt;color: black;font-weight: normal;font-style: normal;text-decoration: none;font-family: sans-serif;}#annotationsPane {background-color: #EAEAEA;width: 4cm;height: 100%;display: none;position: absolute;outline: 1px solid #ccc;}.webodf-annotationHighlight {background-color: yellow;position: relative;}.webodf-selectionOverlay {position: absolute;pointer-events: none;top: 0;left: 0;top: 0;left: 0;width: 100%;height: 100%;z-index: 15;}.webodf-selectionOverlay > polygon {fill-opacity: 0.3;stroke-opacity: 0.8;stroke-width: 1;fill-rule: evenodd;}.webodf-selectionOverlay > .webodf-draggable {fill-opacity: 0.8;stroke-opacity: 0;stroke-width: 8;pointer-events: all;display: none;-moz-transform-origin: center center;-webkit-transform-origin: center center;-ms-transform-origin: center center;transform-origin: center center;}#imageSelector {display: none;position: absolute;border-style: solid;border-color: black;}#imageSelector > div {width: 5px;height: 5px;display: block;position: absolute;border: 1px solid black;background-color: #ffffff;}#imageSelector > .topLeft {top: -4px;left: -4px;}#imageSelector > .topRight {top: -4px;right: -4px;}#imageSelector > .bottomRight {right: -4px;bottom: -4px;}#imageSelector > .bottomLeft {bottom: -4px;left: -4px;}#imageSelector > .topMiddle {top: -4px;left: 50%;margin-left: -2.5px;}#imageSelector > .rightMiddle {top: 50%;right: -4px;margin-top: -2.5px;}#imageSelector > .bottomMiddle {bottom: -4px;left: 50%;margin-left: -2.5px;}#imageSelector > .leftMiddle {top: 50%;left: -4px;margin-top: -2.5px;}div.webodf-customScrollbars::-webkit-scrollbar{width: 8px;height: 8px;background-color: transparent;}div.webodf-customScrollbars::-webkit-scrollbar-track{background-color: transparent;}div.webodf-customScrollbars::-webkit-scrollbar-thumb{background-color: #444;border-radius: 4px;}.webodf-hyperlinkTooltip {display: none;color: white;background-color: black;border-radius: 5px;box-shadow: 2px 2px 5px gray;padding: 3px;position: absolute;max-width: 210px;text-align: left;word-break: break-all;z-index: 16;}.webodf-hyperlinkTooltipText {display: block;font-weight: bold;}';!function(_){var $="undefined"!=typeof window?window:"undefined"!=typeof global?global:{};($.externs||($.externs={})).JSZip=_()}(function(){return(function _($,ee,et){function en(er,ei){if(!ee[er]){if(!$[er]){var es="function"==typeof require&&require;if(!ei&&es)return es(er,!0);if(eo)return eo(er,!0);throw Error("Cannot find module '"+er+"'")}var el=ee[er]={exports:{}};$[er][0].call(el.exports,function(_){return en($[er][1][_]||_)},el,el.exports,_,$,ee,et)}return ee[er].exports}for(var eo="function"==typeof require&&require,er=0;er<et.length;er++)en(et[er]);return en})({1:[function(_,$,ee){var et="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";ee.encode=function(_,$){for(var ee,en,eo,er,ei,es,el,eu="",ec=0;ec<_.length;)ee=_.charCodeAt(ec++),en=_.charCodeAt(ec++),eo=_.charCodeAt(ec++),er=ee>>2,ei=(3&ee)<<4|en>>4,es=(15&en)<<2|eo>>6,el=63&eo,isNaN(en)?es=el=64:isNaN(eo)&&(el=64),eu=eu+et.charAt(er)+et.charAt(ei)+et.charAt(es)+et.charAt(el);return eu},ee.decode=function(_,$){var ee,en,eo,er,ei,es,el,eu="",ec=0;for(_=_.replace(/[^A-Za-z0-9\+\/\=]/g,"");ec<_.length;)er=et.indexOf(_.charAt(ec++)),ei=et.indexOf(_.charAt(ec++)),es=et.indexOf(_.charAt(ec++)),el=et.indexOf(_.charAt(ec++)),ee=er<<2|ei>>4,en=(15&ei)<<4|es>>2,eo=(3&es)<<6|el,eu+=String.fromCharCode(ee),64!=es&&(eu+=String.fromCharCode(en)),64!=el&&(eu+=String.fromCharCode(eo));return eu}},{}],2:[function(_,$,ee){function et(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null}et.prototype={getContent:function(){return null},getCompressedContent:function(){return null}},$.exports=et},{}],3:[function(_,$,ee){ee.STORE={magic:"\x00\x00",compress:function(_){return _},uncompress:function(_){return _},compressInputType:null,uncompressInputType:null},ee.DEFLATE=_("./flate")},{"./flate":8}],4:[function(_,$,ee){var et=_("./utils"),en=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];$.exports=function(_,$){if(void 0===_||!_.length)return 0;var ee="string"!==et.getTypeOf(_);void 0===$&&($=0);var eo=0,er=0,ei=0;$^=-1;for(var es=0,el=_.length;es<el;es++)eo=en[er=($^(ei=ee?_[es]:_.charCodeAt(es)))&255],$=$>>>8^eo;return -1^$}},{"./utils":21}],5:[function(_,$,ee){var et=_("./utils");function en(_){this.data=null,this.length=0,this.index=0}en.prototype={checkOffset:function(_){this.checkIndex(this.index+_)},checkIndex:function(_){if(this.length<_||_<0)throw Error("End of data reached (data length = "+this.length+", asked index = "+_+"). Corrupted zip ?")},setIndex:function(_){this.checkIndex(_),this.index=_},skip:function(_){this.setIndex(this.index+_)},byteAt:function(_){},readInt:function(_){var $,ee=0;for(this.checkOffset(_),$=this.index+_-1;$>=this.index;$--)ee=(ee<<8)+this.byteAt($);return this.index+=_,ee},readString:function(_){return et.transformTo("string",this.readData(_))},readData:function(_){},lastIndexOfSignature:function(_){},readDate:function(){var _=this.readInt(4);return new Date((_>>25&127)+1980,(_>>21&15)-1,_>>16&31,_>>11&31,_>>5&63,(31&_)<<1)}},$.exports=en},{"./utils":21}],6:[function(_,$,ee){ee.base64=!1,ee.binary=!1,ee.dir=!1,ee.createFolders=!1,ee.date=null,ee.compression=null,ee.comment=null},{}],7:[function(_,$,ee){var et=_("./utils");ee.string2binary=function(_){return et.string2binary(_)},ee.string2Uint8Array=function(_){return et.transformTo("uint8array",_)},ee.uint8Array2String=function(_){return et.transformTo("string",_)},ee.string2Blob=function(_){var $=et.transformTo("arraybuffer",_);return et.arrayBuffer2Blob($)},ee.arrayBuffer2Blob=function(_){return et.arrayBuffer2Blob(_)},ee.transformTo=function(_,$){return et.transformTo(_,$)},ee.getTypeOf=function(_){return et.getTypeOf(_)},ee.checkSupport=function(_){return et.checkSupport(_)},ee.MAX_VALUE_16BITS=et.MAX_VALUE_16BITS,ee.MAX_VALUE_32BITS=et.MAX_VALUE_32BITS,ee.pretty=function(_){return et.pretty(_)},ee.findCompression=function(_){return et.findCompression(_)},ee.isRegExp=function(_){return et.isRegExp(_)}},{"./utils":21}],8:[function(_,$,ee){var et="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,en=_("pako");ee.uncompressInputType=et?"uint8array":"array",ee.compressInputType=et?"uint8array":"array",ee.magic="\b\x00",ee.compress=function(_){return en.deflateRaw(_)},ee.uncompress=function(_){return en.inflateRaw(_)}},{pako:24}],9:[function(_,$,ee){var et=_("./base64");function en(_,$){if(!(this instanceof en))return new en(_,$);this.files={},this.comment=null,this.root="",_&&this.load(_,$),this.clone=function(){var _=new en;for(var $ in this)"function"!=typeof this[$]&&(_[$]=this[$]);return _}}en.prototype=_("./object"),en.prototype.load=_("./load"),en.support=_("./support"),en.defaults=_("./defaults"),en.utils=_("./deprecatedPublicUtils"),en.base64={encode:function(_){return et.encode(_)},decode:function(_){return et.decode(_)}},en.compressions=_("./compressions"),$.exports=en},{"./base64":1,"./compressions":3,"./defaults":6,"./deprecatedPublicUtils":7,"./load":10,"./object":13,"./support":17}],10:[function(_,$,ee){var et=_("./base64"),en=_("./zipEntries");$.exports=function(_,$){var ee,eo,er,ei;for(($=$||{}).base64&&(_=et.decode(_)),ee=(eo=new en(_,$)).files,er=0;er<ee.length;er++)ei=ee[er],this.file(ei.fileName,ei.decompressed,{binary:!0,optimizedBinaryString:!0,date:ei.date,dir:ei.dir,comment:ei.fileComment.length?ei.fileComment:null,createFolders:$.createFolders});return eo.zipComment.length&&(this.comment=eo.zipComment),this}},{"./base64":1,"./zipEntries":22}],11:[function(_,$,ee){(function(_){$.exports=function($,ee){return new _($,ee)},$.exports.test=function($){return _.isBuffer($)}}).call(this,"undefined"!=typeof Buffer?Buffer:void 0)},{}],12:[function(_,$,ee){var et=_("./uint8ArrayReader");function en(_){this.data=_,this.length=this.data.length,this.index=0}en.prototype=new et,en.prototype.readData=function(_){this.checkOffset(_);var $=this.data.slice(this.index,this.index+_);return this.index+=_,$},$.exports=en},{"./uint8ArrayReader":18}],13:[function(_,$,ee){var et=_("./support"),en=_("./utils"),eo=_("./crc32"),er=_("./signature"),ei=_("./defaults"),es=_("./base64"),el=_("./compressions"),eu=_("./compressedObject"),ec=_("./nodeBuffer"),ed=_("./utf8"),ef=_("./stringWriter"),ep=_("./uint8ArrayWriter"),em=function(_){if(_._data instanceof eu&&(_._data=_._data.getContent(),_.options.binary=!0,_.options.base64=!1,"uint8array"===en.getTypeOf(_._data))){var $=_._data;_._data=new Uint8Array($.length),0!==$.length&&_._data.set($,0)}return _._data},eh=function(_){var $=em(_);return"string"===en.getTypeOf($)?!_.options.binary&&et.nodebuffer?ec($,"utf-8"):_.asBinary():$},eg=function(_){var $=em(this);return null==$?"":(this.options.base64&&($=es.decode($)),$=_&&this.options.binary?eT.utf8decode($):en.transformTo("string",$),_||this.options.binary||($=en.transformTo("string",eT.utf8encode($))),$)},eb=function(_,$,ee){this.name=_,this.dir=ee.dir,this.date=ee.date,this.comment=ee.comment,this._data=$,this.options=ee,this._initialMetadata={dir:ee.dir,date:ee.date}};eb.prototype={asText:function(){return eg.call(this,!0)},asBinary:function(){return eg.call(this,!1)},asNodeBuffer:function(){var _=eh(this);return en.transformTo("nodebuffer",_)},asUint8Array:function(){var _=eh(this);return en.transformTo("uint8array",_)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var ey=function(_,$){var ee,et="";for(ee=0;ee<$;ee++)et+=String.fromCharCode(255&_),_>>>=8;return et},ev=function(){var _,$,ee={};for(_=0;_<arguments.length;_++)for($ in arguments[_])arguments[_].hasOwnProperty($)&&void 0===ee[$]&&(ee[$]=arguments[_][$]);return ee},eS=function(_){return!0===(_=_||{}).base64&&(null===_.binary||void 0===_.binary)&&(_.binary=!0),(_=ev(_,ei)).date=_.date||new Date,null!==_.compression&&(_.compression=_.compression.toUpperCase()),_},eN=function(_,$,ee){var et,eo=en.getTypeOf($);if((ee=eS(ee)).createFolders&&(et=eC(_))&&ex.call(this,et,!0),ee.dir||null==$)ee.base64=!1,ee.binary=!1,$=null;else if("string"===eo)ee.binary&&!ee.base64&&!0!==ee.optimizedBinaryString&&($=en.string2binary($));else{if(ee.base64=!1,ee.binary=!0,!eo&&!($ instanceof eu))throw Error("The data of '"+_+"' is in an unsupported format !");"arraybuffer"===eo&&($=en.transformTo("uint8array",$))}var er=new eb(_,$,ee);return this.files[_]=er,er},eC=function(_){"/"==_.slice(-1)&&(_=_.substring(0,_.length-1));var $=_.lastIndexOf("/");return $>0?_.substring(0,$):""},ex=function(_,$){return"/"!=_.slice(-1)&&(_+="/"),$=void 0!==$&&$,this.files[_]||eN.call(this,_,null,{dir:!0,createFolders:$}),this.files[_]},ew=function(_,$){var ee,et=new eu;return _._data instanceof eu?(et.uncompressedSize=_._data.uncompressedSize,et.crc32=_._data.crc32,0===et.uncompressedSize||_.dir?($=el.STORE,et.compressedContent="",et.crc32=0):_._data.compressionMethod===$.magic?et.compressedContent=_._data.getCompressedContent():(ee=_._data.getContent(),et.compressedContent=$.compress(en.transformTo($.compressInputType,ee)))):((ee=eh(_))&&0!==ee.length&&!_.dir||($=el.STORE,ee=""),et.uncompressedSize=ee.length,et.crc32=eo(ee),et.compressedContent=$.compress(en.transformTo($.compressInputType,ee))),et.compressedSize=et.compressedContent.length,et.compressionMethod=$.magic,et},eE=function(_,$,ee,et){ee.compressedContent;var ei,es,el,eu,ec=en.transformTo("string",ed.utf8encode($.name)),ef=$.comment||"",ep=en.transformTo("string",ed.utf8encode(ef)),em=ec.length!==$.name.length,eh=ep.length!==ef.length,eg=$.options,eb="",ev="",eS="";el=$._initialMetadata.dir!==$.dir?$.dir:eg.dir,ei=((eu=$._initialMetadata.date!==$.date?$.date:eg.date).getHours()<<6|eu.getMinutes())<<5|eu.getSeconds()/2,es=(eu.getFullYear()-1980<<4|eu.getMonth()+1)<<5|eu.getDate(),em&&(ev=ey(1,1)+ey(eo(ec),4)+ec,eb+="up"+ey(ev.length,2)+ev),eh&&(eS=ey(1,1)+ey(this.crc32(ep),4)+ep,eb+="uc"+ey(eS.length,2)+eS);var eN="";return eN+="\n\x00"+(em||eh?"\x00\b":"\x00\x00")+ee.compressionMethod+ey(ei,2)+ey(es,2)+ey(ee.crc32,4)+ey(ee.compressedSize,4)+ey(ee.uncompressedSize,4)+ey(ec.length,2)+ey(eb.length,2),{fileRecord:er.LOCAL_FILE_HEADER+eN+ec+eb,dirRecord:er.CENTRAL_FILE_HEADER+"\x14\x00"+eN+ey(ep.length,2)+"\x00\x00\x00\x00"+(!0===el?"\x10\x00\x00\x00":"\x00\x00\x00\x00")+ey(et,4)+ec+eb+ep,compressedObject:ee}},eT={load:function(_,$){throw Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(_){var $,ee,et,en,eo=[];for($ in this.files)this.files.hasOwnProperty($)&&(et=this.files[$],en=new eb(et.name,et._data,ev(et.options)),ee=$.slice(this.root.length,$.length),$.slice(0,this.root.length)===this.root&&_(ee,en)&&eo.push(en));return eo},file:function(_,$,ee){if(1==arguments.length){if(!en.isRegExp(_))return this.filter(function($,ee){return!ee.dir&&$===_})[0]||null;var et=_;return this.filter(function(_,$){return!$.dir&&et.test(_)})}return _=this.root+_,eN.call(this,_,$,ee),this},folder:function(_){if(!_)return this;if(en.isRegExp(_))return this.filter(function($,ee){return ee.dir&&_.test($)});var $=this.root+_,ee=ex.call(this,$),et=this.clone();return et.root=ee.name,et},remove:function(_){_=this.root+_;var $=this.files[_];if($||("/"!=_.slice(-1)&&(_+="/"),$=this.files[_]),$&&!$.dir)delete this.files[_];else for(var ee=this.filter(function($,ee){return ee.name.slice(0,_.length)===_}),et=0;et<ee.length;et++)delete this.files[ee[et].name];return this},generate:function(_){_=ev(_||{},{base64:!0,compression:"STORE",type:"base64",comment:null}),en.checkSupport(_.type);var $,ee,et=[],eo=0,ei=0,eu=en.transformTo("string",this.utf8encode(_.comment||this.comment||""));for(var ec in this.files)if(this.files.hasOwnProperty(ec)){var ed=this.files[ec],em=ed.options.compression||_.compression.toUpperCase(),eh=el[em];if(!eh)throw Error(em+" is not a valid compression method !");var eg=ew.call(this,ed,eh),eb=eE.call(this,ec,ed,eg,eo);eo+=eb.fileRecord.length+eg.compressedSize,ei+=eb.dirRecord.length,et.push(eb)}var eS="";eS=er.CENTRAL_DIRECTORY_END+"\x00\x00\x00\x00"+ey(et.length,2)+ey(et.length,2)+ey(ei,4)+ey(eo,4)+ey(eu.length,2)+eu;var eN=_.type.toLowerCase();for(ee=0,$="uint8array"===eN||"arraybuffer"===eN||"blob"===eN||"nodebuffer"===eN?new ep(eo+ei+eS.length):new ef(eo+ei+eS.length);ee<et.length;ee++)$.append(et[ee].fileRecord),$.append(et[ee].compressedObject.compressedContent);for(ee=0;ee<et.length;ee++)$.append(et[ee].dirRecord);$.append(eS);var eC=$.finalize();switch(_.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return en.transformTo(_.type.toLowerCase(),eC);case"blob":return en.arrayBuffer2Blob(en.transformTo("arraybuffer",eC));case"base64":return _.base64?es.encode(eC):eC;default:return eC}},crc32:function(_,$){return eo(_,$)},utf8encode:function(_){return en.transformTo("string",ed.utf8encode(_))},utf8decode:function(_){return ed.utf8decode(_)}};$.exports=eT},{"./base64":1,"./compressedObject":2,"./compressions":3,"./crc32":4,"./defaults":6,"./nodeBuffer":11,"./signature":14,"./stringWriter":16,"./support":17,"./uint8ArrayWriter":19,"./utf8":20,"./utils":21}],14:[function(_,$,ee){ee.LOCAL_FILE_HEADER="PK\x03\x04",ee.CENTRAL_FILE_HEADER="PK\x01\x02",ee.CENTRAL_DIRECTORY_END="PK\x05\x06",ee.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",ee.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",ee.DATA_DESCRIPTOR="PK\x07\b"},{}],15:[function(_,$,ee){var et=_("./dataReader"),en=_("./utils");function eo(_,$){this.data=_,$||(this.data=en.string2binary(this.data)),this.length=this.data.length,this.index=0}eo.prototype=new et,eo.prototype.byteAt=function(_){return this.data.charCodeAt(_)},eo.prototype.lastIndexOfSignature=function(_){return this.data.lastIndexOf(_)},eo.prototype.readData=function(_){this.checkOffset(_);var $=this.data.slice(this.index,this.index+_);return this.index+=_,$},$.exports=eo},{"./dataReader":5,"./utils":21}],16:[function(_,$,ee){var et=_("./utils"),en=function(){this.data=[]};en.prototype={append:function(_){_=et.transformTo("string",_),this.data.push(_)},finalize:function(){return this.data.join("")}},$.exports=en},{"./utils":21}],17:[function(_,$,ee){(function(_){if(ee.base64=!0,ee.array=!0,ee.string=!0,ee.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,ee.nodebuffer=void 0!==_,ee.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)ee.blob=!1;else{var $=new ArrayBuffer(0);try{ee.blob=0===new Blob([$],{type:"application/zip"}).size}catch(_){try{var et=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);et.append($),ee.blob=0===et.getBlob("application/zip").size}catch(_){ee.blob=!1}}}}).call(this,"undefined"!=typeof Buffer?Buffer:void 0)},{}],18:[function(_,$,ee){var et=_("./dataReader");function en(_){_&&(this.data=_,this.length=this.data.length,this.index=0)}en.prototype=new et,en.prototype.byteAt=function(_){return this.data[_]},en.prototype.lastIndexOfSignature=function(_){for(var $=_.charCodeAt(0),ee=_.charCodeAt(1),et=_.charCodeAt(2),en=_.charCodeAt(3),eo=this.length-4;eo>=0;--eo)if(this.data[eo]===$&&this.data[eo+1]===ee&&this.data[eo+2]===et&&this.data[eo+3]===en)return eo;return -1},en.prototype.readData=function(_){if(this.checkOffset(_),0===_)return new Uint8Array(0);var $=this.data.subarray(this.index,this.index+_);return this.index+=_,$},$.exports=en},{"./dataReader":5}],19:[function(_,$,ee){var et=_("./utils"),en=function(_){this.data=new Uint8Array(_),this.index=0};en.prototype={append:function(_){0!==_.length&&(_=et.transformTo("uint8array",_),this.data.set(_,this.index),this.index+=_.length)},finalize:function(){return this.data}},$.exports=en},{"./utils":21}],20:[function(_,$,ee){for(var et=_("./utils"),en=_("./support"),eo=_("./nodeBuffer"),er=Array(256),ei=0;ei<256;ei++)er[ei]=ei>=252?6:ei>=248?5:ei>=240?4:ei>=224?3:ei>=192?2:1;er[254]=er[254]=1;var es=function(_){var $,ee,et,eo,er,ei=_.length,es=0;for(eo=0;eo<ei;eo++)(64512&(ee=_.charCodeAt(eo)))==55296&&eo+1<ei&&(64512&(et=_.charCodeAt(eo+1)))==56320&&(ee=65536+(ee-55296<<10)+(et-56320),eo++),es+=ee<128?1:ee<2048?2:ee<65536?3:4;for(er=0,$=en.uint8array?new Uint8Array(es):Array(es),eo=0;er<es;eo++)(64512&(ee=_.charCodeAt(eo)))==55296&&eo+1<ei&&(64512&(et=_.charCodeAt(eo+1)))==56320&&(ee=65536+(ee-55296<<10)+(et-56320),eo++),ee<128?$[er++]=ee:ee<2048?($[er++]=192|ee>>>6,$[er++]=128|63&ee):ee<65536?($[er++]=224|ee>>>12,$[er++]=128|ee>>>6&63,$[er++]=128|63&ee):($[er++]=240|ee>>>18,$[er++]=128|ee>>>12&63,$[er++]=128|ee>>>6&63,$[er++]=128|63&ee);return $},el=function(_,$){var ee;for(($=$||_.length)>_.length&&($=_.length),ee=$-1;ee>=0&&(192&_[ee])==128;)ee--;return ee<0||0===ee?$:ee+er[_[ee]]>$?ee:$},eu=function(_){var $,ee,en,eo,ei=_.length,es=Array(2*ei);for(ee=0,$=0;$<ei;){if((en=_[$++])<128){es[ee++]=en;continue}if((eo=er[en])>4){es[ee++]=65533,$+=eo-1;continue}for(en&=2===eo?31:3===eo?15:7;eo>1&&$<ei;)en=en<<6|63&_[$++],eo--;if(eo>1){es[ee++]=65533;continue}en<65536?es[ee++]=en:(en-=65536,es[ee++]=55296|en>>10&1023,es[ee++]=56320|1023&en)}return es.length!==ee&&(es.subarray?es=es.subarray(0,ee):es.length=ee),et.applyFromCharCode(es)};ee.utf8encode=function(_){return en.nodebuffer?eo(_,"utf-8"):es(_)},ee.utf8decode=function(_){if(en.nodebuffer)return et.transformTo("nodebuffer",_).toString("utf-8");_=et.transformTo(en.uint8array?"uint8array":"array",_);for(var $=[],ee=0,eo=_.length,er=65536;ee<eo;){var ei=el(_,Math.min(ee+er,eo));en.uint8array?$.push(eu(_.subarray(ee,ei))):$.push(eu(_.slice(ee,ei))),ee=ei}return $.join("")}},{"./nodeBuffer":11,"./support":17,"./utils":21}],21:[function(_,$,ee){var et=_("./support"),en=_("./compressions"),eo=_("./nodeBuffer");function er(_){return _}function ei(_,$){for(var ee=0;ee<_.length;++ee)$[ee]=255&_.charCodeAt(ee);return $}function es(_){var $=65536,et=[],en=_.length,er=ee.getTypeOf(_),ei=0,es=!0;try{switch(er){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,eo(0))}}catch(_){es=!1}if(!es){for(var el="",eu=0;eu<_.length;eu++)el+=String.fromCharCode(_[eu]);return el}for(;ei<en&&$>1;)try{"array"===er||"nodebuffer"===er?et.push(String.fromCharCode.apply(null,_.slice(ei,Math.min(ei+$,en)))):et.push(String.fromCharCode.apply(null,_.subarray(ei,Math.min(ei+$,en)))),ei+=$}catch(_){$=Math.floor($/2)}return et.join("")}function el(_,$){for(var ee=0;ee<_.length;ee++)$[ee]=_[ee];return $}ee.string2binary=function(_){for(var $="",ee=0;ee<_.length;ee++)$+=String.fromCharCode(255&_.charCodeAt(ee));return $},ee.arrayBuffer2Blob=function(_){ee.checkSupport("blob");try{return new Blob([_],{type:"application/zip"})}catch(ee){try{var $=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);return $.append(_),$.getBlob("application/zip")}catch(_){throw Error("Bug : can't construct the Blob.")}}},ee.applyFromCharCode=es;var eu={};eu.string={string:er,array:function(_){return ei(_,Array(_.length))},arraybuffer:function(_){return eu.string.uint8array(_).buffer},uint8array:function(_){return ei(_,new Uint8Array(_.length))},nodebuffer:function(_){return ei(_,eo(_.length))}},eu.array={string:es,array:er,arraybuffer:function(_){return new Uint8Array(_).buffer},uint8array:function(_){return new Uint8Array(_)},nodebuffer:function(_){return eo(_)}},eu.arraybuffer={string:function(_){return es(new Uint8Array(_))},array:function(_){return el(new Uint8Array(_),Array(_.byteLength))},arraybuffer:er,uint8array:function(_){return new Uint8Array(_)},nodebuffer:function(_){return eo(new Uint8Array(_))}},eu.uint8array={string:es,array:function(_){return el(_,Array(_.length))},arraybuffer:function(_){return _.buffer},uint8array:er,nodebuffer:function(_){return eo(_)}},eu.nodebuffer={string:es,array:function(_){return el(_,Array(_.length))},arraybuffer:function(_){return eu.nodebuffer.uint8array(_).buffer},uint8array:function(_){return el(_,new Uint8Array(_.length))},nodebuffer:er},ee.transformTo=function(_,$){return($||($=""),_)?(ee.checkSupport(_),eu[ee.getTypeOf($)][_]($)):$},ee.getTypeOf=function(_){return"string"==typeof _?"string":"[object Array]"===Object.prototype.toString.call(_)?"array":et.nodebuffer&&eo.test(_)?"nodebuffer":et.uint8array&&_ instanceof Uint8Array?"uint8array":et.arraybuffer&&_ instanceof ArrayBuffer?"arraybuffer":void 0},ee.checkSupport=function(_){if(!et[_.toLowerCase()])throw Error(_+" is not supported by this browser")},ee.MAX_VALUE_16BITS=65535,ee.MAX_VALUE_32BITS=-1,ee.pretty=function(_){var $,ee,et="";for(ee=0;ee<(_||"").length;ee++)et+="\\x"+(($=_.charCodeAt(ee))<16?"0":"")+$.toString(16).toUpperCase();return et},ee.findCompression=function(_){for(var $ in en)if(en.hasOwnProperty($)&&en[$].magic===_)return en[$];return null},ee.isRegExp=function(_){return"[object RegExp]"===Object.prototype.toString.call(_)}},{"./compressions":3,"./nodeBuffer":11,"./support":17}],22:[function(_,$,ee){var et=_("./stringReader"),en=_("./nodeBufferReader"),eo=_("./uint8ArrayReader"),er=_("./utils"),ei=_("./signature"),es=_("./zipEntry"),el=_("./support"),eu=_("./object");function ec(_,$){this.files=[],this.loadOptions=$,_&&this.load(_)}ec.prototype={checkSignature:function(_){var $=this.reader.readString(4);if($!==_)throw Error("Corrupted zip or bug : unexpected signature ("+er.pretty($)+", expected "+er.pretty(_)+")")},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2),this.zipComment=this.reader.readString(this.zipCommentLength),this.zipComment=eu.utf8decode(this.zipComment)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var _,$,ee,et=this.zip64EndOfCentralSize-44,en=0;en<et;)_=this.reader.readInt(2),$=this.reader.readInt(4),ee=this.reader.readString($),this.zip64ExtensibleData[_]={id:_,length:$,value:ee}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var _,$;for(_=0;_<this.files.length;_++)$=this.files[_],this.reader.setIndex($.localHeaderOffset),this.checkSignature(ei.LOCAL_FILE_HEADER),$.readLocalPart(this.reader),$.handleUTF8()},readCentralDir:function(){var _;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===ei.CENTRAL_FILE_HEADER;)(_=new es({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(_)},readEndOfCentral:function(){var _=this.reader.lastIndexOfSignature(ei.CENTRAL_DIRECTORY_END);if(-1===_)throw Error("Corrupted zip : can't find end of central directory");if(this.reader.setIndex(_),this.checkSignature(ei.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===er.MAX_VALUE_16BITS||this.diskWithCentralDirStart===er.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===er.MAX_VALUE_16BITS||this.centralDirRecords===er.MAX_VALUE_16BITS||this.centralDirSize===er.MAX_VALUE_32BITS||this.centralDirOffset===er.MAX_VALUE_32BITS){if(this.zip64=!0,-1===(_=this.reader.lastIndexOfSignature(ei.ZIP64_CENTRAL_DIRECTORY_LOCATOR)))throw Error("Corrupted zip : can't find the ZIP64 end of central directory locator");this.reader.setIndex(_),this.checkSignature(ei.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(ei.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}},prepareReader:function(_){var $=er.getTypeOf(_);"string"!==$||el.uint8array?"nodebuffer"===$?this.reader=new en(_):this.reader=new eo(er.transformTo("uint8array",_)):this.reader=new et(_,this.loadOptions.optimizedBinaryString)},load:function(_){this.prepareReader(_),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},$.exports=ec},{"./nodeBufferReader":12,"./object":13,"./signature":14,"./stringReader":15,"./support":17,"./uint8ArrayReader":18,"./utils":21,"./zipEntry":23}],23:[function(_,$,ee){var et=_("./stringReader"),en=_("./utils"),eo=_("./compressedObject"),er=_("./object");function ei(_,$){this.options=_,this.loadOptions=$}ei.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},prepareCompressedContent:function(_,$,ee){return function(){var et=_.index;_.setIndex($);var en=_.readData(ee);return _.setIndex(et),en}},prepareContent:function(_,$,ee,et,eo){return function(){var _=en.transformTo(et.uncompressInputType,this.getCompressedContent()),$=et.uncompress(_);if($.length!==eo)throw Error("Bug : uncompressed data size mismatch");return $}},readLocalPart:function(_){var $,ee;if(_.skip(22),this.fileNameLength=_.readInt(2),ee=_.readInt(2),this.fileName=_.readString(this.fileNameLength),_.skip(ee),-1==this.compressedSize||-1==this.uncompressedSize)throw Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");if(null===($=en.findCompression(this.compressionMethod)))throw Error("Corrupted zip : compression "+en.pretty(this.compressionMethod)+" unknown (inner file : "+this.fileName+")");if(this.decompressed=new eo,this.decompressed.compressedSize=this.compressedSize,this.decompressed.uncompressedSize=this.uncompressedSize,this.decompressed.crc32=this.crc32,this.decompressed.compressionMethod=this.compressionMethod,this.decompressed.getCompressedContent=this.prepareCompressedContent(_,_.index,this.compressedSize,$),this.decompressed.getContent=this.prepareContent(_,_.index,this.compressedSize,$,this.uncompressedSize),this.loadOptions.checkCRC32&&(this.decompressed=en.transformTo("string",this.decompressed.getContent()),er.crc32(this.decompressed)!==this.crc32))throw Error("Corrupted zip : CRC32 mismatch")},readCentralPart:function(_){if(this.versionMadeBy=_.readString(2),this.versionNeeded=_.readInt(2),this.bitFlag=_.readInt(2),this.compressionMethod=_.readString(2),this.date=_.readDate(),this.crc32=_.readInt(4),this.compressedSize=_.readInt(4),this.uncompressedSize=_.readInt(4),this.fileNameLength=_.readInt(2),this.extraFieldsLength=_.readInt(2),this.fileCommentLength=_.readInt(2),this.diskNumberStart=_.readInt(2),this.internalFileAttributes=_.readInt(2),this.externalFileAttributes=_.readInt(4),this.localHeaderOffset=_.readInt(4),this.isEncrypted())throw Error("Encrypted zip are not supported");this.fileName=_.readString(this.fileNameLength),this.readExtraFields(_),this.parseZIP64ExtraField(_),this.fileComment=_.readString(this.fileCommentLength),this.dir=!!(16&this.externalFileAttributes)},parseZIP64ExtraField:function(_){if(this.extraFields[1]){var $=new et(this.extraFields[1].value);this.uncompressedSize===en.MAX_VALUE_32BITS&&(this.uncompressedSize=$.readInt(8)),this.compressedSize===en.MAX_VALUE_32BITS&&(this.compressedSize=$.readInt(8)),this.localHeaderOffset===en.MAX_VALUE_32BITS&&(this.localHeaderOffset=$.readInt(8)),this.diskNumberStart===en.MAX_VALUE_32BITS&&(this.diskNumberStart=$.readInt(4))}},readExtraFields:function(_){var $,ee,et,en=_.index;for(this.extraFields=this.extraFields||{};_.index<en+this.extraFieldsLength;)$=_.readInt(2),ee=_.readInt(2),et=_.readString(ee),this.extraFields[$]={id:$,length:ee,value:et}},handleUTF8:function(){if(this.useUTF8())this.fileName=er.utf8decode(this.fileName),this.fileComment=er.utf8decode(this.fileComment);else{var _=this.findExtraFieldUnicodePath();null!==_&&(this.fileName=_);var $=this.findExtraFieldUnicodeComment();null!==$&&(this.fileComment=$)}},findExtraFieldUnicodePath:function(){var _=this.extraFields[28789];if(_){var $=new et(_.value);return 1!==$.readInt(1)||er.crc32(this.fileName)!==$.readInt(4)?null:er.utf8decode($.readString(_.length-5))}return null},findExtraFieldUnicodeComment:function(){var _=this.extraFields[25461];if(_){var $=new et(_.value);return 1!==$.readInt(1)||er.crc32(this.fileComment)!==$.readInt(4)?null:er.utf8decode($.readString(_.length-5))}return null}},$.exports=ei},{"./compressedObject":2,"./object":13,"./stringReader":15,"./utils":21}],24:[function(_,$,ee){var et=_("./lib/utils/common").assign,en=_("./lib/deflate"),eo=_("./lib/inflate"),er=_("./lib/zlib/constants"),ei={};et(ei,en,eo,er),$.exports=ei},{"./lib/deflate":25,"./lib/inflate":26,"./lib/utils/common":27,"./lib/zlib/constants":30}],25:[function(_,$,ee){var et=_("./zlib/deflate.js"),en=_("./utils/common"),eo=_("./utils/strings"),er=_("./zlib/messages"),ei=_("./zlib/zstream"),es=0,el=4,eu=0,ec=1,ed=-1,ef=0,ep=8,em=function(_){this.options=en.assign({level:ed,method:ep,chunkSize:16384,windowBits:15,memLevel:8,strategy:ef,to:""},_||{});var $=this.options;$.raw&&$.windowBits>0?$.windowBits=-$.windowBits:$.gzip&&$.windowBits>0&&$.windowBits<16&&($.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ei,this.strm.avail_out=0;var ee=et.deflateInit2(this.strm,$.level,$.method,$.windowBits,$.memLevel,$.strategy);if(ee!==eu)throw Error(er[ee]);$.header&&et.deflateSetHeader(this.strm,$.header)};function eh(_,$){var ee=new em($);if(ee.push(_,!0),ee.err)throw ee.msg;return ee.result}function eg(_,$){return($=$||{}).raw=!0,eh(_,$)}function eb(_,$){return($=$||{}).gzip=!0,eh(_,$)}em.prototype.push=function(_,$){var ee,er,ei=this.strm,ed=this.options.chunkSize;if(this.ended)return!1;er=$===~~$?$:!0===$?el:es,"string"==typeof _?ei.input=eo.string2buf(_):ei.input=_,ei.next_in=0,ei.avail_in=ei.input.length;do{if(0===ei.avail_out&&(ei.output=new en.Buf8(ed),ei.next_out=0,ei.avail_out=ed),(ee=et.deflate(ei,er))!==ec&&ee!==eu)return this.onEnd(ee),this.ended=!0,!1;(0===ei.avail_out||0===ei.avail_in&&er===el)&&("string"===this.options.to?this.onData(eo.buf2binstring(en.shrinkBuf(ei.output,ei.next_out))):this.onData(en.shrinkBuf(ei.output,ei.next_out)))}while((ei.avail_in>0||0===ei.avail_out)&&ee!==ec);return er!==el||(ee=et.deflateEnd(this.strm),this.onEnd(ee),this.ended=!0,ee===eu)},em.prototype.onData=function(_){this.chunks.push(_)},em.prototype.onEnd=function(_){_===eu&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=en.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg},ee.Deflate=em,ee.deflate=eh,ee.deflateRaw=eg,ee.gzip=eb},{"./utils/common":27,"./utils/strings":28,"./zlib/deflate.js":32,"./zlib/messages":37,"./zlib/zstream":39}],26:[function(_,$,ee){var et=_("./zlib/inflate.js"),en=_("./utils/common"),eo=_("./utils/strings"),er=_("./zlib/constants"),ei=_("./zlib/messages"),es=_("./zlib/zstream"),el=_("./zlib/gzheader"),eu=function(_){this.options=en.assign({chunkSize:16384,windowBits:0,to:""},_||{});var $=this.options;$.raw&&$.windowBits>=0&&$.windowBits<16&&($.windowBits=-$.windowBits,0===$.windowBits&&($.windowBits=-15)),$.windowBits>=0&&$.windowBits<16&&!(_&&_.windowBits)&&($.windowBits+=32),$.windowBits>15&&$.windowBits<48&&(15&$.windowBits)==0&&($.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new es,this.strm.avail_out=0;var ee=et.inflateInit2(this.strm,$.windowBits);if(ee!==er.Z_OK)throw Error(ei[ee]);this.header=new el,et.inflateGetHeader(this.strm,this.header)};function ec(_,$){var ee=new eu($);if(ee.push(_,!0),ee.err)throw ee.msg;return ee.result}function ed(_,$){return($=$||{}).raw=!0,ec(_,$)}eu.prototype.push=function(_,$){var ee,ei,es,el,eu,ec=this.strm,ed=this.options.chunkSize;if(this.ended)return!1;ei=$===~~$?$:!0===$?er.Z_FINISH:er.Z_NO_FLUSH,"string"==typeof _?ec.input=eo.binstring2buf(_):ec.input=_,ec.next_in=0,ec.avail_in=ec.input.length;do{if(0===ec.avail_out&&(ec.output=new en.Buf8(ed),ec.next_out=0,ec.avail_out=ed),(ee=et.inflate(ec,er.Z_NO_FLUSH))!==er.Z_STREAM_END&&ee!==er.Z_OK)return this.onEnd(ee),this.ended=!0,!1;ec.next_out&&(0===ec.avail_out||ee===er.Z_STREAM_END||0===ec.avail_in&&ei===er.Z_FINISH)&&("string"===this.options.to?(es=eo.utf8border(ec.output,ec.next_out),el=ec.next_out-es,eu=eo.buf2string(ec.output,es),ec.next_out=el,ec.avail_out=ed-el,el&&en.arraySet(ec.output,ec.output,es,el,0),this.onData(eu)):this.onData(en.shrinkBuf(ec.output,ec.next_out)))}while(ec.avail_in>0&&ee!==er.Z_STREAM_END);return ee===er.Z_STREAM_END&&(ei=er.Z_FINISH),ei!==er.Z_FINISH||(ee=et.inflateEnd(this.strm),this.onEnd(ee),this.ended=!0,ee===er.Z_OK)},eu.prototype.onData=function(_){this.chunks.push(_)},eu.prototype.onEnd=function(_){_===er.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=en.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg},ee.Inflate=eu,ee.inflate=ec,ee.inflateRaw=ed,ee.ungzip=ec},{"./utils/common":27,"./utils/strings":28,"./zlib/constants":30,"./zlib/gzheader":33,"./zlib/inflate.js":35,"./zlib/messages":37,"./zlib/zstream":39}],27:[function(_,$,ee){var et="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;ee.assign=function(_){for(var $=Array.prototype.slice.call(arguments,1);$.length;){var ee=$.shift();if(ee){if("object"!=typeof ee)throw TypeError(ee+"must be non-object");for(var et in ee)ee.hasOwnProperty(et)&&(_[et]=ee[et])}}return _},ee.shrinkBuf=function(_,$){return _.length===$?_:_.subarray?_.subarray(0,$):(_.length=$,_)};var en={arraySet:function(_,$,ee,et,en){if($.subarray&&_.subarray){_.set($.subarray(ee,ee+et),en);return}for(var eo=0;eo<et;eo++)_[en+eo]=$[ee+eo]},flattenChunks:function(_){var $,ee,et,en,eo,er;for($=0,et=0,ee=_.length;$<ee;$++)et+=_[$].length;for($=0,er=new Uint8Array(et),en=0,ee=_.length;$<ee;$++)eo=_[$],er.set(eo,en),en+=eo.length;return er}},eo={arraySet:function(_,$,ee,et,en){for(var eo=0;eo<et;eo++)_[en+eo]=$[ee+eo]},flattenChunks:function(_){return[].concat.apply([],_)}};ee.setTyped=function(_){_?(ee.Buf8=Uint8Array,ee.Buf16=Uint16Array,ee.Buf32=Int32Array,ee.assign(ee,en)):(ee.Buf8=Array,ee.Buf16=Array,ee.Buf32=Array,ee.assign(ee,eo))},ee.setTyped(et)},{}],28:[function(_,$,ee){var et=_("./common"),en=!0,eo=!0;try{String.fromCharCode.apply(null,[0])}catch(_){en=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(_){eo=!1}for(var er=new et.Buf8(256),ei=0;ei<256;ei++)er[ei]=ei>=252?6:ei>=248?5:ei>=240?4:ei>=224?3:ei>=192?2:1;function es(_,$){if($<65537&&(_.subarray&&eo||!_.subarray&&en))return String.fromCharCode.apply(null,et.shrinkBuf(_,$));for(var ee="",er=0;er<$;er++)ee+=String.fromCharCode(_[er]);return ee}er[254]=er[254]=1,ee.string2buf=function(_){var $,ee,en,eo,er,ei=_.length,es=0;for(eo=0;eo<ei;eo++)(64512&(ee=_.charCodeAt(eo)))==55296&&eo+1<ei&&(64512&(en=_.charCodeAt(eo+1)))==56320&&(ee=65536+(ee-55296<<10)+(en-56320),eo++),es+=ee<128?1:ee<2048?2:ee<65536?3:4;for(er=0,$=new et.Buf8(es),eo=0;er<es;eo++)(64512&(ee=_.charCodeAt(eo)))==55296&&eo+1<ei&&(64512&(en=_.charCodeAt(eo+1)))==56320&&(ee=65536+(ee-55296<<10)+(en-56320),eo++),ee<128?$[er++]=ee:ee<2048?($[er++]=192|ee>>>6,$[er++]=128|63&ee):ee<65536?($[er++]=224|ee>>>12,$[er++]=128|ee>>>6&63,$[er++]=128|63&ee):($[er++]=240|ee>>>18,$[er++]=128|ee>>>12&63,$[er++]=128|ee>>>6&63,$[er++]=128|63&ee);return $},ee.buf2binstring=function(_){return es(_,_.length)},ee.binstring2buf=function(_){for(var $=new et.Buf8(_.length),ee=0,en=$.length;ee<en;ee++)$[ee]=_.charCodeAt(ee);return $},ee.buf2string=function(_,$){var ee,et,en,eo,ei=$||_.length,el=Array(2*ei);for(et=0,ee=0;ee<ei;){if((en=_[ee++])<128){el[et++]=en;continue}if((eo=er[en])>4){el[et++]=65533,ee+=eo-1;continue}for(en&=2===eo?31:3===eo?15:7;eo>1&&ee<ei;)en=en<<6|63&_[ee++],eo--;if(eo>1){el[et++]=65533;continue}en<65536?el[et++]=en:(en-=65536,el[et++]=55296|en>>10&1023,el[et++]=56320|1023&en)}return es(el,et)},ee.utf8border=function(_,$){var ee;for(($=$||_.length)>_.length&&($=_.length),ee=$-1;ee>=0&&(192&_[ee])==128;)ee--;return ee<0||0===ee?$:ee+er[_[ee]]>$?ee:$}},{"./common":27}],29:[function(_,$,ee){function et(_,$,ee,et){for(var en=65535&_|0,eo=_>>>16&65535|0,er=0;0!==ee;){er=ee>2e3?2e3:ee,ee-=er;do eo=eo+(en=en+$[et++]|0)|0;while(--er);en%=65521,eo%=65521}return en|eo<<16|0}$.exports=et},{}],30:[function(_,$,ee){$.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],31:[function(_,$,ee){var et=function(){for(var _,$=[],ee=0;ee<256;ee++){_=ee;for(var et=0;et<8;et++)_=1&_?3988292384^_>>>1:_>>>1;$[ee]=_}return $}();function en(_,$,ee,en){var eo=et,er=en+ee;_^=-1;for(var ei=en;ei<er;ei++)_=_>>>8^eo[(_^$[ei])&255];return -1^_}$.exports=en},{}],32:[function(_,$,ee){var et,en=_("../utils/common"),eo=_("./trees"),er=_("./adler32"),ei=_("./crc32"),es=_("./messages"),el=0,eu=1,ec=3,ed=4,ef=5,ep=0,em=1,eh=-2,eg=-3,eb=-5,ey=-1,ev=1,eS=2,eN=3,eC=4,ex=0,ew=2,eE=8,eT=9,eO=15,eA=8,eR=286,eP=30,eD=19,e_=573,ek=15,eI=3,eF=258,eM=262,eB=32,eU=42,eL=69,ez=73,eH=91,eW=103,ej=113,eX=666,eV=1,eZ=2,eK=3,eq=4,eJ=3;function eG(_,$){return _.msg=es[$],$}function eY(_){return(_<<1)-(_>4?9:0)}function eQ(_){for(var $=_.length;--$>=0;)_[$]=0}function e$(_){var $=_.state,ee=$.pending;ee>_.avail_out&&(ee=_.avail_out),0!==ee&&(en.arraySet(_.output,$.pending_buf,$.pending_out,ee,_.next_out),_.next_out+=ee,$.pending_out+=ee,_.total_out+=ee,_.avail_out-=ee,$.pending-=ee,0===$.pending&&($.pending_out=0))}function e0(_,$){eo._tr_flush_block(_,_.block_start>=0?_.block_start:-1,_.strstart-_.block_start,$),_.block_start=_.strstart,e$(_.strm)}function e1(_,$){_.pending_buf[_.pending++]=$}function e2(_,$){_.pending_buf[_.pending++]=$>>>8&255,_.pending_buf[_.pending++]=255&$}function e5(_,$,ee,et){var eo=_.avail_in;return(eo>et&&(eo=et),0===eo)?0:(_.avail_in-=eo,en.arraySet($,_.input,_.next_in,eo,ee),1===_.state.wrap?_.adler=er(_.adler,$,eo,ee):2===_.state.wrap&&(_.adler=ei(_.adler,$,eo,ee)),_.next_in+=eo,_.total_in+=eo,eo)}function e3(_,$){var ee,et,en=_.max_chain_length,eo=_.strstart,er=_.prev_length,ei=_.nice_match,es=_.strstart>_.w_size-eM?_.strstart-(_.w_size-eM):0,el=_.window,eu=_.w_mask,ec=_.prev,ed=_.strstart+eF,ef=el[eo+er-1],ep=el[eo+er];_.prev_length>=_.good_match&&(en>>=2),ei>_.lookahead&&(ei=_.lookahead);do{if(el[(ee=$)+er]!==ep||el[ee+er-1]!==ef||el[ee]!==el[eo]||el[++ee]!==el[eo+1])continue;eo+=2,ee++;do;while(el[++eo]===el[++ee]&&el[++eo]===el[++ee]&&el[++eo]===el[++ee]&&el[++eo]===el[++ee]&&el[++eo]===el[++ee]&&el[++eo]===el[++ee]&&el[++eo]===el[++ee]&&el[++eo]===el[++ee]&&eo<ed);if(et=eF-(ed-eo),eo=ed-eF,et>er){if(_.match_start=$,er=et,et>=ei)break;ef=el[eo+er-1],ep=el[eo+er]}}while(($=ec[$&eu])>es&&0!=--en);return er<=_.lookahead?er:_.lookahead}function e6(_){var $,ee,et,eo,er,ei=_.w_size;do{if(eo=_.window_size-_.lookahead-_.strstart,_.strstart>=ei+(ei-eM)){en.arraySet(_.window,_.window,ei,ei,0),_.match_start-=ei,_.strstart-=ei,_.block_start-=ei,$=ee=_.hash_size;do et=_.head[--$],_.head[$]=et>=ei?et-ei:0;while(--ee);$=ee=ei;do et=_.prev[--$],_.prev[$]=et>=ei?et-ei:0;while(--ee);eo+=ei}if(0===_.strm.avail_in)break;if(ee=e5(_.strm,_.window,_.strstart+_.lookahead,eo),_.lookahead+=ee,_.lookahead+_.insert>=eI)for(er=_.strstart-_.insert,_.ins_h=_.window[er],_.ins_h=(_.ins_h<<_.hash_shift^_.window[er+1])&_.hash_mask;_.insert&&(_.ins_h=(_.ins_h<<_.hash_shift^_.window[er+eI-1])&_.hash_mask,_.prev[er&_.w_mask]=_.head[_.ins_h],_.head[_.ins_h]=er,er++,_.insert--,!(_.lookahead+_.insert<eI)););}while(_.lookahead<eM&&0!==_.strm.avail_in)}function e8(_,$){var ee=65535;for(65535>_.pending_buf_size-5&&(ee=_.pending_buf_size-5);;){if(_.lookahead<=1){if(e6(_),0===_.lookahead&&$===el)return eV;if(0===_.lookahead)break}_.strstart+=_.lookahead,_.lookahead=0;var et=_.block_start+ee;if((0===_.strstart||_.strstart>=et)&&(_.lookahead=_.strstart-et,_.strstart=et,e0(_,!1),0===_.strm.avail_out)||_.strstart-_.block_start>=_.w_size-eM&&(e0(_,!1),0===_.strm.avail_out))return eV}return(_.insert=0,$===ed)?(e0(_,!0),0===_.strm.avail_out)?eK:eq:(_.strstart>_.block_start&&(e0(_,!1),_.strm.avail_out),eV)}function e4(_,$){for(var ee,et;;){if(_.lookahead<eM){if(e6(_),_.lookahead<eM&&$===el)return eV;if(0===_.lookahead)break}if(ee=0,_.lookahead>=eI&&(_.ins_h=(_.ins_h<<_.hash_shift^_.window[_.strstart+eI-1])&_.hash_mask,ee=_.prev[_.strstart&_.w_mask]=_.head[_.ins_h],_.head[_.ins_h]=_.strstart),0!==ee&&_.strstart-ee<=_.w_size-eM&&(_.match_length=e3(_,ee)),_.match_length>=eI){if(et=eo._tr_tally(_,_.strstart-_.match_start,_.match_length-eI),_.lookahead-=_.match_length,_.match_length<=_.max_lazy_match&&_.lookahead>=eI){_.match_length--;do _.strstart++,_.ins_h=(_.ins_h<<_.hash_shift^_.window[_.strstart+eI-1])&_.hash_mask,ee=_.prev[_.strstart&_.w_mask]=_.head[_.ins_h],_.head[_.ins_h]=_.strstart;while(0!=--_.match_length);_.strstart++}else _.strstart+=_.match_length,_.match_length=0,_.ins_h=_.window[_.strstart],_.ins_h=(_.ins_h<<_.hash_shift^_.window[_.strstart+1])&_.hash_mask}else et=eo._tr_tally(_,0,_.window[_.strstart]),_.lookahead--,_.strstart++;if(et&&(e0(_,!1),0===_.strm.avail_out))return eV}return(_.insert=_.strstart<eI-1?_.strstart:eI-1,$===ed)?(e0(_,!0),0===_.strm.avail_out)?eK:eq:_.last_lit&&(e0(_,!1),0===_.strm.avail_out)?eV:eZ}function e9(_,$){for(var ee,et,en;;){if(_.lookahead<eM){if(e6(_),_.lookahead<eM&&$===el)return eV;if(0===_.lookahead)break}if(ee=0,_.lookahead>=eI&&(_.ins_h=(_.ins_h<<_.hash_shift^_.window[_.strstart+eI-1])&_.hash_mask,ee=_.prev[_.strstart&_.w_mask]=_.head[_.ins_h],_.head[_.ins_h]=_.strstart),_.prev_length=_.match_length,_.prev_match=_.match_start,_.match_length=eI-1,0!==ee&&_.prev_length<_.max_lazy_match&&_.strstart-ee<=_.w_size-eM&&(_.match_length=e3(_,ee),_.match_length<=5&&(_.strategy===ev||_.match_length===eI&&_.strstart-_.match_start>4096)&&(_.match_length=eI-1)),_.prev_length>=eI&&_.match_length<=_.prev_length){en=_.strstart+_.lookahead-eI,et=eo._tr_tally(_,_.strstart-1-_.prev_match,_.prev_length-eI),_.lookahead-=_.prev_length-1,_.prev_length-=2;do++_.strstart<=en&&(_.ins_h=(_.ins_h<<_.hash_shift^_.window[_.strstart+eI-1])&_.hash_mask,ee=_.prev[_.strstart&_.w_mask]=_.head[_.ins_h],_.head[_.ins_h]=_.strstart);while(0!=--_.prev_length);if(_.match_available=0,_.match_length=eI-1,_.strstart++,et&&(e0(_,!1),0===_.strm.avail_out))return eV}else if(_.match_available){if((et=eo._tr_tally(_,0,_.window[_.strstart-1]))&&e0(_,!1),_.strstart++,_.lookahead--,0===_.strm.avail_out)return eV}else _.match_available=1,_.strstart++,_.lookahead--}return(_.match_available&&(et=eo._tr_tally(_,0,_.window[_.strstart-1]),_.match_available=0),_.insert=_.strstart<eI-1?_.strstart:eI-1,$===ed)?(e0(_,!0),0===_.strm.avail_out)?eK:eq:_.last_lit&&(e0(_,!1),0===_.strm.avail_out)?eV:eZ}function e7(_,$){for(var ee,et,en,er,ei=_.window;;){if(_.lookahead<=eF){if(e6(_),_.lookahead<=eF&&$===el)return eV;if(0===_.lookahead)break}if(_.match_length=0,_.lookahead>=eI&&_.strstart>0&&(et=ei[en=_.strstart-1])===ei[++en]&&et===ei[++en]&&et===ei[++en]){er=_.strstart+eF;do;while(et===ei[++en]&&et===ei[++en]&&et===ei[++en]&&et===ei[++en]&&et===ei[++en]&&et===ei[++en]&&et===ei[++en]&&et===ei[++en]&&en<er);_.match_length=eF-(er-en),_.match_length>_.lookahead&&(_.match_length=_.lookahead)}if(_.match_length>=eI?(ee=eo._tr_tally(_,1,_.match_length-eI),_.lookahead-=_.match_length,_.strstart+=_.match_length,_.match_length=0):(ee=eo._tr_tally(_,0,_.window[_.strstart]),_.lookahead--,_.strstart++),ee&&(e0(_,!1),0===_.strm.avail_out))return eV}return(_.insert=0,$===ed)?(e0(_,!0),0===_.strm.avail_out)?eK:eq:_.last_lit&&(e0(_,!1),0===_.strm.avail_out)?eV:eZ}function te(_,$){for(var ee;;){if(0===_.lookahead&&(e6(_),0===_.lookahead)){if($===el)return eV;break}if(_.match_length=0,ee=eo._tr_tally(_,0,_.window[_.strstart]),_.lookahead--,_.strstart++,ee&&(e0(_,!1),0===_.strm.avail_out))return eV}return(_.insert=0,$===ed)?(e0(_,!0),0===_.strm.avail_out)?eK:eq:_.last_lit&&(e0(_,!1),0===_.strm.avail_out)?eV:eZ}var tt=function(_,$,ee,et,en){this.good_length=_,this.max_lazy=$,this.nice_length=ee,this.max_chain=et,this.func=en};function tn(_){_.window_size=2*_.w_size,eQ(_.head),_.max_lazy_match=et[_.level].max_lazy,_.good_match=et[_.level].good_length,_.nice_match=et[_.level].nice_length,_.max_chain_length=et[_.level].max_chain,_.strstart=0,_.block_start=0,_.lookahead=0,_.insert=0,_.match_length=_.prev_length=eI-1,_.match_available=0,_.ins_h=0}function to(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=eE,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new en.Buf16(2*e_),this.dyn_dtree=new en.Buf16((2*eP+1)*2),this.bl_tree=new en.Buf16((2*eD+1)*2),eQ(this.dyn_ltree),eQ(this.dyn_dtree),eQ(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new en.Buf16(ek+1),this.heap=new en.Buf16(2*eR+1),eQ(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new en.Buf16(2*eR+1),eQ(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function tr(_){var $;return _&&_.state?(_.total_in=_.total_out=0,_.data_type=ew,($=_.state).pending=0,$.pending_out=0,$.wrap<0&&($.wrap=-$.wrap),$.status=$.wrap?eU:ej,_.adler=2===$.wrap?0:1,$.last_flush=el,eo._tr_init($),ep):eG(_,eh)}function ti(_){var $=tr(_);return $===ep&&tn(_.state),$}function ts(_,$){return _&&_.state&&2===_.state.wrap?(_.state.gzhead=$,ep):eh}function tl(_,$,ee,et,eo,er){if(!_)return eh;var ei=1;if($===ey&&($=6),et<0?(ei=0,et=-et):et>15&&(ei=2,et-=16),eo<1||eo>eT||ee!==eE||et<8||et>15||$<0||$>9||er<0||er>eC)return eG(_,eh);8===et&&(et=9);var es=new to;return _.state=es,es.strm=_,es.wrap=ei,es.gzhead=null,es.w_bits=et,es.w_size=1<<es.w_bits,es.w_mask=es.w_size-1,es.hash_bits=eo+7,es.hash_size=1<<es.hash_bits,es.hash_mask=es.hash_size-1,es.hash_shift=~~((es.hash_bits+eI-1)/eI),es.window=new en.Buf8(2*es.w_size),es.head=new en.Buf16(es.hash_size),es.prev=new en.Buf16(es.w_size),es.lit_bufsize=1<<eo+6,es.pending_buf_size=4*es.lit_bufsize,es.pending_buf=new en.Buf8(es.pending_buf_size),es.d_buf=es.lit_bufsize>>1,es.l_buf=3*es.lit_bufsize,es.level=$,es.strategy=er,es.method=ee,ti(_)}function tu(_,$){return tl(_,$,eE,eO,eA,ex)}function tc(_,$){if(!_||!_.state||$>ef||$<0)return _?eG(_,eh):eh;if(en=_.state,!_.output||!_.input&&0!==_.avail_in||en.status===eX&&$!==ed)return eG(_,0===_.avail_out?eb:eh);if(en.strm=_,ee=en.last_flush,en.last_flush=$,en.status===eU){if(2===en.wrap)_.adler=0,e1(en,31),e1(en,139),e1(en,8),en.gzhead?(e1(en,(en.gzhead.text?1:0)+(en.gzhead.hcrc?2:0)+(en.gzhead.extra?4:0)+(en.gzhead.name?8:0)+(en.gzhead.comment?16:0)),e1(en,255&en.gzhead.time),e1(en,en.gzhead.time>>8&255),e1(en,en.gzhead.time>>16&255),e1(en,en.gzhead.time>>24&255),e1(en,9===en.level?2:en.strategy>=eS||en.level<2?4:0),e1(en,255&en.gzhead.os),en.gzhead.extra&&en.gzhead.extra.length&&(e1(en,255&en.gzhead.extra.length),e1(en,en.gzhead.extra.length>>8&255)),en.gzhead.hcrc&&(_.adler=ei(_.adler,en.pending_buf,en.pending,0)),en.gzindex=0,en.status=eL):(e1(en,0),e1(en,0),e1(en,0),e1(en,0),e1(en,0),e1(en,9===en.level?2:en.strategy>=eS||en.level<2?4:0),e1(en,eJ),en.status=ej);else{var ee,en,er,es,eg=eE+(en.w_bits-8<<4)<<8,ey=-1;eg|=(ey=en.strategy>=eS||en.level<2?0:en.level<6?1:6===en.level?2:3)<<6,0!==en.strstart&&(eg|=eB),eg+=31-eg%31,en.status=ej,e2(en,eg),0!==en.strstart&&(e2(en,_.adler>>>16),e2(en,65535&_.adler)),_.adler=1}}if(en.status===eL){if(en.gzhead.extra){for(er=en.pending;en.gzindex<(65535&en.gzhead.extra.length)&&(en.pending!==en.pending_buf_size||(en.gzhead.hcrc&&en.pending>er&&(_.adler=ei(_.adler,en.pending_buf,en.pending-er,er)),e$(_),er=en.pending,en.pending!==en.pending_buf_size));)e1(en,255&en.gzhead.extra[en.gzindex]),en.gzindex++;en.gzhead.hcrc&&en.pending>er&&(_.adler=ei(_.adler,en.pending_buf,en.pending-er,er)),en.gzindex===en.gzhead.extra.length&&(en.gzindex=0,en.status=ez)}else en.status=ez}if(en.status===ez){if(en.gzhead.name){er=en.pending;do{if(en.pending===en.pending_buf_size&&(en.gzhead.hcrc&&en.pending>er&&(_.adler=ei(_.adler,en.pending_buf,en.pending-er,er)),e$(_),er=en.pending,en.pending===en.pending_buf_size)){es=1;break}es=en.gzindex<en.gzhead.name.length?255&en.gzhead.name.charCodeAt(en.gzindex++):0,e1(en,es)}while(0!==es);en.gzhead.hcrc&&en.pending>er&&(_.adler=ei(_.adler,en.pending_buf,en.pending-er,er)),0===es&&(en.gzindex=0,en.status=eH)}else en.status=eH}if(en.status===eH){if(en.gzhead.comment){er=en.pending;do{if(en.pending===en.pending_buf_size&&(en.gzhead.hcrc&&en.pending>er&&(_.adler=ei(_.adler,en.pending_buf,en.pending-er,er)),e$(_),er=en.pending,en.pending===en.pending_buf_size)){es=1;break}es=en.gzindex<en.gzhead.comment.length?255&en.gzhead.comment.charCodeAt(en.gzindex++):0,e1(en,es)}while(0!==es);en.gzhead.hcrc&&en.pending>er&&(_.adler=ei(_.adler,en.pending_buf,en.pending-er,er)),0===es&&(en.status=eW)}else en.status=eW}if(en.status===eW&&(en.gzhead.hcrc?(en.pending+2>en.pending_buf_size&&e$(_),en.pending+2<=en.pending_buf_size&&(e1(en,255&_.adler),e1(en,_.adler>>8&255),_.adler=0,en.status=ej)):en.status=ej),0!==en.pending){if(e$(_),0===_.avail_out)return en.last_flush=-1,ep}else if(0===_.avail_in&&eY($)<=eY(ee)&&$!==ed)return eG(_,eb);if(en.status===eX&&0!==_.avail_in)return eG(_,eb);if(0!==_.avail_in||0!==en.lookahead||$!==el&&en.status!==eX){var ev=en.strategy===eS?te(en,$):en.strategy===eN?e7(en,$):et[en.level].func(en,$);if((ev===eK||ev===eq)&&(en.status=eX),ev===eV||ev===eK)return 0===_.avail_out&&(en.last_flush=-1),ep;if(ev===eZ&&($===eu?eo._tr_align(en):$!==ef&&(eo._tr_stored_block(en,0,0,!1),$===ec&&(eQ(en.head),0===en.lookahead&&(en.strstart=0,en.block_start=0,en.insert=0))),e$(_),0===_.avail_out))return en.last_flush=-1,ep}return $!==ed?ep:en.wrap<=0?em:(2===en.wrap?(e1(en,255&_.adler),e1(en,_.adler>>8&255),e1(en,_.adler>>16&255),e1(en,_.adler>>24&255),e1(en,255&_.total_in),e1(en,_.total_in>>8&255),e1(en,_.total_in>>16&255),e1(en,_.total_in>>24&255)):(e2(en,_.adler>>>16),e2(en,65535&_.adler)),e$(_),en.wrap>0&&(en.wrap=-en.wrap),0!==en.pending?ep:em)}function td(_){var $;return _&&_.state?($=_.state.status)!==eU&&$!==eL&&$!==ez&&$!==eH&&$!==eW&&$!==ej&&$!==eX?eG(_,eh):(_.state=null,$===ej?eG(_,eg):ep):eh}et=[new tt(0,0,0,0,e8),new tt(4,4,8,4,e4),new tt(4,5,16,8,e4),new tt(4,6,32,32,e4),new tt(4,4,16,16,e9),new tt(8,16,32,32,e9),new tt(8,16,128,128,e9),new tt(8,32,128,256,e9),new tt(32,128,258,1024,e9),new tt(32,258,258,4096,e9)],ee.deflateInit=tu,ee.deflateInit2=tl,ee.deflateReset=ti,ee.deflateResetKeep=tr,ee.deflateSetHeader=ts,ee.deflate=tc,ee.deflateEnd=td,ee.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./messages":37,"./trees":38}],33:[function(_,$,ee){function et(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}$.exports=et},{}],34:[function(_,$,ee){var et=30,en=12;$.exports=function(_,$){var ee,eo,er,ei,es,el,eu,ec,ed,ef,ep,em,eh,eg,eb,ey,ev,eS,eN,eC,ex,ew,eE,eT,eO;ee=_.state,eo=_.next_in,eT=_.input,er=eo+(_.avail_in-5),ei=_.next_out,eO=_.output,es=ei-($-_.avail_out),el=ei+(_.avail_out-257),eu=ee.dmax,ec=ee.wsize,ed=ee.whave,ef=ee.wnext,ep=ee.window,em=ee.hold,eh=ee.bits,eg=ee.lencode,eb=ee.distcode,ey=(1<<ee.lenbits)-1,ev=(1<<ee.distbits)-1;t:do{eh<15&&(em+=eT[eo++]<<eh,eh+=8,em+=eT[eo++]<<eh,eh+=8),eS=eg[em&ey];n:for(;;){if(em>>>=eN=eS>>>24,eh-=eN,0==(eN=eS>>>16&255))eO[ei++]=65535&eS;else if(16&eN){eC=65535&eS,(eN&=15)&&(eh<eN&&(em+=eT[eo++]<<eh,eh+=8),eC+=em&(1<<eN)-1,em>>>=eN,eh-=eN),eh<15&&(em+=eT[eo++]<<eh,eh+=8,em+=eT[eo++]<<eh,eh+=8),eS=eb[em&ev];o:for(;;){if(em>>>=eN=eS>>>24,eh-=eN,16&(eN=eS>>>16&255)){if(ex=65535&eS,eh<(eN&=15)&&(em+=eT[eo++]<<eh,(eh+=8)<eN&&(em+=eT[eo++]<<eh,eh+=8)),(ex+=em&(1<<eN)-1)>eu){_.msg="invalid distance too far back",ee.mode=et;break t}if(em>>>=eN,eh-=eN,ex>(eN=ei-es)){if((eN=ex-eN)>ed&&ee.sane){_.msg="invalid distance too far back",ee.mode=et;break t}if(ew=0,eE=ep,0===ef){if(ew+=ec-eN,eN<eC){eC-=eN;do eO[ei++]=ep[ew++];while(--eN);ew=ei-ex,eE=eO}}else if(ef<eN){if(ew+=ec+ef-eN,(eN-=ef)<eC){eC-=eN;do eO[ei++]=ep[ew++];while(--eN);if(ew=0,ef<eC){eC-=eN=ef;do eO[ei++]=ep[ew++];while(--eN);ew=ei-ex,eE=eO}}}else if(ew+=ef-eN,eN<eC){eC-=eN;do eO[ei++]=ep[ew++];while(--eN);ew=ei-ex,eE=eO}for(;eC>2;)eO[ei++]=eE[ew++],eO[ei++]=eE[ew++],eO[ei++]=eE[ew++],eC-=3;eC&&(eO[ei++]=eE[ew++],eC>1&&(eO[ei++]=eE[ew++]))}else{ew=ei-ex;do eO[ei++]=eO[ew++],eO[ei++]=eO[ew++],eO[ei++]=eO[ew++],eC-=3;while(eC>2);eC&&(eO[ei++]=eO[ew++],eC>1&&(eO[ei++]=eO[ew++]))}}else if((64&eN)==0){eS=eb[(65535&eS)+(em&(1<<eN)-1)];continue o}else{_.msg="invalid distance code",ee.mode=et;break t}break}}else if((64&eN)==0){eS=eg[(65535&eS)+(em&(1<<eN)-1)];continue n}else if(32&eN){ee.mode=en;break t}else{_.msg="invalid literal/length code",ee.mode=et;break t}break}}while(eo<er&&ei<el);eo-=eC=eh>>3,eh-=eC<<3,em&=(1<<eh)-1,_.next_in=eo,_.next_out=ei,_.avail_in=eo<er?5+(er-eo):5-(eo-er),_.avail_out=ei<el?257+(el-ei):257-(ei-el),ee.hold=em,ee.bits=eh}},{}],35:[function(_,$,ee){var et,en,eo=_("../utils/common"),er=_("./adler32"),ei=_("./crc32"),es=_("./inffast"),el=_("./inftrees"),eu=0,ec=1,ed=2,ef=4,ep=5,em=6,eh=0,eg=1,eb=2,ey=-2,ev=-3,eS=-4,eN=-5,eC=8,ex=1,ew=2,eE=3,eT=4,eO=5,eA=6,eR=7,eP=8,eD=9,e_=10,ek=11,eI=12,eF=13,eM=14,eB=15,eU=16,eL=17,ez=18,eH=19,eW=20,ej=21,eX=22,eV=23,eZ=24,eK=25,eq=26,eJ=27,eG=28,eY=29,eQ=30,e$=31,e0=852,e1=592,e2=15;function e5(_){return(_>>>24&255)+(_>>>8&65280)+((65280&_)<<8)+((255&_)<<24)}function e3(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new eo.Buf16(320),this.work=new eo.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function e6(_){var $;return _&&_.state?($=_.state,_.total_in=_.total_out=$.total=0,_.msg="",$.wrap&&(_.adler=1&$.wrap),$.mode=ex,$.last=0,$.havedict=0,$.dmax=32768,$.head=null,$.hold=0,$.bits=0,$.lencode=$.lendyn=new eo.Buf32(e0),$.distcode=$.distdyn=new eo.Buf32(e1),$.sane=1,$.back=-1,eh):ey}function e8(_){var $;return _&&_.state?(($=_.state).wsize=0,$.whave=0,$.wnext=0,e6(_)):ey}function e4(_,$){var ee,et;return _&&_.state?(et=_.state,$<0?(ee=0,$=-$):(ee=($>>4)+1,$<48&&($&=15)),$&&($<8||$>15))?ey:(null!==et.window&&et.wbits!==$&&(et.window=null),et.wrap=ee,et.wbits=$,e8(_)):ey}function e9(_,$){var ee,et;return _?(et=new e3,_.state=et,et.window=null,(ee=e4(_,$))!==eh&&(_.state=null),ee):ey}function e7(_){return e9(_,e2)}var te=!0;function tt(_){if(te){var $;for(et=new eo.Buf32(512),en=new eo.Buf32(32),$=0;$<144;)_.lens[$++]=8;for(;$<256;)_.lens[$++]=9;for(;$<280;)_.lens[$++]=7;for(;$<288;)_.lens[$++]=8;for(el(ec,_.lens,0,288,et,0,_.work,{bits:9}),$=0;$<32;)_.lens[$++]=5;el(ed,_.lens,0,32,en,0,_.work,{bits:5}),te=!1}_.lencode=et,_.lenbits=9,_.distcode=en,_.distbits=5}function tn(_,$,ee,et){var en,er=_.state;return null===er.window&&(er.wsize=1<<er.wbits,er.wnext=0,er.whave=0,er.window=new eo.Buf8(er.wsize)),et>=er.wsize?(eo.arraySet(er.window,$,ee-er.wsize,er.wsize,0),er.wnext=0,er.whave=er.wsize):((en=er.wsize-er.wnext)>et&&(en=et),eo.arraySet(er.window,$,ee-et,en,er.wnext),(et-=en)?(eo.arraySet(er.window,$,ee-et,et,0),er.wnext=et,er.whave=er.wsize):(er.wnext+=en,er.wnext===er.wsize&&(er.wnext=0),er.whave<er.wsize&&(er.whave+=en))),0}function to(_,$){var ee,et,en,e0,e1,e2,e3,e6,e8,e4,e9,e7,te,to,tr,ti,ts,tl,tu,tc,td,tf,tp,tm,th=0,tg=new eo.Buf8(4),tb=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!_||!_.state||!_.output||!_.input&&0!==_.avail_in)return ey;(ee=_.state).mode===eI&&(ee.mode=eF),e1=_.next_out,en=_.output,e3=_.avail_out,e0=_.next_in,et=_.input,e2=_.avail_in,e6=ee.hold,e8=ee.bits,e4=e2,e9=e3,tf=eh;r:for(;;)switch(ee.mode){case ex:if(0===ee.wrap){ee.mode=eF;break}for(;e8<16;){if(0===e2)break r;e2--,e6+=et[e0++]<<e8,e8+=8}if(2&ee.wrap&&35615===e6){ee.check=0,tg[0]=255&e6,tg[1]=e6>>>8&255,ee.check=ei(ee.check,tg,2,0),e6=0,e8=0,ee.mode=ew;break}if(ee.flags=0,ee.head&&(ee.head.done=!1),!(1&ee.wrap)||(((255&e6)<<8)+(e6>>8))%31){_.msg="incorrect header check",ee.mode=eQ;break}if((15&e6)!==eC){_.msg="unknown compression method",ee.mode=eQ;break}if(e6>>>=4,e8-=4,td=(15&e6)+8,0===ee.wbits)ee.wbits=td;else if(td>ee.wbits){_.msg="invalid window size",ee.mode=eQ;break}ee.dmax=1<<td,_.adler=ee.check=1,ee.mode=512&e6?e_:eI,e6=0,e8=0;break;case ew:for(;e8<16;){if(0===e2)break r;e2--,e6+=et[e0++]<<e8,e8+=8}if(ee.flags=e6,(255&ee.flags)!==eC){_.msg="unknown compression method",ee.mode=eQ;break}if(57344&ee.flags){_.msg="unknown header flags set",ee.mode=eQ;break}ee.head&&(ee.head.text=e6>>8&1),512&ee.flags&&(tg[0]=255&e6,tg[1]=e6>>>8&255,ee.check=ei(ee.check,tg,2,0)),e6=0,e8=0,ee.mode=eE;case eE:for(;e8<32;){if(0===e2)break r;e2--,e6+=et[e0++]<<e8,e8+=8}ee.head&&(ee.head.time=e6),512&ee.flags&&(tg[0]=255&e6,tg[1]=e6>>>8&255,tg[2]=e6>>>16&255,tg[3]=e6>>>24&255,ee.check=ei(ee.check,tg,4,0)),e6=0,e8=0,ee.mode=eT;case eT:for(;e8<16;){if(0===e2)break r;e2--,e6+=et[e0++]<<e8,e8+=8}ee.head&&(ee.head.xflags=255&e6,ee.head.os=e6>>8),512&ee.flags&&(tg[0]=255&e6,tg[1]=e6>>>8&255,ee.check=ei(ee.check,tg,2,0)),e6=0,e8=0,ee.mode=eO;case eO:if(1024&ee.flags){for(;e8<16;){if(0===e2)break r;e2--,e6+=et[e0++]<<e8,e8+=8}ee.length=e6,ee.head&&(ee.head.extra_len=e6),512&ee.flags&&(tg[0]=255&e6,tg[1]=e6>>>8&255,ee.check=ei(ee.check,tg,2,0)),e6=0,e8=0}else ee.head&&(ee.head.extra=null);ee.mode=eA;case eA:if(1024&ee.flags&&((e7=ee.length)>e2&&(e7=e2),e7&&(ee.head&&(td=ee.head.extra_len-ee.length,ee.head.extra||(ee.head.extra=Array(ee.head.extra_len)),eo.arraySet(ee.head.extra,et,e0,e7,td)),512&ee.flags&&(ee.check=ei(ee.check,et,e7,e0)),e2-=e7,e0+=e7,ee.length-=e7),ee.length))break r;ee.length=0,ee.mode=eR;case eR:if(2048&ee.flags){if(0===e2)break r;e7=0;do td=et[e0+e7++],ee.head&&td&&ee.length<65536&&(ee.head.name+=String.fromCharCode(td));while(td&&e7<e2);if(512&ee.flags&&(ee.check=ei(ee.check,et,e7,e0)),e2-=e7,e0+=e7,td)break r}else ee.head&&(ee.head.name=null);ee.length=0,ee.mode=eP;case eP:if(4096&ee.flags){if(0===e2)break r;e7=0;do td=et[e0+e7++],ee.head&&td&&ee.length<65536&&(ee.head.comment+=String.fromCharCode(td));while(td&&e7<e2);if(512&ee.flags&&(ee.check=ei(ee.check,et,e7,e0)),e2-=e7,e0+=e7,td)break r}else ee.head&&(ee.head.comment=null);ee.mode=eD;case eD:if(512&ee.flags){for(;e8<16;){if(0===e2)break r;e2--,e6+=et[e0++]<<e8,e8+=8}if(e6!==(65535&ee.check)){_.msg="header crc mismatch",ee.mode=eQ;break}e6=0,e8=0}ee.head&&(ee.head.hcrc=ee.flags>>9&1,ee.head.done=!0),_.adler=ee.check=0,ee.mode=eI;break;case e_:for(;e8<32;){if(0===e2)break r;e2--,e6+=et[e0++]<<e8,e8+=8}_.adler=ee.check=e5(e6),e6=0,e8=0,ee.mode=ek;case ek:if(0===ee.havedict)return _.next_out=e1,_.avail_out=e3,_.next_in=e0,_.avail_in=e2,ee.hold=e6,ee.bits=e8,eb;_.adler=ee.check=1,ee.mode=eI;case eI:if($===ep||$===em)break r;case eF:if(ee.last){e6>>>=7&e8,e8-=7&e8,ee.mode=eJ;break}for(;e8<3;){if(0===e2)break r;e2--,e6+=et[e0++]<<e8,e8+=8}switch(ee.last=1&e6,e8-=1,3&(e6>>>=1)){case 0:ee.mode=eM;break;case 1:if(tt(ee),ee.mode=eW,$===em){e6>>>=2,e8-=2;break r}break;case 2:ee.mode=eL;break;case 3:_.msg="invalid block type",ee.mode=eQ}e6>>>=2,e8-=2;break;case eM:for(e6>>>=7&e8,e8-=7&e8;e8<32;){if(0===e2)break r;e2--,e6+=et[e0++]<<e8,e8+=8}if((65535&e6)!=(e6>>>16^65535)){_.msg="invalid stored block lengths",ee.mode=eQ;break}if(ee.length=65535&e6,e6=0,e8=0,ee.mode=eB,$===em)break r;case eB:ee.mode=eU;case eU:if(e7=ee.length){if(e7>e2&&(e7=e2),e7>e3&&(e7=e3),0===e7)break r;eo.arraySet(en,et,e0,e7,e1),e2-=e7,e0+=e7,e3-=e7,e1+=e7,ee.length-=e7;break}ee.mode=eI;break;case eL:for(;e8<14;){if(0===e2)break r;e2--,e6+=et[e0++]<<e8,e8+=8}if(ee.nlen=(31&e6)+257,e6>>>=5,e8-=5,ee.ndist=(31&e6)+1,e6>>>=5,e8-=5,ee.ncode=(15&e6)+4,e6>>>=4,e8-=4,ee.nlen>286||ee.ndist>30){_.msg="too many length or distance symbols",ee.mode=eQ;break}ee.have=0,ee.mode=ez;case ez:for(;ee.have<ee.ncode;){for(;e8<3;){if(0===e2)break r;e2--,e6+=et[e0++]<<e8,e8+=8}ee.lens[tb[ee.have++]]=7&e6,e6>>>=3,e8-=3}for(;ee.have<19;)ee.lens[tb[ee.have++]]=0;if(ee.lencode=ee.lendyn,ee.lenbits=7,tp={bits:ee.lenbits},tf=el(eu,ee.lens,0,19,ee.lencode,0,ee.work,tp),ee.lenbits=tp.bits,tf){_.msg="invalid code lengths set",ee.mode=eQ;break}ee.have=0,ee.mode=eH;case eH:for(;ee.have<ee.nlen+ee.ndist;){for(;tr=(th=ee.lencode[e6&(1<<ee.lenbits)-1])>>>24,ti=th>>>16&255,ts=65535&th,!(tr<=e8);){if(0===e2)break r;e2--,e6+=et[e0++]<<e8,e8+=8}if(ts<16)e6>>>=tr,e8-=tr,ee.lens[ee.have++]=ts;else{if(16===ts){for(tm=tr+2;e8<tm;){if(0===e2)break r;e2--,e6+=et[e0++]<<e8,e8+=8}if(e6>>>=tr,e8-=tr,0===ee.have){_.msg="invalid bit length repeat",ee.mode=eQ;break}td=ee.lens[ee.have-1],e7=3+(3&e6),e6>>>=2,e8-=2}else if(17===ts){for(tm=tr+3;e8<tm;){if(0===e2)break r;e2--,e6+=et[e0++]<<e8,e8+=8}e6>>>=tr,e8-=tr,td=0,e7=3+(7&e6),e6>>>=3,e8-=3}else{for(tm=tr+7;e8<tm;){if(0===e2)break r;e2--,e6+=et[e0++]<<e8,e8+=8}e6>>>=tr,e8-=tr,td=0,e7=11+(127&e6),e6>>>=7,e8-=7}if(ee.have+e7>ee.nlen+ee.ndist){_.msg="invalid bit length repeat",ee.mode=eQ;break}for(;e7--;)ee.lens[ee.have++]=td}}if(ee.mode===eQ)break;if(0===ee.lens[256]){_.msg="invalid code -- missing end-of-block",ee.mode=eQ;break}if(ee.lenbits=9,tp={bits:ee.lenbits},tf=el(ec,ee.lens,0,ee.nlen,ee.lencode,0,ee.work,tp),ee.lenbits=tp.bits,tf){_.msg="invalid literal/lengths set",ee.mode=eQ;break}if(ee.distbits=6,ee.distcode=ee.distdyn,tp={bits:ee.distbits},tf=el(ed,ee.lens,ee.nlen,ee.ndist,ee.distcode,0,ee.work,tp),ee.distbits=tp.bits,tf){_.msg="invalid distances set",ee.mode=eQ;break}if(ee.mode=eW,$===em)break r;case eW:ee.mode=ej;case ej:if(e2>=6&&e3>=258){_.next_out=e1,_.avail_out=e3,_.next_in=e0,_.avail_in=e2,ee.hold=e6,ee.bits=e8,es(_,e9),e1=_.next_out,en=_.output,e3=_.avail_out,e0=_.next_in,et=_.input,e2=_.avail_in,e6=ee.hold,e8=ee.bits,ee.mode===eI&&(ee.back=-1);break}for(ee.back=0;tr=(th=ee.lencode[e6&(1<<ee.lenbits)-1])>>>24,ti=th>>>16&255,ts=65535&th,!(tr<=e8);){if(0===e2)break r;e2--,e6+=et[e0++]<<e8,e8+=8}if(ti&&(240&ti)==0){for(tl=tr,tu=ti,tc=ts;tr=(th=ee.lencode[tc+((e6&(1<<tl+tu)-1)>>tl)])>>>24,ti=th>>>16&255,ts=65535&th,!(tl+tr<=e8);){if(0===e2)break r;e2--,e6+=et[e0++]<<e8,e8+=8}e6>>>=tl,e8-=tl,ee.back+=tl}if(e6>>>=tr,e8-=tr,ee.back+=tr,ee.length=ts,0===ti){ee.mode=eq;break}if(32&ti){ee.back=-1,ee.mode=eI;break}if(64&ti){_.msg="invalid literal/length code",ee.mode=eQ;break}ee.extra=15&ti,ee.mode=eX;case eX:if(ee.extra){for(tm=ee.extra;e8<tm;){if(0===e2)break r;e2--,e6+=et[e0++]<<e8,e8+=8}ee.length+=e6&(1<<ee.extra)-1,e6>>>=ee.extra,e8-=ee.extra,ee.back+=ee.extra}ee.was=ee.length,ee.mode=eV;case eV:for(;tr=(th=ee.distcode[e6&(1<<ee.distbits)-1])>>>24,ti=th>>>16&255,ts=65535&th,!(tr<=e8);){if(0===e2)break r;e2--,e6+=et[e0++]<<e8,e8+=8}if((240&ti)==0){for(tl=tr,tu=ti,tc=ts;tr=(th=ee.distcode[tc+((e6&(1<<tl+tu)-1)>>tl)])>>>24,ti=th>>>16&255,ts=65535&th,!(tl+tr<=e8);){if(0===e2)break r;e2--,e6+=et[e0++]<<e8,e8+=8}e6>>>=tl,e8-=tl,ee.back+=tl}if(e6>>>=tr,e8-=tr,ee.back+=tr,64&ti){_.msg="invalid distance code",ee.mode=eQ;break}ee.offset=ts,ee.extra=15&ti,ee.mode=eZ;case eZ:if(ee.extra){for(tm=ee.extra;e8<tm;){if(0===e2)break r;e2--,e6+=et[e0++]<<e8,e8+=8}ee.offset+=e6&(1<<ee.extra)-1,e6>>>=ee.extra,e8-=ee.extra,ee.back+=ee.extra}if(ee.offset>ee.dmax){_.msg="invalid distance too far back",ee.mode=eQ;break}ee.mode=eK;case eK:if(0===e3)break r;if(e7=e9-e3,ee.offset>e7){if((e7=ee.offset-e7)>ee.whave&&ee.sane){_.msg="invalid distance too far back",ee.mode=eQ;break}e7>ee.wnext?(e7-=ee.wnext,te=ee.wsize-e7):te=ee.wnext-e7,e7>ee.length&&(e7=ee.length),to=ee.window}else to=en,te=e1-ee.offset,e7=ee.length;e7>e3&&(e7=e3),e3-=e7,ee.length-=e7;do en[e1++]=to[te++];while(--e7);0===ee.length&&(ee.mode=ej);break;case eq:if(0===e3)break r;en[e1++]=ee.length,e3--,ee.mode=ej;break;case eJ:if(ee.wrap){for(;e8<32;){if(0===e2)break r;e2--,e6|=et[e0++]<<e8,e8+=8}if(e9-=e3,_.total_out+=e9,ee.total+=e9,e9&&(_.adler=ee.check=ee.flags?ei(ee.check,en,e9,e1-e9):er(ee.check,en,e9,e1-e9)),e9=e3,(ee.flags?e6:e5(e6))!==ee.check){_.msg="incorrect data check",ee.mode=eQ;break}e6=0,e8=0}ee.mode=eG;case eG:if(ee.wrap&&ee.flags){for(;e8<32;){if(0===e2)break r;e2--,e6+=et[e0++]<<e8,e8+=8}if(e6!==(4294967295&ee.total)){_.msg="incorrect length check",ee.mode=eQ;break}e6=0,e8=0}ee.mode=eY;case eY:tf=eg;break r;case eQ:tf=ev;break r;case e$:return eS;default:return ey}return(_.next_out=e1,_.avail_out=e3,_.next_in=e0,_.avail_in=e2,ee.hold=e6,ee.bits=e8,(ee.wsize||e9!==_.avail_out&&ee.mode<eQ&&(ee.mode<eJ||$!==ef))&&tn(_,_.output,_.next_out,e9-_.avail_out))?(ee.mode=e$,eS):(e4-=_.avail_in,e9-=_.avail_out,_.total_in+=e4,_.total_out+=e9,ee.total+=e9,ee.wrap&&e9&&(_.adler=ee.check=ee.flags?ei(ee.check,en,e9,_.next_out-e9):er(ee.check,en,e9,_.next_out-e9)),_.data_type=ee.bits+(ee.last?64:0)+(ee.mode===eI?128:0)+(ee.mode===eW||ee.mode===eB?256:0),(0===e4&&0===e9||$===ef)&&tf===eh&&(tf=eN),tf)}function tr(_){if(!_||!_.state)return ey;var $=_.state;return $.window&&($.window=null),_.state=null,eh}function ti(_,$){var ee;return _&&_.state&&(2&(ee=_.state).wrap)!=0?(ee.head=$,$.done=!1,eh):ey}ee.inflateReset=e8,ee.inflateReset2=e4,ee.inflateResetKeep=e6,ee.inflateInit=e7,ee.inflateInit2=e9,ee.inflate=to,ee.inflateEnd=tr,ee.inflateGetHeader=ti,ee.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./inffast":34,"./inftrees":36}],36:[function(_,$,ee){var et=_("../utils/common"),en=15,eo=852,er=592,ei=0,es=1,el=2,eu=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],ec=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],ed=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],ef=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];$.exports=function(_,$,ee,ep,em,eh,eg,eb){var ey,ev,eS,eN,eC,ex,ew,eE,eT,eO=eb.bits,eA=0,eR=0,eP=0,eD=0,e_=0,ek=0,eI=0,eF=0,eM=0,eB=0,eU=null,eL=0,ez=new et.Buf16(en+1),eH=new et.Buf16(en+1),eW=null,ej=0;for(eA=0;eA<=en;eA++)ez[eA]=0;for(eR=0;eR<ep;eR++)ez[$[ee+eR]]++;for(e_=eO,eD=en;eD>=1&&0===ez[eD];eD--);if(e_>eD&&(e_=eD),0===eD)return em[eh++]=20971520,em[eh++]=20971520,eb.bits=1,0;for(eP=1;eP<eD&&0===ez[eP];eP++);for(e_<eP&&(e_=eP),eF=1,eA=1;eA<=en;eA++)if(eF<<=1,(eF-=ez[eA])<0)return -1;if(eF>0&&(_===ei||1!==eD))return -1;for(eA=1,eH[1]=0;eA<en;eA++)eH[eA+1]=eH[eA]+ez[eA];for(eR=0;eR<ep;eR++)0!==$[ee+eR]&&(eg[eH[$[ee+eR]]++]=eR);if(_===ei?(eU=eW=eg,ex=19):_===es?(eU=eu,eL-=257,eW=ec,ej-=257,ex=256):(eU=ed,eW=ef,ex=-1),eB=0,eR=0,eA=eP,eC=eh,ek=e_,eI=0,eS=-1,eN=(eM=1<<e_)-1,_===es&&eM>eo||_===el&&eM>er)return 1;for(;;){ew=eA-eI,eg[eR]<ex?(eE=0,eT=eg[eR]):eg[eR]>ex?(eE=eW[ej+eg[eR]],eT=eU[eL+eg[eR]]):(eE=96,eT=0),ey=1<<eA-eI,eP=ev=1<<ek;do em[eC+(eB>>eI)+(ev-=ey)]=ew<<24|eE<<16|eT|0;while(0!==ev);for(ey=1<<eA-1;eB&ey;)ey>>=1;if(0!==ey?(eB&=ey-1,eB+=ey):eB=0,eR++,0==--ez[eA]){if(eA===eD)break;eA=$[ee+eg[eR]]}if(eA>e_&&(eB&eN)!==eS){for(0===eI&&(eI=e_),eC+=eP,eF=1<<(ek=eA-eI);ek+eI<eD&&!((eF-=ez[ek+eI])<=0);)ek++,eF<<=1;if(eM+=1<<ek,_===es&&eM>eo||_===el&&eM>er)return 1;em[eS=eB&eN]=e_<<24|ek<<16|eC-eh|0}}return 0!==eB&&(em[eC+eB]=eA-eI<<24|4194304),eb.bits=e_,0}},{"../utils/common":27}],37:[function(_,$,ee){$.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],38:[function(_,$,ee){var et,en,eo,er=_("../utils/common"),ei=4,es=0,el=1,eu=2;function ec(_){for(var $=_.length;--$>=0;)_[$]=0}var ed=0,ef=1,ep=2,em=3,eh=258,eg=29,eb=256,ey=286,ev=30,eS=19,eN=573,eC=15,ex=16,ew=7,eE=256,eT=16,eO=17,eA=18,eR=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],eP=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],eD=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],e_=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ek=512,eI=Array(576);ec(eI);var eF=Array(2*ev);ec(eF);var eM=Array(ek);ec(eM);var eB=Array(eh-em+1);ec(eB);var eU=Array(eg);ec(eU);var eL=Array(ev);ec(eL);var ez=function(_,$,ee,et,en){this.static_tree=_,this.extra_bits=$,this.extra_base=ee,this.elems=et,this.max_length=en,this.has_stree=_&&_.length},eH=function(_,$){this.dyn_tree=_,this.max_code=0,this.stat_desc=$};function eW(_){return _<256?eM[_]:eM[256+(_>>>7)]}function ej(_,$){_.pending_buf[_.pending++]=255&$,_.pending_buf[_.pending++]=$>>>8&255}function eX(_,$,ee){_.bi_valid>ex-ee?(_.bi_buf|=$<<_.bi_valid&65535,ej(_,_.bi_buf),_.bi_buf=$>>ex-_.bi_valid,_.bi_valid+=ee-ex):(_.bi_buf|=$<<_.bi_valid&65535,_.bi_valid+=ee)}function eV(_,$,ee){eX(_,ee[2*$],ee[2*$+1])}function eZ(_,$){var ee=0;do ee|=1&_,_>>>=1,ee<<=1;while(--$>0);return ee>>>1}function eK(_){16===_.bi_valid?(ej(_,_.bi_buf),_.bi_buf=0,_.bi_valid=0):_.bi_valid>=8&&(_.pending_buf[_.pending++]=255&_.bi_buf,_.bi_buf>>=8,_.bi_valid-=8)}function eq(_,$){var ee,et,en,eo,er,ei,es=$.dyn_tree,el=$.max_code,eu=$.stat_desc.static_tree,ec=$.stat_desc.has_stree,ed=$.stat_desc.extra_bits,ef=$.stat_desc.extra_base,ep=$.stat_desc.max_length,em=0;for(eo=0;eo<=eC;eo++)_.bl_count[eo]=0;for(es[2*_.heap[_.heap_max]+1]=0,ee=_.heap_max+1;ee<eN;ee++)(eo=es[2*es[2*(et=_.heap[ee])+1]+1]+1)>ep&&(eo=ep,em++),es[2*et+1]=eo,!(et>el)&&(_.bl_count[eo]++,er=0,et>=ef&&(er=ed[et-ef]),ei=es[2*et],_.opt_len+=ei*(eo+er),ec&&(_.static_len+=ei*(eu[2*et+1]+er)));if(0!==em){do{for(eo=ep-1;0===_.bl_count[eo];)eo--;_.bl_count[eo]--,_.bl_count[eo+1]+=2,_.bl_count[ep]--,em-=2}while(em>0);for(eo=ep;0!==eo;eo--)for(et=_.bl_count[eo];0!==et;)!((en=_.heap[--ee])>el)&&(es[2*en+1]!==eo&&(_.opt_len+=(eo-es[2*en+1])*es[2*en],es[2*en+1]=eo),et--)}}function eJ(_,$,ee){var et,en,eo=Array(eC+1),er=0;for(et=1;et<=eC;et++)eo[et]=er=er+ee[et-1]<<1;for(en=0;en<=$;en++){var ei=_[2*en+1];0!==ei&&(_[2*en]=eZ(eo[ei]++,ei))}}function eG(){var _,$,ee,er,ei,es=Array(eC+1);for(er=0,ee=0;er<eg-1;er++)for(_=0,eU[er]=ee;_<1<<eR[er];_++)eB[ee++]=er;for(eB[ee-1]=er,ei=0,er=0;er<16;er++)for(_=0,eL[er]=ei;_<1<<eP[er];_++)eM[ei++]=er;for(ei>>=7;er<ev;er++)for(_=0,eL[er]=ei<<7;_<1<<eP[er]-7;_++)eM[256+ei++]=er;for($=0;$<=eC;$++)es[$]=0;for(_=0;_<=143;)eI[2*_+1]=8,_++,es[8]++;for(;_<=255;)eI[2*_+1]=9,_++,es[9]++;for(;_<=279;)eI[2*_+1]=7,_++,es[7]++;for(;_<=287;)eI[2*_+1]=8,_++,es[8]++;for(eJ(eI,ey+1,es),_=0;_<ev;_++)eF[2*_+1]=5,eF[2*_]=eZ(_,5);et=new ez(eI,eR,eb+1,ey,eC),en=new ez(eF,eP,0,ev,eC),eo=new ez([],eD,0,eS,ew)}function eY(_){var $;for($=0;$<ey;$++)_.dyn_ltree[2*$]=0;for($=0;$<ev;$++)_.dyn_dtree[2*$]=0;for($=0;$<eS;$++)_.bl_tree[2*$]=0;_.dyn_ltree[2*eE]=1,_.opt_len=_.static_len=0,_.last_lit=_.matches=0}function eQ(_){_.bi_valid>8?ej(_,_.bi_buf):_.bi_valid>0&&(_.pending_buf[_.pending++]=_.bi_buf),_.bi_buf=0,_.bi_valid=0}function e$(_,$,ee,et){eQ(_),et&&(ej(_,ee),ej(_,~ee)),er.arraySet(_.pending_buf,_.window,$,ee,_.pending),_.pending+=ee}function e0(_,$,ee,et){var en=2*$,eo=2*ee;return _[en]<_[eo]||_[en]===_[eo]&&et[$]<=et[ee]}function e1(_,$,ee){for(var et=_.heap[ee],en=ee<<1;en<=_.heap_len&&(en<_.heap_len&&e0($,_.heap[en+1],_.heap[en],_.depth)&&en++,!e0($,et,_.heap[en],_.depth));)_.heap[ee]=_.heap[en],ee=en,en<<=1;_.heap[ee]=et}function e2(_,$,ee){var et,en,eo,er,ei=0;if(0!==_.last_lit)do et=_.pending_buf[_.d_buf+2*ei]<<8|_.pending_buf[_.d_buf+2*ei+1],en=_.pending_buf[_.l_buf+ei],ei++,0===et?eV(_,en,$):(eV(_,(eo=eB[en])+eb+1,$),0!==(er=eR[eo])&&eX(_,en-=eU[eo],er),eV(_,eo=eW(--et),ee),0!==(er=eP[eo])&&eX(_,et-=eL[eo],er));while(ei<_.last_lit);eV(_,eE,$)}function e5(_,$){var ee,et,en,eo=$.dyn_tree,er=$.stat_desc.static_tree,ei=$.stat_desc.has_stree,es=$.stat_desc.elems,el=-1;for(ee=0,_.heap_len=0,_.heap_max=eN;ee<es;ee++)0!==eo[2*ee]?(_.heap[++_.heap_len]=el=ee,_.depth[ee]=0):eo[2*ee+1]=0;for(;_.heap_len<2;)eo[2*(en=_.heap[++_.heap_len]=el<2?++el:0)]=1,_.depth[en]=0,_.opt_len--,ei&&(_.static_len-=er[2*en+1]);for($.max_code=el,ee=_.heap_len>>1;ee>=1;ee--)e1(_,eo,ee);en=es;do ee=_.heap[1],_.heap[1]=_.heap[_.heap_len--],e1(_,eo,1),et=_.heap[1],_.heap[--_.heap_max]=ee,_.heap[--_.heap_max]=et,eo[2*en]=eo[2*ee]+eo[2*et],_.depth[en]=(_.depth[ee]>=_.depth[et]?_.depth[ee]:_.depth[et])+1,eo[2*ee+1]=eo[2*et+1]=en,_.heap[1]=en++,e1(_,eo,1);while(_.heap_len>=2);_.heap[--_.heap_max]=_.heap[1],eq(_,$),eJ(eo,el,_.bl_count)}function e3(_,$,ee){var et,en,eo=-1,er=$[1],ei=0,es=7,el=4;for(0===er&&(es=138,el=3),$[(ee+1)*2+1]=65535,et=0;et<=ee;et++)en=er,er=$[(et+1)*2+1],++ei<es&&en===er||(ei<el?_.bl_tree[2*en]+=ei:0!==en?(en!==eo&&_.bl_tree[2*en]++,_.bl_tree[2*eT]++):ei<=10?_.bl_tree[2*eO]++:_.bl_tree[2*eA]++,ei=0,eo=en,0===er?(es=138,el=3):en===er?(es=6,el=3):(es=7,el=4))}function e6(_,$,ee){var et,en,eo=-1,er=$[1],ei=0,es=7,el=4;for(0===er&&(es=138,el=3),et=0;et<=ee;et++)if(en=er,er=$[(et+1)*2+1],!(++ei<es)||en!==er){if(ei<el)do eV(_,en,_.bl_tree);while(0!=--ei);else 0!==en?(en!==eo&&(eV(_,en,_.bl_tree),ei--),eV(_,eT,_.bl_tree),eX(_,ei-3,2)):ei<=10?(eV(_,eO,_.bl_tree),eX(_,ei-3,3)):(eV(_,eA,_.bl_tree),eX(_,ei-11,7));ei=0,eo=en,0===er?(es=138,el=3):en===er?(es=6,el=3):(es=7,el=4)}}function e8(_){var $;for(e3(_,_.dyn_ltree,_.l_desc.max_code),e3(_,_.dyn_dtree,_.d_desc.max_code),e5(_,_.bl_desc),$=eS-1;$>=3&&0===_.bl_tree[2*e_[$]+1];$--);return _.opt_len+=3*($+1)+5+5+4,$}function e4(_,$,ee,et){var en;for(eX(_,$-257,5),eX(_,ee-1,5),eX(_,et-4,4),en=0;en<et;en++)eX(_,_.bl_tree[2*e_[en]+1],3);e6(_,_.dyn_ltree,$-1),e6(_,_.dyn_dtree,ee-1)}function e9(_){var $,ee=4093624447;for($=0;$<=31;$++,ee>>>=1)if(1&ee&&0!==_.dyn_ltree[2*$])return es;if(0!==_.dyn_ltree[18]||0!==_.dyn_ltree[20]||0!==_.dyn_ltree[26])return el;for($=32;$<eb;$++)if(0!==_.dyn_ltree[2*$])return el;return es}var e7=!1;function te(_){e7||(eG(),e7=!0),_.l_desc=new eH(_.dyn_ltree,et),_.d_desc=new eH(_.dyn_dtree,en),_.bl_desc=new eH(_.bl_tree,eo),_.bi_buf=0,_.bi_valid=0,eY(_)}function tt(_,$,ee,et){eX(_,(ed<<1)+(et?1:0),3),e$(_,$,ee,!0)}function tn(_){eX(_,ef<<1,3),eV(_,eE,eI),eK(_)}function to(_,$,ee,et){var en,eo,er=0;_.level>0?(_.strm.data_type===eu&&(_.strm.data_type=e9(_)),e5(_,_.l_desc),e5(_,_.d_desc),er=e8(_),en=_.opt_len+3+7>>>3,(eo=_.static_len+3+7>>>3)<=en&&(en=eo)):en=eo=ee+5,ee+4<=en&&-1!==$?tt(_,$,ee,et):_.strategy===ei||eo===en?(eX(_,(ef<<1)+(et?1:0),3),e2(_,eI,eF)):(eX(_,(ep<<1)+(et?1:0),3),e4(_,_.l_desc.max_code+1,_.d_desc.max_code+1,er+1),e2(_,_.dyn_ltree,_.dyn_dtree)),eY(_),et&&eQ(_)}function tr(_,$,ee){return _.pending_buf[_.d_buf+2*_.last_lit]=$>>>8&255,_.pending_buf[_.d_buf+2*_.last_lit+1]=255&$,_.pending_buf[_.l_buf+_.last_lit]=255&ee,_.last_lit++,0===$?_.dyn_ltree[2*ee]++:(_.matches++,$--,_.dyn_ltree[(eB[ee]+eb+1)*2]++,_.dyn_dtree[2*eW($)]++),_.last_lit===_.lit_bufsize-1}ee._tr_init=te,ee._tr_stored_block=tt,ee._tr_flush_block=to,ee._tr_tally=tr,ee._tr_align=tn},{"../utils/common":27}],39:[function(_,$,ee){function et(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}$.exports=et},{}]},{},[9])(9)});